import{ae as X,G as f,af as re,ag as ie,ah as x,ai as G,aj as Q,g as Te,ak as O,al as ne,am as De,I as ve,U as xe,o as we,p as Ye,an as Ae,K as Ee,ao as Le,B as Me,C as Ce}from"./bundle.index.8Q71sPSv.js";import{h as r,t as p,a as T,r as g,A as Y,u as ke,j as Pe,k as Ie,f as Se,s as Ne,l as Be,b as Ve,T as Oe,w as He}from"./chunk.vendor.64oIaR0X.js";import{h as Re,a0 as $e,f as We,b as oe,i as qe}from"./chunk.vendor-lodash.LcYqUmOZ.js";import{U as Ue}from"./chunk.UiMixinProps.tZiK99ln.js";const le={name:"APanelTime",mixins:[X],props:{minuteStep:{type:Number,default:0,validator:e=>e>=0&&e<=60},value:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],default:void 0},timeType:{type:Array,default(){return["24","a"]}},disabledTime:{type:Function,required:!1,default:void 0},currentLanguage:{type:Object,required:!0}},emits:["select"],data(){return{timeIndexForFocus:void 0,columnIndexForFocus:void 0}},computed:{currentHours(){return this.value?new Date(this.value).getHours():0},currentMinutes(){return this.value?new Date(this.value).getMinutes():0},currentSeconds(){return this.value?new Date(this.value).getSeconds():0},date(){return this.value?new Date(this.value):new Date().setHours(0,0,0,0)},isDisabledTimeFunction(){return typeof this.disabledTime=="function"},timesFiltered(){const e=[];let t=0;const a=this.setColumn({times:this.hours,timeFunctionName:"setHours",currentTime:this.currentHours,ariaLabel:this.currentLanguage.hours,columnIndex:t});a.length&&(e.push(a),t++);const i=this.setColumn({times:this.minutes,timeFunctionName:"setMinutes",currentTime:this.currentMinutes,ariaLabel:this.currentLanguage.minutes,columnIndex:t});i.length&&(e.push(i),t++);const n=this.setColumn({times:this.seconds,timeFunctionName:"setSeconds",currentTime:this.currentSeconds,ariaLabel:this.currentLanguage.seconds,columnIndex:t});return n.length&&e.push(n),e},minuteStepLocal(){return this.minuteStep||1},minuteLength(){return parseInt(60/this.minuteStepLocal)},hours(){return Array.apply(null,{length:24}).map((e,t)=>t)},minutes(){return Array.apply(null,{length:this.minuteLength}).map((e,t)=>t*this.minuteStepLocal)},seconds(){return this.minuteStep===0?Array.apply(null,{length:60}).map((e,t)=>t):[]},idForFocus(){return this.getCurrentId({columnIndex:this.columnIndexForFocus,rowIndex:this.timeIndexForFocus})},fullIndexForFocus(){return`${this.columnIndexForFocus}_${this.timeIndexForFocus}`}},methods:{stringifyText(e){return("00"+e).slice(String(e).length)},selectTime(e,t){typeof this.disabledTime=="function"&&this.disabledTime(e)||this.$emit("select",new Date(e),t)},setColumn({times:e,timeFunctionName:t,currentTime:a,ariaLabel:i,columnIndex:n}){const u=[];return e.forEach((l,y)=>{const h=new Date(this.date)[t](l),_=l===a,m=this.isDisabledTimeFunction&&this.disabledTime(h),b=this.stringifyText(l);u.push({label:b,time:h,isActive:_,isDisabled:m,ariaLabel:`${i}: ${b}`,id:this.getCurrentId({columnIndex:n,rowIndex:y})})}),u},getCurrentId({columnIndex:e,rowIndex:t}){return`${this.id}_time_${e}_${t}`},setFocusToActiveTime(){setTimeout(()=>{this.setDefaultTimeForFocus(),document.getElementById(this.idForFocus).focus(),this.setListenerForPressButtons()})},setDefaultTimeForFocus(){this.timeIndexForFocus=0,this.columnIndexForFocus=0},pressButton(e){const t=e.keyCode;t===f.arrowUp?(this.setFocusToLastTime(),this.stopCurrentEvent(e)):t===f.arrowDown?(this.setFocusToNextTime(),this.stopCurrentEvent(e)):t===f.arrowLeft?(this.setFocusToLastTimeColumn(),this.stopCurrentEvent(e)):t===f.arrowRight&&(this.setFocusToNextTimeColumn(),this.stopCurrentEvent(e))},setFocusToLastTime(){const e=this.timesFiltered[this.columnIndexForFocus];this.timeIndexForFocus>0?this.timeIndexForFocus--:this.timeIndexForFocus=e.length-1,this.setFocusToElement(this.idForFocus)},setFocusToNextTime(){const e=this.timesFiltered[this.columnIndexForFocus];this.timeIndexForFocus<e.length-1?this.timeIndexForFocus++:this.timeIndexForFocus=0,this.setFocusToElement(this.idForFocus)},setFocusToLastTimeColumn(){this.columnIndexForFocus>0?this.columnIndexForFocus--:this.columnIndexForFocus=this.timesFiltered.length-1,this.timeIndexForFocus=0,this.setFocusToElement(this.idForFocus)},setFocusToNextTimeColumn(){this.columnIndexForFocus<this.timesFiltered.length-1?this.columnIndexForFocus++:this.columnIndexForFocus=0,this.timeIndexForFocus=0,this.setFocusToElement(this.idForFocus)},setFocusToElement(e){const t=document.getElementById(e);t&&t.focus()},keypress(e,t,a){(e.keyCode===f.enter||e.keyCode===f.space)&&(this.selectTime(t,a),e.stopPropagation(),e.preventDefault())}},render(){return r("div",{class:"pux_datepicker__panel pux_datepicker__panel_time"},[this.timesFiltered.map((e,t)=>r("ul",{key:t,class:"pux_datepicker__time_list",role:"listbox","aria-labelledby":this.idForHeader,style:{width:`${100/this.timesFiltered.length}%`}},[e.map((a,i)=>r("li",{id:a.id,key:i,class:["cell",{actived:a.isActive,disabled:a.isDisabled,pux_datepicker__panel__cell_focus:t+"_"+i===this.fullIndexForFocus}],tabindex:-1,role:"option",ariaSelected:!!a.isActive,ariaLabel:a.ariaLabel,onClick:()=>this.selectTime(a.time),onKeypress:n=>this.keypress(n,a.time,t===this.timesFiltered.length-1)},a.label))]))])}},Ke={name:"APanelYearItem",props:{prefixForId:{type:String,required:!0},year:{type:Number,required:!0},yearFromValue:{type:Number,required:!1,default:void 0},yearIndex:{type:Number,required:!0},isDisabled:{type:Function,required:!0}},emits:["selectYear"],computed:{isDisabledLocal(){return this.isDisabled(this.year)},isYearActive(){return this.yearFromValue===this.year},idForList(){return`${this.prefixForId}${this.yearIndex}`},ariaSelected(){return`${this.isYearActive}`}},methods:{selectYearLocal(e,t){e.stopPropagation(),e.preventDefault(),!this.isDisabledLocal&&this.$emit("selectYear",{year:this.year,isButtonClick:t})},keypress(e){(e.keyCode===f.enter||e.keyCode===f.space)&&this.selectYearLocal(e,!0)}},render(){return r("li",{id:this.idForList,class:["cell",{actived:this.isYearActive,disabled:this.isDisabledLocal}],role:"option",tabindex:-1,"aria-selected":this.ariaSelected,onClick:this.selectYearLocal,onKeypress:this.keypress},this.year)}},ue={name:"APanelYear",mixins:[X],props:{value:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],required:!1,default:void 0},firstYear:{type:Number,required:!0},disabledYear:{type:Function,required:!1,default:void 0}},emits:["handleIconYear","select"],data(){return{yearIndexForFocus:void 0}},computed:{firstYearLocal(){return Math.floor(this.firstYear/10)*10},yearFromValue(){return this.value&&new Date(this.value).getFullYear()},idForFocus(){return Re(this.yearIndexForFocus)?"":this.getIdForYear(this.yearIndexForFocus)},yearIndexFromValueOrToday(){const e=this.yearFromValueOrToday-this.firstYearLocal;return e<=9&&e>=0?e:0},yearFromValueOrToday(){return this.yearFromValue||new Date().getFullYear()},prefixForId(){return`${this.id}_year_`}},methods:{isDisabled(e){return!!(typeof this.disabledYear=="function"&&this.disabledYear(e))},selectYear({year:e,isButtonClick:t}){this.isDisabled(e)||this.$emit("select",{year:e,isButtonClick:t})},getIdForYear(e){return`${this.prefixForId}${e}`},setFocusToActiveYear(){setTimeout(()=>{this.setDefaultYearForFocus(),document.getElementById(this.idForFocus).focus(),this.setListenerForPressButtons()})},setDefaultYearForFocus(){this.yearIndexForFocus=this.yearIndexFromValueOrToday},pressButton(e){const t=e.keyCode;t===f.arrowUp||t===f.arrowLeft?(this.setFocusToLastYear(),this.stopCurrentEvent(e)):(t===f.arrowDown||t===f.arrowRight)&&(this.setFocusToNextYear(),this.stopCurrentEvent(e))},setFocusToLastYear(){const e=this.yearIndexForFocus-1;e>=0&&e<=9?this.yearIndexForFocus=e:(this.$emit("handleIconYear",-1),this.yearIndexForFocus=9),this.setFocusToElementWithTimeout(this.idForFocus)},setFocusToNextYear(){const e=this.yearIndexForFocus+1;e<=9&&e>=0?this.yearIndexForFocus=e:(this.$emit("handleIconYear",1),this.yearIndexForFocus=0),this.setFocusToElementWithTimeout(this.idForFocus)}},render(){return r("ul",{class:"pux_datepicker__panel pux_datepicker__panel_year pux_datepicker__panel__list",role:"listbox","aria-labelledby":this.idForHeader,...this.attributesForMainElement},[$e(10).map(e=>r(Ke,{key:e,class:{pux_datepicker__panel__cell_focus:e===this.yearIndexForFocus},year:this.firstYearLocal+e,yearFromValue:this.yearFromValue,yearIndex:e,prefixForId:this.prefixForId,isDisabled:this.isDisabled,onSelectYear:this.selectYear}))])}};function je(e,t){if(!t){e.scrollTop=0;return}const a=[];let i=t.offsetParent;for(;i&&e!==i&&e.contains(i);)a.push(i),i=i.offsetParent;const n=t.offsetTop+a.reduce((h,_)=>h+_.offsetTop,0),u=n+t.offsetHeight,l=e.scrollTop,y=l+e.clientHeight;n<l?e.scrollTop=n:u>y&&(e.scrollTop=u-e.clientHeight)}const Z={name:"ADatepickerCalendarPanel",components:{APanelDate:re,APanelMonth:ie,APanelTime:le,APanelYear:ue},mixins:[X],props:{id:{type:String,required:!0},value:{default:null,validator:function(e){return e===null||x(e)}},startAt:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],required:!1,default:void 0},endAt:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],required:!1,default:void 0},visible:{type:Boolean,default:!1},type:{type:String,default:"date"},dateFormat:{type:String,default:"YYYY-MM-DD"},index:{type:Number,default:void 0},defaultValue:{validator:function(e){return x(e)},default:void 0},firstDayOfWeek:{default:1,type:Number,validator:e=>e>=1&&e<=7},notBefore:{default:null,validator:function(e){return!e||x(e)}},notAfter:{default:null,validator:function(e){return!e||x(e)}},disabledDays:{type:[Array,Function],default:function(){return[]}},minuteStep:{type:Number,default:0,validator:e=>e>=0&&e<=60},currentLanguage:{type:Object,required:!0}},emits:["closePopup","selectDate","selectTime"],data(){const e=this.getNow(this.value),t=e.getFullYear(),a=e.getMonth(),i=Math.floor(t/10)*10;return{panel:"NONE",dates:[],calendarMonth:a,calendarYear:t,firstYear:i,isFocusPanelChild:!1,isWorkWithKeyboard:!1}},computed:{now:{get(){return new Date(this.calendarYear,this.calendarMonth).getTime()},set(e){const t=new Date(e);this.calendarYear=t.getFullYear(),this.calendarMonth=t.getMonth()}},timeType(){const e=/h+/.test(this.$parent.format)?"12":"24",t=/A/.test(this.$parent.format)?"A":"a";return[e,t]},timeHeader(){return this.type==="time"?this.$parent.format:this.value&&G(this.value,this.dateFormat)},yearHeader(){const e=this.firstYear+9;return this.currentLanguage.headerYears(this.firstYear,e)},months(){return this.currentLanguage.months},notBeforeTime(){return this.getCriticalTime(this.notBefore)},notAfterTime(){return this.getCriticalTime(this.notAfter)},suffixForHeader(){return this.panel==="TIME"?this.currentLanguage.placeholder.regionTime:this.currentLanguage.placeholder.regionDate},idForHeaderParent(){return`${this.idForHeader}_parent`},ariaLabelForButtonLastYear(){return this.panel==="YEAR"?this.currentLanguage.buttons.lastYears:this.currentLanguage.buttons.lastYear},ariaLabelForButtonLastMonth(){return this.currentLanguage.buttons.lastMonth},ariaLabelForButtonNextMonth(){return this.currentLanguage.buttons.nextMonth},ariaLabelForButtonNextYear(){return this.panel==="YEAR"?this.currentLanguage.buttons.nextYears:this.currentLanguage.buttons.nextYear},ariaLabelForButtonCurrentMonth(){return this.currentLanguage.buttons.toMonthsView},ariaLabelForButtonCurrentYear(){return this.currentLanguage.buttons.toYearsView},ariaLabelForButtonToDays(){return this.currentLanguage.buttons.toDaysView}},watch:{value:{immediate:!0,handler:"updateNow"},defaultValue:{handler:"updateNow"},visible:{immediate:!0,handler:"init"},panel:{handler:"handelPanelChange"}},beforeUnmount(){this.destroyListenerForPressTabButton(),this.destroyListenerForPressEscapeButton()},methods:{handelPanelChange(e){e==="YEAR"?this.firstYear=Math.floor(this.calendarYear/10)*10:e==="TIME"&&this.$nextTick(()=>{const t=this.$el.querySelectorAll(".pux_datepicker__panel_time .pux_datepicker__time_list");for(let a=0,i=t.length;a<i;a++){const n=t[a];je(n,n.querySelector(".actived"))}})},init(e){if(e){const t=this.type;t==="month"?this.showPanelMonth():t==="year"?this.showPanelYear():t==="time"?this.showPanelTime():this.showPanelDate(),this.setListenerForPressEscapeButton()}else this.showPanelNone(),this.updateNow(this.value),this.destroyListenerForPressEscapeButton();this.emitEventBusDestroyAllListenerForPressButtonsForPanels()},getNow(e){return e?new Date(e):this.defaultValue&&x(this.defaultValue)?new Date(this.defaultValue):new Date},updateNow(e){this.now=this.getNow(e)},getCriticalTime(e){if(!e)return null;const t=new Date(e);return this.type==="year"?new Date(t.getFullYear(),0).getTime():this.type==="month"?new Date(t.getFullYear(),t.getMonth()).getTime():this.type==="date"?t.setHours(0,0,0,0):t.getTime()},inBefore(e,t){return t===void 0&&(t=this.startAt),this.notBeforeTime&&e<this.notBeforeTime||t&&e<this.getCriticalTime(t)},inAfter(e,t){return t===void 0&&(t=this.endAt),this.notAfterTime&&e>this.notAfterTime||t&&e>this.getCriticalTime(t)},inDisabledDays(e){return Array.isArray(this.disabledDays)?this.disabledDays.some(t=>this.getCriticalTime(t)===e):typeof this.disabledDays=="function"?this.disabledDays(new Date(e)):!1},isDisabledYear(e){const t=new Date(e,0).getTime(),a=new Date(e+1,0).getTime()-1;return this.inBefore(a)||this.inAfter(t)||this.type==="year"&&this.inDisabledDays(t)},isDisabledMonth(e){const t=new Date(this.calendarYear,e).getTime(),a=new Date(this.calendarYear,e+1).getTime()-1;return this.inBefore(a)||this.inAfter(t)||this.type==="month"&&this.inDisabledDays(t)},isDisabledDate(e){const t=new Date(e).getTime(),a=new Date(e).setHours(23,59,59,999);return this.inBefore(a)||this.inAfter(t)||this.inDisabledDays(t)},isDisabledTime(e,t,a){const i=new Date(e).getTime();return this.inBefore(i,t)||this.inAfter(i,a)||this.inDisabledDays(i)},selectDate(e){if(this.type==="datetime"){let t=new Date(e);Q(this.value)&&t.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds()),this.isDisabledTime(t)&&(t.setHours(0,0,0,0),this.notBefore&&t.getTime()<new Date(this.notBefore).getTime()&&(t=new Date(this.notBefore)),this.startAt&&t.getTime()<new Date(this.startAt).getTime()&&(t=new Date(this.startAt))),this.selectTime(t),this.showPanelTime();return}this.$emit("selectDate",e)},selectYear({year:e,isButtonClick:t}){if(this.changeCalendarYear(e),this.type.toLowerCase()==="year")return this.selectDate(new Date(this.now));this.showPanelMonth(),t&&this.setFocusToActivePanel()},selectMonth({month:e,isButtonClick:t}){if(this.changeCalendarMonth(e),this.type.toLowerCase()==="month")return this.selectDate(new Date(this.now));this.showPanelDate(),t&&this.setFocusToActivePanel()},selectTime(e,t=!1){this.$emit("selectTime",e,t)},changeCalendarYear(e){this.updateNow(new Date(e,this.calendarMonth))},changeCalendarMonth(e){this.updateNow(new Date(this.calendarYear,e))},getSibling(){const e=[this.$parent.$refs.calendarPanelRef];this.$parent.$refs.calendarPanel2Ref&&e.push(this.$parent.$refs.calendarPanel2Ref);const t=e.filter(i=>i.$options.name===this.$options.name),a=t.indexOf(this);return t[a^1]},handleIconMonth(e){const t=this.calendarMonth;this.changeCalendarMonth(t+e),this.$parent.$emit("changeCalendarMonth",{month:t,flag:e,vm:this,sibling:this.getSibling()})},handleIconYear(e){if(this.panel==="YEAR")this.changePanelYears(e);else{const t=this.calendarYear;this.changeCalendarYear(t+e),this.$parent.$emit("changeCalendarYear",{year:t,flag:e,vm:this,sibling:this.getSibling()})}},handleBtnYear(e){e.stopPropagation(),this.showPanelYear(),this.isWorkWithKeyboard&&this.setFocusToActivePanel()},handleBtnMonth(e){e.stopPropagation(),this.showPanelMonth(),this.isWorkWithKeyboard&&this.setFocusToActivePanel()},handleTimeHeader(e){e.stopPropagation(),this.type!=="time"&&(this.showPanelDate(),this.isWorkWithKeyboard&&this.setFocusToActivePanel())},changePanelYears(e){this.firstYear=this.firstYear+e*10},showPanelNone(){this.panel="NONE",this.isFocusPanelChild=!1,this.destroyListenerForPressTabButton(),this.emitEventBusDestroyAllListenerForPressButtonsForPanels(),this.setWorkWithoutKeyboard()},showPanelTime(){this.panel="TIME"},showPanelDate(){this.panel="DATE"},showPanelYear(){this.panel="YEAR"},showPanelMonth(){this.panel="MONTH"},setFocusToActivePanelFromParent(){this.setWorkWithKeyboard(),this.setFocusToActivePanel(),this.setListenerForPressTabButton()},setFocusToActivePanel(){this.isFocusPanelChild=!0,this.setFocusToActiveElementInChild()},removeFocusFromActivePanel(){this.isFocusPanelChild&&(this.isFocusPanelChild=!1,this.emitEventBusDestroyAllListenerForPressButtonsForPanels())},setFocusToActiveElementInChild(){this.panel==="DATE"?this.$refs.panelDate.setFocusToActiveDay():this.panel==="TIME"?this.$refs.panelTime.setFocusToActiveTime():this.panel==="YEAR"?this.$refs.panelYear.setFocusToActiveYear():this.panel==="MONTH"&&this.$refs.panelMonth.setFocusToActiveMonth()},setListenerForPressTabButton(){document.addEventListener("keydown",this.pressTabButton)},destroyListenerForPressTabButton(){document.removeEventListener("keydown",this.pressTabButton)},pressTabButton(e){e.keyCode===f.tab&&(this.trapFocus(e),this.stopCurrentEvent(e))},trapFocus(e){const t=this.$el.querySelectorAll(".pux_datepicker__calendar__tab");if(t.length<=1)return;let a=!1,i=!1;We(t,(n,u)=>{if(document.activeElement===n)return e.shiftKey?u===0?(t[t.length-1].focus(),i=!0):t[u-1].focus():(u===t.length-1?t[0].focus():t[u+1].focus(),u===t.length-2&&(i=!0)),a=!0,!1}),a||(e.shiftKey?t[t.length-2].focus():t[0].focus()),i?this.setFocusToActivePanel():this.removeFocusFromActivePanel()},setWorkWithKeyboard(){this.isWorkWithKeyboard=!0},setWorkWithoutKeyboard(){this.isWorkWithKeyboard=!1},setListenerForPressEscapeButton(){document.addEventListener("keydown",this.pressEscapeButton)},destroyListenerForPressEscapeButton(){document.removeEventListener("keydown",this.pressEscapeButton)},pressEscapeButton(e){e.keyCode===f.escape&&this.$emit("closePopup",!0)}},render(){return r("div",{class:["pux_datepicker__calendar",`pux_datepicker__calendar_${this.panel.toLowerCase()}`],role:"region","aria-labelledby":this.idForHeaderParent,onClick:e=>e.stopPropagation()},[r("div",{id:this.idForHeaderParent,class:"a_sr_only",role:"header"},[r("div",{id:this.idForHeader,"aria-live":"polite"},[this.panel==="DATE"&&r("span",null,this.months[this.calendarMonth]),(this.panel==="DATE"||this.panel==="MONTH")&&r("span",null,this.calendarYear),this.panel==="YEAR"&&r("span",null,this.yearHeader),this.panel==="TIME"&&r("span",null,this.timeHeader)]),r("div",null,this.suffixForHeader)]),r("div",{class:"pux_datepicker__calendar__header"},[r("div",null,[this.panel!=="TIME"&&r("button",{class:"pux_datepicker__icon_last_year pux_datepicker__calendar__tab",type:"button",ariaLabel:this.ariaLabelForButtonLastYear,innerHTML:"&laquo;",onClick:e=>{e.stopPropagation(),this.handleIconYear(-1)}}),this.panel==="DATE"&&r("button",{class:"pux_datepicker__icon_last_month pux_datepicker__calendar__tab",type:"button",ariaLabel:this.ariaLabelForButtonLastMonth,innerHTML:"&lsaquo;",onClick:e=>{e.stopPropagation(),this.handleIconMonth(-1)}})]),r("div",null,[this.panel==="DATE"&&r("button",{class:"pux_datepicker__current_month pux_datepicker__calendar__tab",type:"button",ariaLabel:this.ariaLabelForButtonCurrentMonth,onClick:this.handleBtnMonth},this.months[this.calendarMonth]),(this.panel==="DATE"||this.panel==="MONTH")&&r("button",{class:"pux_datepicker__current_year pux_datepicker__calendar__tab",type:"button",ariaLabel:this.ariaLabelForButtonCurrentYear,onClick:this.handleBtnYear},this.calendarYear),this.panel==="YEAR"&&r("span",{class:"pux_datepicker__current_year"},this.yearHeader),this.panel==="TIME"&&r("span",null,[this.type==="time"?r("span",{class:"pux_datepicker__time_header"},this.timeHeader):r("button",{class:"pux_datepicker__time_header pux_datepicker__calendar__tab",type:"button",ariaLabel:this.ariaLabelForButtonToDays,onClick:this.handleTimeHeader},this.timeHeader)])]),r("div",null,[this.panel==="DATE"&&r("button",{class:"pux_datepicker__icon_next_month pux_datepicker__calendar__tab",type:"button",ariaLabel:this.ariaLabelForButtonNextMonth,innerHTML:"&rsaquo;",onClick:e=>{e.stopPropagation(),this.handleIconMonth(1)}}),this.panel!=="TIME"&&r("button",{class:"pux_datepicker__icon_next_year pux_datepicker__calendar__tab",type:"button",ariaLabel:this.ariaLabelForButtonNextYear,innerHTML:"&raquo;",onClick:e=>{e.stopPropagation(),this.handleIconYear(1)}})])]),r("div",{class:"pux_datepicker__calendar__content",role:"application"},[r(re,{ref:"panelDate",id:this.id,style:this.panel!=="DATE"?"display: none;":"",class:{pux_datepicker__panel_focus:this.isFocusPanelChild,pux_datepicker__calendar__tab:this.panel==="DATE"},tabindex:0,value:this.value,dateFormat:this.dateFormat,calendarMonth:this.calendarMonth,calendarYear:this.calendarYear,startAt:this.startAt,endAt:this.endAt,firstDayOfWeek:this.firstDayOfWeek,disabledDate:this.isDisabledDate,currentLanguage:this.currentLanguage,onSelect:this.selectDate,onHandleIconMonth:this.handleIconMonth}),r(ue,{ref:"panelYear",id:this.id,style:this.panel!=="YEAR"?"display: none;":"",class:{pux_datepicker__panel_focus:this.isFocusPanelChild,pux_datepicker__calendar__tab:this.panel==="YEAR"},value:this.value,disabledYear:this.isDisabledYear,firstYear:this.firstYear,onSelect:this.selectYear,onHandleIconYear:this.handleIconYear}),r(ie,{ref:"panelMonth",id:this.id,style:this.panel!=="MONTH"?"display: none;":"",class:{pux_datepicker__panel_focus:this.isFocusPanelChild,pux_datepicker__calendar__tab:this.panel==="MONTH"},value:this.value,disabledMonth:this.isDisabledMonth,calendarYear:this.calendarYear,currentLanguage:this.currentLanguage,onSelect:this.selectMonth,onHandleIconYear:this.handleIconYear}),r(le,{ref:"panelTime",id:this.id,style:this.panel!=="TIME"?"display: none;":"",class:{pux_datepicker__panel_focus:this.isFocusPanelChild,pux_datepicker__calendar__tab:this.panel==="TIME"},minuteStep:this.minuteStep,value:this.value,disabledTime:this.isDisabledTime,timeType:this.timeType,currentLanguage:this.currentLanguage,onSelect:this.selectTime})])])}},Je={name:"ADatepickerIcon",computed:{svgHtml(){return`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 200 200" class="a_datepicker__calendar_icon">
        <rect x="13" y="29" rx="14" ry="14" width="174" height="158" fill="transparent"></rect> 
        <line x1="46" x2="46" y1="8" y2="50"></line> <line x1="154" x2="154" y1="8" y2="50"></line> 
        <line x1="13" x2="187" y1="70" y2="70"></line> 
        <text x="50%" y="135" font-size="90" stroke-width="1" text-anchor="middle" dominant-baseline="middle">${this.todayInDayFormat}</text>
      </svg>`},todayInDayFormat(){return new Date().getDate()}},render(){return r("span",{ariaHidden:!0,innerHTML:this.svgHtml})}};function Ze(e,{currentLanguage:t=T(()=>({})),popupVisible:a=g(!1)}){const i=p(e,"extra"),n=p(e,"id"),u=p(e,"placeholder"),l=p(e,"range"),y=p(e,"type"),h=p(e,"width"),_=T(()=>oe(u.value)?Te({placeholder:u.value,extra:i.value}):l.value?t.value.placeholder.dateRange:y.value==="time"?t.value.placeholder.time:t.value.placeholder.date),m=T(()=>`${n.value}_panel`),b=T(()=>[`${m.value}_0`,`${m.value}_1`]),c=T(()=>`${!a.value}`),w=T(()=>`${a.value}`),d=T(()=>`${n.value}_calendar`),F=T(()=>qe(h.value)||oe(h.value)&&/^\d+$/.test(h.value)?h.value+"px":h.value),D=T(()=>String(y.value).toLowerCase());return{ariaExpandedForCalendar:w,ariaHiddenForCalendar:c,idForCalendar:d,idForPanel:m,idsForPanelRange:b,innerPlaceholder:_,innerType:D,widthLocal:F}}function ze(e,{emit:t},{calendarPanelRef:a=g(void 0),changeModel:i=()=>{},closePopover:n=()=>{},setCloseFocus:u=()=>{}}){const l=p(e,"range"),y=p(e,"confirm"),h=p(e,"disabled"),_=p(e,"modelValue"),m=p(e,"formatSave"),b=p(e,"editable"),c=p(e,"format"),w=p(e,"type"),d=g(l.value?[null,null]:null),F=g(null),D=s=>!!ne(s,c.value,m.value),E=s=>{try{return Y(s,m.value).isValid()&&Y(s,m.value).format(c.value)||""}catch{return""}},H=s=>{try{return!!Y(s,m.value).isValid()}catch{return!1}},R=s=>O(c.value)&&typeof this.format.stringify=="function"?c.value.stringify(s):G(s,c.value),C=T(()=>F.value!==null?F.value:l.value?"":D(_.value)?E(_.value):""),L=(s,o)=>Q(s)&&Q(o)&&s.getTime()===o.getTime(),k=(s,o)=>Array.isArray(s)&&Array.isArray(o)&&s.length===o.length&&s.every((A,J)=>L(A,o[J])),M=s=>{const o=l.value?"":G(d.value,m.value);i({model:o}),t(s,o)},v=(s=!1)=>y.value&&!s||h.value||(l.value?k(_.value,d.value):L(_.value,d.value))?!1:(M("change"),!0),P=s=>{s&&s.stopPropagation();const o=l.value?[null,null]:null;d.value=o,v(!0),t("clear")},I=s=>{d.value=s,v()&&n(),u()},S=(s,o)=>{d.value=s,v()&&o&&n(),o&&u()},N=s=>{d.value[0]=s,d.value[1]&&v()},B=s=>{d.value[1]=s,d.value[0]&&v()},$=s=>{N(s)},W=s=>{B(s)},q=s=>O(c.value)&&typeof c.value.parse=="function"?c.value.parse(s):ne(s,c.value,m.value),U=s=>{try{return Y(s,c.value).isValid()&&Y(s,c.value).format()||null}catch{return null}},K=s=>{try{return Y(s,m.value).isValid()&&Y(s,m.value).format()||null}catch{return null}},V=()=>{if(b.value&&F.value!==null){let s=C.value;const o=a.value.isDisabledTime;if(!s){P();return}if(l.value)return;w.value==="time"&&(s=`${Y().format("DD.MM.YYYY")} ${s}`);const A=U(s);if(A&&!o(A,null,null)){d.value=A,v(!0),n();return}t("inputError",s)}},j=()=>{a.value.setFocusToActivePanelFromParent()};return{clearDate:P,confirmDate:()=>{(l.value?De(d.value):x(d.value))&&v(!0),M("confirm"),n()},currentValue:d,emitDate:M,handleChange:V,handleInput:s=>{F.value=s.target.value},handleKeydown:s=>{const o=s.keyCode;o===f.tab||o===f.enter?(V(),F.value=null,n()):(o===f.arrowUp||o===f.arrowDown)&&(j(),s.stopPropagation(),s.preventDefault())},onModelValueChange:s=>{l.value?d.value=[null,null]:d.value=H(s)?K(s):null},parse:q,selectDate:I,selectEndDate:B,selectEndTime:W,selectStartDate:N,selectStartTime:$,selectTime:S,stringify:R,text:C,updateDate:v,userInput:F}}const Ge={en:{days:[{shortName:"Sun",longName:"Sunday"},{shortName:"Mon",longName:"Monday"},{shortName:"Tue",longName:"Tuesday"},{shortName:"Wed",longName:"Wednesday"},{shortName:"Thu",longName:"Thursday"},{shortName:"Fri",longName:"Friday"},{shortName:"Sat",longName:"Saturday"}],months:["January","February","March","April","May","June","July","August","September","October","November","December"],pickers:["next 7 days","next 30 days","previous 7 days","previous 30 days"],placeholder:{date:"Enter date in format DD.MM.YYYY",time:"Enter time in format HH:MM",dateRange:"Select Date Range",regionDate:"Date picker",regionTime:"Time picker"},today:"today",buttons:{lastYear:"Last year",lastYears:"Last 10 years",nextYear:"Next year",nextYears:"Next 10 years",lastMonth:"Last month",nextMonth:"Next month",monthsView:"Show detailed month view",toDaysView:"Switch to the day selection",toMonthsView:"Switch to the month selection",toYearsView:"switch to the selection of the years"},hours:"Hours",minutes:"Minutes",seconds:"Seconds",headerYears:(e,t)=>`${e} to ${t}`},ru:{days:[{shortName:"Вс",longName:"Воскресенье"},{shortName:"Пн",longName:"Понедельник"},{shortName:"Вт",longName:"Вторник"},{shortName:"Ср",longName:"Среда"},{shortName:"Чт",longName:"Четверг"},{shortName:"Пт",longName:"Пятница"},{shortName:"Сб",longName:"Суббота"}],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],pickers:["след. 7 дней","след. 30 дней","прош. 7 дней","прош. 30 дней"],placeholder:{date:"Введите дату в формате ДД.ММ.ГГГГ",time:"Enter время in format ЧЧ.ММ",dateRange:"Выберите период",regionDate:"Выбор даты",regionTime:"Выбор времени"},today:"Сегодня",buttons:{lastYear:"Предыдущий год",lastYears:"Предыдущие 10 лет",nextYear:"Следующий год",nextYears:"Следующие 10 лет",lastMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",toDaysView:"Перейти к выбору дня",toMonthsView:"Перейти к выбору месяца",toYearsView:"Перейти к выбору года"},hours:"Часы",minutes:"Минуты",seconds:"Секунды",headerYears:(e,t)=>`с ${e} по ${t}`},de:{days:[{shortName:"So",longName:"Sontag"},{shortName:"Mo",longName:"Montag"},{shortName:"Di",longName:"Dienstag"},{shortName:"Mi",longName:"Mittwoch"},{shortName:"Do",longName:"Donnerstag"},{shortName:"Fr",longName:"Freitag"},{shortName:"Sa",longName:"Samstag"}],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],pickers:["nächste 7 Tage","nächste 30 Tage","vorige 7 Tage","vorige 30 Tage"],placeholder:{date:"Datum im Format TT.MM.JJJJ eingeben",time:"Zeit im Format HH.MM eingeben",dateRange:"Zeitraum auswählen",regionDate:"Datumsauswahl",regionTime:"Zeitauswahl"},today:"Heute",buttons:{lastYear:"Voriges Jahr",lastYears:"Vorige 10 Jahre",nextYear:"Nächstes Jahr",nextYears:"Nächste 10 Jahre",lastMonth:"Voriger Monat",nextMonth:"Nächster Monat",toDaysView:"Zur Auswahl der Tage wechseln",toMonthsView:"Zur Auswahl der Monate wechseln",toYearsView:"Zur Auswahl der Jahre wechseln"},hours:"Stunden",minutes:"Minuten",seconds:"Sekunden",headerYears:(e,t)=>`${e} bis ${t}`}};function Qe(e){const t=p(e,"languages"),a=p(e,"lang"),i=T(()=>({...Ge,...t.value}));return{currentLanguage:T(()=>i.value[a.value])}}function Xe(e,{calendarRef:t=g(void 0),focusByCloseRef:a=g(void 0),inputRef:i=g(void 0)}){const n=p(e,"placement"),u=p(e,"disabled"),l=g(void 0),y=g(void 0),h=()=>{document.addEventListener("click",F)},_=()=>{document.removeEventListener("click",F)},m=()=>{!l.value&&!u.value&&i.value&&t.value&&(l.value=Pe(i.value,t.value,()=>{t.value&&i.value&&Ie(i.value,t.value,{placement:n.value,middleware:[Se(),Ne({limiter:Be()})]}).then(({x:D,y:E})=>{Object.assign(t.value.style,{left:`${D}px`,top:`${E}px`})})}),setTimeout(()=>{h()},300))},b=()=>{a.value&&a.value.focus&&a.value.focus()},c=()=>{l.value&&(l.value(),l.value=void 0)},w=D=>{_(),c(),y.value=!1,D&&b()},d=()=>{y.value=!0};function F(D){t.value.contains(D.target)||w()}return ke(()=>{c(),_()}),{closePopover:w,destroyPopover:c,initCalendar:d,openPopoverWithFloatingUi:m,popupVisible:y,setCloseFocus:b}}function et(){const e=g(void 0),t=g(void 0),a=g(void 0),i=g(void 0),n=g(void 0);return{calendarRef:e,calendarPanelRef:t,calendarPanel2Ref:a,focusByCloseRef:n,inputRef:i}}const z={date:{value2date:e=>x(e)?new Date(e):null,date2value:e=>e},timestamp:{value2date:e=>x(e)?new Date(e):null,date2value:e=>e&&new Date(e).getTime()}},it={name:"ADatepicker",mixins:[Ue],inheritAttrs:!1,props:{alwaysTranslate:{type:Boolean,required:!1},appendToBody:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},confirm:{type:Boolean,default:!1},confirmText:{type:String,default:"OK"},dateFormat:{type:String,default:void 0},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},firstDayOfWeek:{type:Number,required:!1,default:1,validator:e=>e>=1&&e<=7},format:{type:[String,Object],default:"DD.MM.YYYY"},formatSave:{type:String,required:!1,default:"YYYY-MM-DD"},iconDay:{type:[Number,String],default:void 0},inputAttr:{type:Object,required:!1,default:()=>({})},inputClass:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],default:"pux_datepicker__input"},inputName:{type:String,default:"date"},isLabelFloat:{type:Boolean,required:!1,default:!1},labelScreenReader:{type:String,required:!1,default:void 0},lang:{type:String,default:"de",required:!1},languages:{type:Object,required:!1,default:()=>({})},modelValue:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],default:void 0},placeholder:{type:String,default:null},placement:{type:String,required:!1,default:"bottom-start",validator:e=>ve.indexOf(e)!==-1},popupStyle:{type:Object,required:!1,default:()=>({})},range:{type:Boolean,default:!1},rangeSeparator:{type:String,default:"~"},shortcuts:{type:[Boolean,Array],default:!0},type:{type:String,default:"date"},valueType:{default:"format",validator:function(e){return["timestamp","format","date"].indexOf(e)!==-1||O(e)}},width:{type:[String,Number],default:null}},emits:["blur","change","clear","confirm","focus","input","inputError","changeCalendarMonth","changeCalendarYear"],setup(e,t){const a=p(e,"modelValue"),{attributesToExcludeFromRender:i}=xe(e),{calendarRef:n,calendarPanelRef:u,calendarPanel2Ref:l,focusByCloseRef:y,inputRef:h}=et(),{componentStyleHide:_}=we(e),{ariaDescribedbyLocal:m,changeModel:b,clearModel:c,errorsId:w,helpTextId:d,htmlIdLocal:F,isErrors:D,isModel:E,onBlur:H,onFocus:R}=Ye(e,t),{isAutofill:C}=Ae({inputRef:h}),{currentLanguage:L}=Qe(e),{closePopover:k,destroyPopover:M,initCalendar:v,openPopoverWithFloatingUi:P,popupVisible:I,setCloseFocus:S}=Xe(e,{calendarRef:n,focusByCloseRef:y,inputRef:h}),{ariaExpandedForCalendar:N,ariaHiddenForCalendar:B,idForCalendar:$,idForPanel:W,idsForPanelRange:q,innerPlaceholder:U,innerType:K,widthLocal:V}=Ze(e,{currentLanguage:L,popupVisible:I}),{clearDate:j,confirmDate:ee,currentValue:te,emitDate:ae,handleChange:se,handleInput:s,handleKeydown:o,onModelValueChange:A,parse:J,selectDate:de,selectEndDate:he,selectEndTime:ce,selectStartDate:pe,selectStartTime:me,selectTime:fe,stringify:ye,text:_e,updateDate:ge,userInput:Fe}=ze(e,t,{calendarPanelRef:u,changeModel:b,closePopover:k,setCloseFocus:S}),be=()=>{h.value&&h.value.blur()};return Ve(a,A,{immediate:!0}),{ariaDescribedbyLocal:m,ariaExpandedForCalendar:N,ariaHiddenForCalendar:B,attributesToExcludeFromRender:i,blur:be,calendarPanel2Ref:l,calendarPanelRef:u,calendarRef:n,changeModel:b,clearDate:j,clearModel:c,parse:J,closePopover:k,componentStyleHide:_,confirmDate:ee,stringify:ye,currentLanguage:L,currentValue:te,destroyPopover:M,emitDate:ae,errorsId:w,text:_e,focusByCloseRef:y,handleChange:se,handleInput:s,handleKeydown:o,helpTextId:d,htmlIdLocal:F,idForCalendar:$,idForPanel:W,idsForPanelRange:q,initCalendar:v,innerPlaceholder:U,innerType:K,inputRef:h,isAutofill:C,isErrors:D,isModel:E,onBlur:H,onFocus:R,openPopoverWithFloatingUi:P,popupVisible:I,selectDate:de,selectEndDate:he,selectEndTime:ce,selectStartDate:pe,selectStartTime:me,selectTime:fe,setCloseFocus:S,updateDate:ge,userInput:Fe,widthLocal:V}},computed:{transform(){const e=this.valueType;return O(e)?{...z.date,...e}:e==="format"?{value2date:this.parse.bind(this),date2value:this.stringify.bind(this)}:z[e]||z.date},showClearIcon(){return!this.disabled&&this.clearable&&this.text},innerShortcuts(){if(Array.isArray(this.shortcuts))return this.shortcuts;if(this.shortcuts===!1)return[];const e=this.currentLanguage.pickers;return[{text:e[0],onClick(a){a.currentValue=[new Date,new Date(Date.now()+3600*1e3*24*7)],a.updateDate(!0)}},{text:e[1],onClick(a){a.currentValue=[new Date,new Date(Date.now()+3600*1e3*24*30)],a.updateDate(!0)}},{text:e[2],onClick(a){a.currentValue=[new Date(Date.now()-3600*1e3*24*7),new Date],a.updateDate(!0)}},{text:e[3],onClick(a){a.currentValue=[new Date(Date.now()-3600*1e3*24*30),new Date],a.updateDate(!0)}}]},innerDateFormat(){return this.dateFormat?this.dateFormat:typeof this.format!="string"?"YYYY-MM-DD":this.innerType==="date"?this.format:this.format.replace(/[Hh]+.*[msSaAZ]|\[.*?\]/g,"").trim()||"YYYY-MM-DD"}},watch:{popupVisible(e){e?this.initCalendar():(this.userInput=null,this.blur())}},methods:{isValidValue(e){const{value2date:t}=this.transform;return x(t(e))},isValidRangeValue(e){const{value2date:t}=this.transform;return Array.isArray(e)&&e.length===2&&this.isValidValue(e[0])&&this.isValidValue(e[1])&&t(e[1]).getTime()>=t(e[0]).getTime()},selectRange(e){typeof e.onClick=="function"?e.onClick(this)!==!1&&this.closePopover():(this.currentValue=[new Date(e.start),new Date(e.end)],this.updateDate(!0),this.closePopover())},handleBlur(e){this.$emit("blur",e)},handleFocus(e){this.initCalendar(),this.$emit("focus",e)}},render(){return this.isRender?r("div",{...this.$attrs,class:"a_form_element__container",style:this.componentStyleHide,...this.attributesToExcludeFromRender},[r("div",{class:["a_form_element__parent",{a_form_element__parent_float:this.isLabelFloat,a_form_element__parent_not_empty:this.isModel||this.isAutofill}]},[this.label&&r(Ee,{id:this.htmlIdLocal,alwaysTranslate:this.alwaysTranslate,label:this.label,labelClass:this.labelClass,labelScreenReader:this.labelScreenReader,required:this.required,type:this.type,isLabelFloat:this.isLabelFloat,isError:this.isErrors}),r("div",{class:"a_form_element"},[r("div",{class:["pux_datepicker",{pux_datepicker_range:this.range,disabled:this.disabled}],style:{width:this.widthLocal},onMousedown:this.initCalendar,onTouchstart:this.initCalendar},[r("div",{class:"pux_datepicker__input_wrapper",role:"application"},[r("input",{ref:"inputRef",id:this.htmlIdLocal,class:["a_form_control pux_datepicker__input",this.inputClass,{a_form_control_invalid:this.isErrors}],name:this.inputName,type:"text",autocomplete:"off",disabled:this.disabled,readonly:!this.editable,value:this.text,placeholder:this.innerPlaceholder,ariaHaspopup:!0,"aria-owns":this.idForCalendar,...this.inputAttr,onKeydown:this.handleKeydown,onFocus:this.handleFocus,onBlur:this.handleBlur,onInput:this.handleInput,onChange:this.handleChange}),this.showClearIcon&&r("span",{class:"pux_datepicker__input_wrapper__append pux_datepicker__input_wrapper__clear_wrapper",ariaHidden:!0,onMousedown:this.clearDate},[r("i",{class:"pux_datepicker__input__icon pux_datepicker__input__clear_icon"})]),r("span",{class:"pux_datepicker__input_wrapper__append"},[r(Je)])]),r(Oe,{to:"body"},[this.popupVisible&&He(r("div",{ref:"calendarRef",id:this.idForCalendar,class:"pux_datepicker__popup",ariaHidden:this.ariaHiddenForCalendar,ariaExpanded:this.ariaExpandedForCalendar,style:this.popupStyle},[!!(this.range&&this.innerShortcuts.length)&&r("div",{class:"pux_datepicker__shortcuts_wrapper"},[this.innerShortcuts.map((e,t)=>r("button",{key:t,class:"pux_datepicker__shortcuts_wrapper__shortcuts",type:"button",onClick:()=>this.selectRange(e)},e.text))]),this.range?r("div",{class:"pux_datepicker__range_wrapper"},[r(Z,{ref:"calendarPanelRef",id:this.idsForPanelRange[0],style:"box-shadow: 1px 0 rgba(0, 0, 0, .1);",index:0,type:this.innerType,dateFormat:this.innerDateFormat,value:this.currentValue[0],endAt:this.currentValue[1],startAt:null,visible:this.popupVisible,currentLanguage:this.currentLanguage,firstDayOfWeek:this.firstDayOfWeek,onSelectDate:this.selectStartDate,onSelectTime:this.selectStartTime,onClosePopup:this.closePopover}),r(Z,{ref:"calendarPanel2Ref",id:this.idsForPanelRange[1],index:1,type:this.innerType,dateFormat:this.innerDateFormat,value:this.currentValue[1],endAt:null,startAt:this.currentValue[0],visible:this.popupVisible,currentLanguage:this.currentLanguage,firstDayOfWeek:this.firstDayOfWeek,onSelectDate:this.selectEndDate,onSelectTime:this.selectEndTime,onClosePopup:this.closePopover})]):r(Z,{ref:"calendarPanelRef",id:this.idForPanel,index:-1,type:this.innerType,dateFormat:this.innerDateFormat,value:this.currentValue,visible:this.popupVisible,currentLanguage:this.currentLanguage,firstDayOfWeek:this.firstDayOfWeek,onSelectDate:this.selectDate,onSelectTime:this.selectTime,onClosePopup:this.closePopover}),this.confirm&&r("div",{class:"pux_datepicker__footer"},[r("button",{class:"pux_datepicker__footer__btn pux_datepicker__footer__btn_confirm",type:"button",onClick:this.confirmDate},this.confirmText)])]),[[Le,{mounted:this.openPopoverWithFloatingUi}]])]),r("div",{ref:"focusByCloseRef",ariaHidden:!0,tabindex:-1})])]),r(Me,{id:this.helpTextId,alwaysTranslate:this.alwaysTranslate,html:this.helpText,extra:this.extra}),this.isErrors&&r(Ce,{id:this.errorsId,alwaysTranslate:this.alwaysTranslate,errors:this.errors})])]):null}};export{it as A};
