import{D as T,I as O,a as Z,L as $,b as K,r as ee,s as te,U as ae,t as le,u as ne,M as ie,P as se,am as re,an as y}from"./bundle.index.DOWaPX07.js";import{U as ue}from"./chunk.UiMixinProps.3z5E7Tu9.js";import{i as N,h as L,c as S}from"./chunk.vendor-lodash.Cqnw6GrA.js";import{t as n,a as _,r as g,h as p,b as oe}from"./chunk.vendor.9_E-x6sT.js";import{t as E}from"./chunk.utilsMath.D900FRx8.js";const de={props:{clearButtonClass:{type:[String,Object],required:!1,default:void 0},isClearButton:{type:Boolean,required:!1,default:!0}}};function ce(e,{currentValue:u=g(0),displayValue:d=_(()=>""),ensurePrecision:i=()=>{},setCurrentValue:c=()=>{},minLocal:a=_(()=>{})}){const s=n(e,"disabled"),v=n(e,"modelValue"),x=n(e,"max"),f=n(e,"readonly"),I=_(()=>N(v.value)&&v.value<=a.value),w=_(()=>N(v.value)&&v.value>=x.value);return{increase:()=>{if(f.value||s.value||w.value)return;const b=Number(d.value)||0,l=i({value:b,currentValue:u.value});c(l)},decrease:()=>{if(f.value||s.value||I.value)return;const b=Number(d.value)||0,l=i({value:b,currentValue:u.value,coefficient:-1});c(l)}}}function fe(e,{decrease:u=()=>{},increase:d=()=>{},inputRef:i=g({}),onBlur:c=()=>{},setCurrentValue:a=()=>{},userInput:s=g(null),currentValue:v=g(void 0),displayValue:x=_(()=>""),isTypeNumber:f=_(()=>!0)}){const I=n(e,"type"),w=n(e,"eAllowed"),A=n(e,"min"),m=n(e,"modelValue");return{handleInput:r=>{if(f.value){const h=r.target.value;s.value=h;const o=h===""?null:Number(h);a(o,!1);return}let t=r.target.value.trim();if(I.value==="integerNonNegative"){const h=t.match(/\d+/g);let o=0;h!==null?(o=parseInt(h.join(""),10),o=Math.max(o,0),t=o):t=null,a(t),i.value.value=t}else if(I.value==="integerPositive"){if(t==="0")t=null;else{const h=t.match(/\d+/g);let o=0;h!==null?(o=parseInt(h.join(""),10),o=Math.max(o,1),t=o):t=null}a(t),i.value.value=t}else if(I.value==="integer"){const h=t.match(/\d+/g);let o=0;h!==null?(o=parseInt(h.join(""),10),t.indexOf("-")!==-1&&(o=-o),t=o,a(t),i.value.value=t):t==="-"?(t="-",i.value.value=t):(t=null,a(t),i.value.value=t)}},handleInputChange:r=>{if(!f.value)return;const t=r.target.value,h=t!==""?Number(t):"";(N(h)&&!Number.isNaN(h)||t==="")&&a(h),s.value=null},handleKeydown:r=>{r.keyCode===T.arrowUp?(d(),r.preventDefault()):r.keyCode===T.arrowDown?(u(),r.preventDefault()):(!w.value&&r.keyCode===T.e||A.value>=0&&r.keyCode===T.minus||r.keyCode===T.plus)&&(r.preventDefault(),r.stopPropagation())},onBlurNumber:r=>{(s.value!==null||!m.value&&m.value!==0)&&(s.value=null,v.value=m.value,i.value.value=x.value),c(r)}}}function me(e){const u=n(e,"type"),d=n(e,"min");return{minLocal:_(()=>{let c;return u.value==="integerNonNegative"?c=0:u.value==="integerPositive"&&(c=1),(L(c)||!S(d.value)&&d.value>c)&&(c=d.value),c})}}function he(e,{verifyValue:u=()=>{},changeModel:d=()=>{}}){const i=n(e,"precision"),c=n(e,"modelValue"),a=g(null),s=g(c.value),v=_(()=>{if(a.value!==null)return a.value;let f=s.value;if(S(f))return"";if(N(f)){if(Number.isNaN(f))return"";L(i.value)||(f=f.toFixed(i.value))}return f});return{currentValue:s,displayValue:v,setCurrentValue:(f,I=!0)=>{const w=s.value,A=u(f);if(w!==A){if(!I){d({model:A});return}a.value=null,d({model:A}),s.value=A}},userInput:a}}function pe(e){const u=n(e,"max"),d=n(e,"min"),i=n(e,"step"),c=n(e,"type"),a=_(()=>c.value==="number"),s=_(()=>a.value?"number":"text"),v=_(()=>a.value?{max:u.value,min:d.value,step:i.value}:{});return{inputType:s,isTypeNumber:a,numberAttributes:v}}function ve(e,{changeModel:u=()=>{},minLocal:d=_(()=>{})}){const i=n(e,"modelUndefined"),c=n(e,"stepStrictly"),a=n(e,"step"),s=n(e,"precision"),v=n(e,"max"),x=n(e,"modelValue"),f=m=>{if(S(m))return 0;const b=m.toString(),l=b.indexOf(".");let P=0;return l!==-1&&(P=b.length-l-1),P},I=_(()=>{const m=f(a.value);return L(s.value)?Math.max(f(x.value),m):(m>s.value&&console.warn("AInputNumber","precision should not be less than the decimal places of step"),s.value)});return{ensurePrecision:({value:m,currentValue:b,coefficient:l=1})=>N(m)?E(m+a.value*l,I.value):b,verifyValue:(m,b)=>{let l=Number(m);return S(m)||Number.isNaN(l)?null:(m===""&&(l=i.value),c.value&&(l=E(Math.round(l/a.value)*a.value,s.value)),L(s.value)||(l=E(l,s.value)),l>v.value?(l=v.value,b&&u({model:l})):l<d.value&&(l=d.value,b&&u({model:l})),l)}}}function be(e){const u=n(e,"inputWidth");return{inputWidthStyleValue:_(()=>{let i=u.value;return N(u.value)&&(i=`${u.value}px`),L(i)?{}:{"--a_input_number_width":i}})}}const xe={name:"AInputNumber",inheritAttrs:!1,mixins:[de,ue],props:{alwaysTranslate:{type:Boolean,required:!1},autocomplete:{type:String,required:!1,default:void 0},controlsType:{type:String,required:!1,default:()=>y.value.propsDefault.controlsType,validator:e=>["plus-minus","arrows","none"].indexOf(e)!==-1},eAllowed:{type:Boolean,required:!1,default:()=>y.value.propsDefault.eAllowed},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},iconPrepend:{type:String,required:!1,default:()=>y.value.propsDefault.iconPrepend},inputWidth:{type:[String,Number],required:!1,default:()=>y.value.propsDefault.inputWidth},isLabelFloat:{type:Boolean,required:!1,default:()=>y.value.propsDefault.isLabelFloat},labelScreenReader:{type:String,required:!1,default:void 0},max:{type:Number,required:!1,default:()=>y.value.propsDefault.max},min:{type:Number,required:!1,default:()=>y.value.propsDefault.min},modelUndefined:{required:!1,default:()=>y.value.propsDefault.modelUndefined},placeholder:{type:[String,Number,Object],required:!1,default:()=>y.value.propsDefault.placeholder},precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10),default:()=>y.value.propsDefault.precision},readonly:{type:Boolean,required:!1,default:()=>y.value.propsDefault.readonly},step:{type:Number,required:!1,default:()=>y.value.propsDefault.step},stepStrictly:{type:Boolean,required:!1,default:()=>y.value.propsDefault.stepStrictly},type:{type:String,required:!1,default:()=>y.value.propsDefault.type,validator:e=>["number","integerNonNegative","integerPositive","integer"].indexOf(e)!==-1}},setup(e,u){const{attributesToExcludeFromRender:d}=ae(e),{componentStyleHide:i}=le(e),{ariaDescribedbyLocal:c,changeModel:a,clearModel:s,errorsId:v,helpTextId:x,htmlIdLocal:f,isErrors:I,isModel:w,onBlur:A,onFocus:m}=ne(e,u),{isClearButtonLocal:b}=ie(e,{isModel:w}),{minLocal:l}=me(e),{inputType:P,isTypeNumber:U,numberAttributes:r}=pe(e),{placeholderAttributes:t}=se(e),{inputWidthStyleValue:h}=be(e),o=g(void 0),j=n(e,"disabled"),H=F=>{if(j.value)return;const V=F.target.value;a({model:+V})},{isAutofill:z}=re({inputRef:o}),{ensurePrecision:G,verifyValue:q}=ve(e,{changeModel:a,minLocal:l}),{currentValue:C,displayValue:B,setCurrentValue:M,userInput:D}=he(e,{verifyValue:q,changeModel:a}),{increase:R,decrease:W}=ce(e,{currentValue:C,displayValue:B,ensurePrecision:G,setCurrentValue:M,minLocal:l}),{handleInput:J,handleInputChange:Q,handleKeydown:X,onBlurNumber:Y}=fe(e,{currentValue:C,decrease:W,displayValue:B,increase:R,inputRef:o,onBlur:A,setCurrentValue:M,userInput:D,isTypeNumber:U});return oe(()=>e.modelValue,F=>{const V=q(D.value),k=q(F,!0);!N(V)&&(!V||V!==k)&&(C.value=k,D.value=null)},{immediate:!0}),{ariaDescribedbyLocal:c,attributesToExcludeFromRender:d,clearModel:s,componentStyleHide:i,currentValue:C,decrease:W,displayValue:B,errorsId:v,handleInput:J,handleInputChange:Q,handleKeydown:X,helpTextId:x,htmlIdLocal:f,increase:R,inputRef:o,inputType:P,inputWidthStyleValue:h,isAutofill:z,isClearButtonLocal:b,isErrors:I,isModel:w,numberAttributes:r,onBlurNumber:Y,onFocus:m,onInput:H,placeholderAttributes:t,userInput:D}},render(){return this.isRender?p("div",{...this.$attrs,style:this.componentStyleHide,...this.attributesToExcludeFromRender},[p("div",{class:"a_form_element__container"},[p("div",{class:["a_form_element__parent",{a_form_element__parent_float:this.isLabelFloat,a_form_element__parent_not_empty:this.isModel||this.isAutofill,a_form_element__parent_float_has_icon_prepend:this.iconPrepend,a_form_element__parent_invalid:this.isErrors}]},[this.label&&!this.isLabelFloat&&p(O,{id:this.htmlIdLocal,alwaysTranslate:this.alwaysTranslate,label:this.label,labelClass:this.labelClass,labelScreenReader:this.labelScreenReader,required:this.required,type:this.type,isLabelFloat:this.isLabelFloat,isError:this.isErrors}),p("div",{class:["a_form_element_number",{a_form_element_number_controls:this.controlsType!=="none"}]},[p("div",{class:"a_form_element",style:{...this.inputWidthStyleValue}},[this.label&&this.isLabelFloat&&p(O,{id:this.htmlIdLocal,alwaysTranslate:this.alwaysTranslate,label:this.label,labelClass:this.labelClass,labelScreenReader:this.labelScreenReader,required:this.required,type:this.type,isLabelFloat:this.isLabelFloat,isError:this.isErrors}),this.iconPrepend&&p(Z,{icon:this.iconPrepend,class:"a_input__icon_prepend"}),p("input",{ref:"inputRef",id:this.htmlIdLocal,autocomplete:this.autocomplete,value:this.displayValue,type:this.inputType,class:["a_form_control a_input a_input_number",this.inputClass,{a_form_element_with_one_btn:this.isClearButtonLocal,a_form_control_invalid:this.isErrors}],disabled:this.disabled,ariaRequired:this.required,ariaInvalid:this.isErrors,"aria-describedby":this.ariaDescribedbyLocal,...this.numberAttributes,...this.placeholderAttributes,...this.inputAttributes,onInput:this.handleInput,onChange:this.handleInputChange,onKeydown:this.handleKeydown,onFocus:this.onFocus,onBlur:this.onBlurNumber}),this.isClearButtonLocal?p("div",{class:"a_form_control__actions"},[p($,{alwaysTranslate:this.alwaysTranslate,disabled:this.disabled,class:this.clearButtonClass,onClear:this.clearModel})]):""]),this.controlsType==="plus-minus"&&p("div",{class:"a_btn_group"},[p(K,{alwaysTranslate:this.alwaysTranslate,class:"a_btn a_btn_outline_secondary",iconLeft:"Minus",tabindex:-1,attributes:{role:"button"},disabled:this.disabled,onClick:this.decrease}),p(K,{alwaysTranslate:this.alwaysTranslate,class:"a_btn a_btn_outline_secondary",iconLeft:"Plus",tabindex:-1,attributes:{role:"button"},disabled:this.disabled,onClick:this.increase})])]),p(ee,{id:this.helpTextId,alwaysTranslate:this.alwaysTranslate,html:this.helpText,extra:this.extra}),this.isErrors&&p(te,{id:this.errorsId,alwaysTranslate:this.alwaysTranslate,errors:this.errors})])])]):null}};export{xe as A};
