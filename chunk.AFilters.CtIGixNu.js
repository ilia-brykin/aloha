import{ab as G,X as se,Y as ne,ap as N,aq as de,ar as oe,a7 as ue,as as ce,N as U,at as _e,y as fe,au as H,av as w,g as B,aw as pe,f as D,A as q,d as ve,c as z,w as W,ax as Fe,u as he,Q as be,C as ye,G as k,O as X,b as Se,ay as Y,az as P}from"./bundle.index.BLKvx0Zd.js";import{t as o,d as u,h as c,br as Ae,g as J,f as K,o as Z,r as I,bs as Ee,bt as Te,bu as Ie,J as me,bn as Ce,bl as Le,S as Me,T as ge}from"./chunk.vendor.DmOTRqbf.js";import{i as Re,c as L,h as V,a as De,o as Q,j as O,g as $,m as ee,f as C,n as j,a8 as xe,N as Be,u as Ve}from"./chunk.vendor-lodash.DsZvX3G1.js";function Oe(){return{componentTypesMapping:()=>({...ne,...se,...G.components,...G.containerComponents})}}function Pe(e){const t=o(e,"filter");return{isContainer:u(()=>!!N.value[t.value.type])}}function qe(e){const t=o(e,"filter");return{filterSpecificAttributes:u(()=>{const i={},r=de[t.value.type],a=oe[t.value.type];return r&&Re(t.value.inputWidth)&&(i.inputWidth="auto"),a&&(i.inputWidth="inherit",i.inputAttributes={style:"min-width: 181px"}),i})}}function Ne(e){const t=o(e,"id");return{idPrefix:u(()=>`${t.value}_`)}}function Ue(e,{isContainer:t=u(()=>!1)}){const l=o(e,"filter"),i=o(e,"onUpdateModelFilters"),r=o(e,"unappliedModel");return{onUpdateModelFiltersLocal:s=>{if(t.value)i.value({fullModel:s});else{const d=L(r.value);d[l.value.id]=L(s),i.value({fullModel:d})}}}}function Ke(e){const t=o(e,"filter"),l=o(e,"updateDataKeyByIdFromFilter"),i=["select","multiselect","radio","checkbox","group","fieldset"],r=({dataKeyByKeyId:s,item:d})=>{let _=t.value.id;d&&(_=d.id),l.value({filterId:_,dataKeyByKeyId:s})};return{emitForComponentsWithData:u(()=>{const s={};return i.indexOf(t.value.type)!==-1&&(s.onUpdateData=r),s})}}const we={name:"AFiltersHorizontalFilterUi",props:{excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filter:{type:Object,required:!1,default:void 0},id:{type:String,required:!0},isLabelVisible:{type:Boolean,required:!0},onUpdateModelFilters:{type:Function,required:!0},unappliedModel:{type:Object,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0}},setup(e){const{attributesToExcludeFromRender:t}=ue(e),{isContainer:l}=Pe(e),{onUpdateModelFiltersLocal:i}=Ue(e,{isContainer:l}),{emitForComponentsWithData:r}=Ke(e),{idPrefix:a}=Ne(e),{componentTypesMapping:s}=Oe(),{filterSpecificAttributes:d}=qe(e);return{attributesToExcludeFromRender:t,componentTypesMapping:s,emitForComponentsWithData:r,filterSpecificAttributes:d,idPrefix:a,isContainer:l,onUpdateModelFiltersLocal:i}},render(){const e=this.componentTypesMapping()[this.filter.type];return c(e,{idPrefix:this.idPrefix,modelValue:this.isContainer?this.unappliedModel:this.unappliedModel[this.filter.id],"onUpdate:modelValue":this.onUpdateModelFiltersLocal,excludeRenderAttributes:this.excludeRenderAttributes,...this.filter,...this.filterSpecificAttributes,label:this.isLabelVisible?this.filter.label:void 0,...this.emitForComponentsWithData,...this.attributesToExcludeFromRender},this.$slots)}};function Ge(e){const t=o(e,"id");return{idFilterRight:u(()=>`${t.value}_filter_right`)}}const He={name:"AFilersRight",props:{appliedModel:{type:Object,required:!0},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filters:{type:Array,required:!1,default:()=>[]},filtersKeyById:{type:Object,required:!0},id:{type:String,required:!0},onUpdateModelFilters:{type:Function,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0}},emits:["startSearch"],setup(e){const{idFilterRight:t}=Ge(e);return{idFilterRight:t}},render(){return c("div",{id:this.idFilterRight,class:"a_filters_right"},[c("form",{},[this.filters.map(e=>c(we,{id:this.id,class:"a_filters_right__filter_ui",excludeRenderAttributes:this.excludeRenderAttributes,filter:e,isLabelVisible:!0,onUpdateModelFilters:this.onUpdateModelFilters,unappliedModel:this.appliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter},this.$slots))])])}};function ke(e){const t=o(e,"closeFilterValue"),l=o(e,"disabled"),i=o(e,"filter");return{closeCurrentFilterValue:({modelValue:a})=>{l.value||t.value({filter:i.value,modelArray:a.modelArray,keyId:a.keyId})}}}function $e(e,{emit:t},{modelValuesForCurrentFilter:l=u(()=>[])}){const i=o(e,"filter"),r=u(()=>l.value.length>0);return{isLeastOneFilterVisible:r,updateVisibleChildFilters:({destroy:s}={})=>{t("updateVisibleChildFilters",{id:i.value.id,isVisible:s?!1:r.value})}}}function je(e){const t=o(e,"filter"),l=o(e,"id"),i=u(()=>`eventATableFilterTopOnOpen_${l.value}`);return{goToFilter:({modelValue:a}={})=>{let s=ce({id:t.value.id,idPrefix:`${l.value}_filter_top`,htmlId:t.value.htmlId});a.idSuffix&&(s+=a.idSuffix),t.value.main||U.$emit(i.value,s)}}}function ze({filter:e,currentModel:t}){return!(!e||e.hideFilterCenter||V(t)||t===""||De(t)&&!t.length)}function We(e){const t=o(e,"filter"),l=o(e,"model");return{hasCurrentFilter:u(()=>ze({filter:t.value,currentModel:l.value}))}}function Xe(e,{emit:t},{hasCurrentFilter:l=u(()=>!1)}){const i=o(e,"dataKeyByKeyIdPerFilter"),r=o(e,"filter"),a=u(()=>l.value&&_e.value[r.value.type]?Q(i.value[r.value.id]):!1);return{isFilterLoading:a,updateLoadingChildFilters:(d,_)=>{d!==_&&t("updateLoadingChildFilters",{id:r.value.id,isLoading:a.value})}}}function Ye(e,{hasCurrentFilter:t=u(()=>!1)}){const l=o(e,"filter"),i=u(()=>t.value?l.value.label:""),r=u(()=>{if(t.value)return l.value.labelScreenReader}),a=u(()=>r.value||i.value);return{filterLabel:i,filterLabelForTitle:a}}function Je(e,{filterLabel:t=u(()=>""),filterLabelForTitle:l=u(()=>""),hasCurrentFilter:i=u(()=>!1)}){const r=o(e,"dataKeyByKeyIdPerFilter"),a=o(e,"filter"),s=o(e,"model"),{filterBoolean:d,filterDate:_}=fe(),b=u(()=>{if(a.value)return r.value[a.value.id]}),v=u(()=>{var F;return(F=s.value)!=null&&F.length?O(s.value,h=>b.value&&b.value[h]):[]}),n=({label:F,suffixTranslated:h})=>{const A=B({placeholder:F});return h?`${A} ${h}`:A};return{modelValuesForCurrentFilter:u(()=>{var F,h,A,y,p,S,m,R,x;if(!i.value)return[];if(a.value.type==="switch"||a.value.type==="oneCheckbox")return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:d(s.value)}];if(a.value.type==="date")return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:_(s.value)}];if(a.value.type==="select"||a.value.type==="radio"){const E=$(b.value,`${s.value}.${H}`);return E?[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:E}]:[]}if(w.value[a.value.type]||a.value.type==="radio"&&a.value.isModelArray){if(v.value.length){if(v.value.length===1){const E=(F=b.value)==null?void 0:F[v.value[0]];let T=E==null?void 0:E[H];if(a.value.mode==="one_per_group"&&a.value.keyGroup){const M=$(E,a.value.keyGroup);ee(a.value.keyGroupCallback)?T=`${a.value.keyGroupCallback({item:E,inDropdown:!1,group:M})} "${T}"`:T=`${M} "${T}"`}return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:T,item:E,modelArray:v.value}]}return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:B({placeholder:"_A_FILTERS_SELECTED_{{count}}_",extra:{count:v.value.length,modelArray:v.value}}),modelArray:v.value,extra:{count:v.value.length,modelArray:v.value}}]}return[]}if(a.value.type==="dateRange"){const E=a.value.keyFrom||"from",T=a.value.keyUntil||"until",M=[];if(!V((h=s.value)==null?void 0:h[E])&&((A=s.value)==null?void 0:A[E])!==""){const g=B({placeholder:a.value.labelFrom||"_A_DATEPICKER_RANGE_FROM_"});M.push({filterLabelTranslated:n({label:t.value,suffixTranslated:g}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:g}),label:_(s.value[E]),idSuffix:"_from",keyId:E})}if(!V((y=s.value)==null?void 0:y[T])&&((p=s.value)==null?void 0:p[T])!==""){const g=B({placeholder:a.value.labelUntil||"_A_DATEPICKER_RANGE_UNTIL_"});M.push({filterLabelTranslated:n({label:t.value,suffixTranslated:g}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:g}),label:_(s.value[T]),idSuffix:"_until",keyId:T})}return M}if(pe.indexOf(a.value.type)!==-1){const E=a.value.keyMax||"max",T=a.value.keyMin||"min",M=[];if(!V((S=s.value)==null?void 0:S[T])&&((m=s.value)==null?void 0:m[T])!==""){const g=B({placeholder:a.value.labelMin||"_A_INPUT_NUMBER_RANGE_LABEL_MIN_"});M.push({filterLabelTranslated:n({label:t.value,suffixTranslated:g}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:g}),label:s.value[T],idSuffix:"_min",keyId:T})}if(!V((R=s.value)==null?void 0:R[E])&&((x=s.value)==null?void 0:x[E])!==""){const g=B({placeholder:a.value.labelMax||"_A_INPUT_NUMBER_RANGE_LABEL_MAX_"});M.push({filterLabelTranslated:n({label:t.value,suffixTranslated:g}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:g}),label:s.value[E],idSuffix:"_max",keyId:E})}return M}return[{label:s.value,filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value})}]})}}const Ze={name:"AFilterCenterItem",props:{btnCloseClass:{type:[String,Object],required:!1,default:"a_btn a_btn_secondary"},btnGoToClass:{type:[String,Object],required:!1,default:"a_btn a_btn_secondary"},btnNotCloseClass:{type:[String,Object],required:!1,default:"a_btn a_btn_secondary"},closeFilterValue:{type:Function,required:!0},dataKeyByKeyIdPerFilter:{type:Object,required:!0},disabled:{type:Boolean,required:!1},filter:{type:Object,required:!1,default:void 0},id:{type:String,required:!0},model:{type:[String,Number,Object,Array,Boolean],required:!1,default:void 0}},emits:["updateVisibleChildFilters","updateLoadingChildFilters"],setup(e,t){const{hasCurrentFilter:l}=We(e),{isFilterLoading:i,updateLoadingChildFilters:r}=Xe(e,t,{hasCurrentFilter:l}),{filterLabel:a,filterLabelForTitle:s}=Ye(e,{hasCurrentFilter:l}),{modelValuesForCurrentFilter:d}=Je(e,{filterLabel:a,filterLabelForTitle:s,hasCurrentFilter:l}),{isLeastOneFilterVisible:_,updateVisibleChildFilters:b}=$e(e,t,{modelValuesForCurrentFilter:d}),{goToFilter:v}=je(e),{closeCurrentFilterValue:n}=ke(e);return K(_,()=>{b()},{immediate:!0}),K(i,(f,F)=>{r(f,F)},{immediate:!0}),Z(()=>{b({destroy:!0})}),{closeCurrentFilterValue:n,filterLabel:a,goToFilter:v,hasCurrentFilter:l,isLeastOneFilterVisible:_,modelValuesForCurrentFilter:d}},render(){return this.hasCurrentFilter&&[this.modelValuesForCurrentFilter.map(e=>c("div",{role:"group",class:"a_filters_center__item a_btn_group a_btn_group_small"},[this.filter.hasNotClose&&c(D,{class:this.btnNotCloseClass,ariaHidden:!0,tabindex:-1,iconLeft:Ae,type:"text"}),c(D,{class:this.btnGoToClass,title:"_A_FILTERS_HOR_GO_TO_TITLE_{{filterLabel}}_{{filterValue}}_",textScreenReader:"_A_FILTERS_HOR_GO_TO_TITLE_{{filterLabel}}_{{filterValue}}_",extra:{filterLabel:e.filterLabelForTitleTranslated,filterValue:e.label},type:"button",onClick:()=>this.goToFilter({modelValue:e})},()=>[e.filterLabelTranslated?c("strong",{class:"a_filters_center__item__label",ariaHidden:!0},[c(q,{tag:"span",html:e.filterLabelTranslated,textAfter:":"})]):"",this.filter.slotName&&this.$slots[this.filter.slotName]?this.$slots[this.filter.slotName]({item:e.item,label:e.label,extra:e.extra,inFilterCenter:!0}):c("span",{class:"a_filters_center__item__value"},e.label)]),this.filter.hasNotClose?"":c(D,{class:this.btnCloseClass,disabled:this.disabled,iconLeft:J,title:"_A_FILTERS_HOR_CLOSE_TITLE_{{filterLabel}}_{{filterValue}}_",textScreenReader:"_A_FILTERS_HOR_CLOSE_TITLE_{{filterLabel}}_{{filterValue}}_",extra:{filterLabel:e.filterLabelForTitleTranslated,filterValue:e.label},type:"button",onClick:()=>this.closeCurrentFilterValue({modelValue:e})})]))]}};function Qe(){const e=I({}),t=({id:i,isLoading:r})=>{e.value[i]=r};return{isLeastOneChildFilterLoading:u(()=>{let i=!1;return C(e.value,r=>{if(r)return i=!0,!1}),i}),updateLoadingChildFilters:t}}function et(e){const t=o(e,"filtersGroup"),l=I({}),i=({id:d,isVisible:_})=>{l.value[d]=_},r=u(()=>{let d=!1;return C(l.value,_=>{if(_)return d=!0,!1}),d}),a=u(()=>!!(t.value.alwaysVisible.length||t.value.filters.length)),s=u(()=>r.value?void 0:"display: none;");return{hasFilters:a,styleHide:s,updateVisibleChildFilters:i}}const tt={name:"AFilterCenter",props:{appliedModel:{type:Object,required:!0},btnCloseClass:{type:[String,Object],required:!1,default:"a_btn a_btn_secondary"},btnGoToClass:{type:[String,Object],required:!1,default:"a_btn a_btn_secondary"},btnNotCloseClass:{type:[String,Object],required:!1,default:"a_btn a_btn_secondary"},btnCloseAllClass:{type:[String,Object],required:!1,default:"a_btn a_btn_link a_btn_small"},closeAllFilters:{type:Function,required:!0},closeFilterValue:{type:Function,required:!0},dataKeyByKeyIdPerFilter:{type:Object,required:!0},disabled:{type:Boolean,required:!1},filtersGroup:{type:Object,required:!0,default:()=>({alwaysVisible:[],filters:[]})},filtersKeyById:{type:Object,required:!0},filtersVisibleAll:{type:Array,required:!0},id:{type:String,required:!0}},setup(e){const{hasFilters:t,styleHide:l,updateVisibleChildFilters:i}=et(e),{isLeastOneChildFilterLoading:r,updateLoadingChildFilters:a}=Qe();return{hasFilters:t,isLeastOneChildFilterLoading:r,styleHide:l,updateLoadingChildFilters:a,updateVisibleChildFilters:i}},render(){return this.hasFilters?c("div",{class:"a_filters_center"},[c("div",{class:"a_filters_center__item"},[this.$slots.filtersHorizontal?this.$slots.filtersHorizontal():""]),this.filtersVisibleAll.map(e=>c(Ze,{key:e.id,id:this.id,btnCloseClass:this.btnCloseClass,btnGoToClass:this.btnGoToClass,btnNotCloseClass:this.btnNotCloseClass,disabled:this.disabled,filter:e,closeFilterValue:this.closeFilterValue,dataKeyByKeyIdPerFilter:this.dataKeyByKeyIdPerFilter,model:this.appliedModel[e.id],onUpdateVisibleChildFilters:this.updateVisibleChildFilters,onUpdateLoadingChildFilters:this.updateLoadingChildFilters},this.$slots)),this.isLeastOneChildFilterLoading?c("div",{style:this.styleHide,class:"a_filters_center__item"},[c(ve,{class:"a_spinner_small"})]):"",c("div",{class:"a_filters_center__item",style:this.styleHide},[c(z,{class:this.btnCloseAllClass,iconLeft:Ee,text:"_A_FILTERS_DESELECT_ALL_",onClick:this.closeAllFilters})])]):null}};function lt(e,{model:t=I({})}){const l=o(e,"filtersSaved"),i=u(()=>{const d={};return C(l.value,_=>{d[_.label]=!0}),d}),r=u(()=>i.value[t.value.name]),a=u(()=>{if(r.value)return"_A_FILTERS_SAVE_MODAL_NAME_HELP_TEXT_{{name}}_"});return{dataForm:u(()=>[{id:"name",label:"_A_FILTERS_SAVE_LABEL_NAME_",type:"text",required:!0,extra:{name:t.value.name||""},helpText:a.value}]),isUpdate:r}}function it(e){const t=o(e,"isModelFilterSavedNew"),l=o(e,"modelFiltersSaved"),i=I({});return{initModel:()=>{l.value&&!t.value&&(i.value={name:l.value})},model:i,updateModel:s=>{i.value=s}}}function at(e,{emit:t},{isUpdate:l=u(()=>!1),model:i=I({})}){const r=o(e,"changeModelFiltersSaved"),a=o(e,"updateFiltersSaved"),s=I(void 0),{addNotification:d}=W(),_=u(()=>!i.value.name),b=()=>{t("close")};return{close:b,disabledBtnSave:_,loading:s,save:async()=>{s.value=!0;const n=l.value;try{await a.value({action:n?"update":"create",label:i.value.name})}catch{d({text:"_A_FILTERS_SAVE_MSG_ERROR_",type:"danger"}),s.value=!1;return}d({text:n?"_A_FILTERS_SAVE_MSG_SUCCESS_UPDATE_{{name}}_":"_A_FILTERS_SAVE_MSG_SUCCESS_CREATE_{{name}}_",extra:{name:i.value.name}}),r.value({model:i.value.name,isCreateOrEdit:!0}),b(),s.value=!1}}}const rt={name:"AFiltersSaveModal",props:{changeModelFiltersSaved:{type:Function,required:!0},filtersSaved:{type:Array,required:!0},isModelFilterSavedNew:{type:Boolean,required:!0},modelFiltersSaved:{type:String,required:!1,default:void 0},selectorCloseIds:{type:String,required:!0},updateFiltersSaved:{type:Function,required:!0}},emits:["close"],setup(e,t){const{initModel:l,model:i,updateModel:r}=it(e),{dataForm:a,isUpdate:s}=lt(e,{model:i}),{close:d,disabledBtnSave:_,loading:b,save:v}=at(e,t,{isUpdate:s,model:i});return l(),{close:d,dataForm:a,disabledBtnSave:_,initModel:l,loading:b,model:i,save:v,updateModel:r}},render(){return c(Fe,{close:this.close,dataForm:this.dataForm,disabledSave:this.disabledBtnSave,headerText:"_A_FILTERS_SAVE_MODAL_HEADER_",modelValue:this.model,idPrefix:"modal_filter_top_",loading:this.loading,selectorCloseIds:this.selectorCloseIds,size:"large",save:this.save,stop:!0,zIndex:1901,backdropZIndex:1900,"onUpdate:modelValue":this.updateModel},{modalBodyPrepend:()=>[c(he,{type:"info",isVisible:!0,safeHtml:"_A_FILTERS_SAVE_MODAL_BODY_PREPEND_"})]})}};function st(e){const t=o(e,"filtersGroup"),l=I(void 0),i=u(()=>!!(t.value.alwaysVisible.length||t.value.filters.length));return{closeDropdown:()=>{var s;(s=l.value)==null||s.onClose({trigger:"click"})},dropdownRef:l,isDropdownVisible:i,openDropdown:s=>{var d;(d=l.value)==null||d.onOpen({trigger:"click",selectorToFocus:s})}}}function nt(e,{openDropdown:t=()=>{}}){const l=o(e,"id");let i;return{destroyEventBus:()=>{U.$off(i,t)},initEventBus:()=>{U.$on(i,t)},initEventName:()=>{i=`eventATableFilterTopOnOpen_${l.value}`}}}function dt(e,{emit:t}){const l=o(e,"filtersGroup"),i=o(e,"filtersVisible"),r=({isAdd:v,filterId:n,filter:f})=>{t("toggleFiltersVisible",{isAdd:v,filterId:n,filter:f})},a=({model:v})=>{r({isAdd:!0,filterId:v})},s=({filter:v})=>{r({isAdd:!1,filterId:v.id,filter:v})},d=u(()=>!!(l.value.filters&&l.value.filters.length)),_=u(()=>{const v={};return C(i.value,n=>{v[n.id]=!0}),v}),b=u(()=>d.value?O(l.value.filters,v=>!_.value[v.id]):[]);return{addFiltersVisible:a,deleteFiltersVisible:s,filtersHidden:b,hasFiltersHiddenDefault:d}}function ot(e,{openDropdown:t=()=>({})}){const l=o(e,"filtersSaved"),i=o(e,"id"),r=o(e,"onUpdateModelFilters"),a="_A_FILTERS_HOR_FILTER_NEW_",s=I(void 0),d=I(void 0),_=I(void 0),b=u(()=>`${i.value}btn_save_`),v=u(()=>d.value===a),n=u(()=>{const y=[{label:a}];return C(L(l.value),p=>{p.group="_A_FILTERS_FILTER_SAVED_GROUP_MY_",y.push(p)}),y});return{buttonSaveComponentId:b,changeModelFiltersSaved:({model:y,item:p,isDelete:S,isCreateOrEdit:m})=>{if(m){d.value=y;return}if((p==null?void 0:p.label)===a||S){r.value({fullModel:{},isUpdateFiltersVisible:!0}),d.value=a;return}y?(d.value=y,p&&(r.value({fullModel:p.data||{},isUpdateFiltersVisible:!0}),t())):p&&(r.value({fullModel:p.data||{},isUpdateFiltersVisible:!0}),t())},closeModalSave:()=>{s.value=!1},filtersSavedLocal:n,initModelFiltersSaved:()=>{d.value=a},isModalSaveVisible:s,isModelFilterSavedNew:v,modelFiltersSaved:d,openModalSave:()=>{_.value=b.value,s.value=!0},selectorCloseIds:_}}function ut(e,{changeModelFiltersSaved:t=()=>{},idFilterTop:l=u(()=>""),isModelFilterSavedNew:i=u(()=>!1),modelFiltersSaved:r=I(void 0)}){const a=o(e,"id"),s=o(e,"updateFiltersSaved"),{changeConfirmOptions:d,closeConfirm:_,isModalHidden:b,openConfirm:v}=be(),{addNotification:n}=W(),f=u(()=>`${a.value}btn_save`),F=u(()=>i.value?"_A_FILTERS_DELETE_FILTER_SAVED_BTN_DISABLED_":{mobile:"_A_FILTERS_DELETE_FILTER_SAVED_BTN_"}),h=u(()=>i.value?"_A_FILTERS_DELETE_FILTER_SAVED_BTN_DISABLED_":"_A_FILTERS_DELETE_FILTER_SAVED_BTN_"),A=async()=>{d({loading:!0});try{await s.value({action:"delete",label:r.value})}catch{n({text:"_A_FILTERS_DELETE_FILTER_MSG_ERROR_{{name}}_",type:"danger",extra:{name:r.value}}),d({loading:!1});return}n({text:"_A_FILTERS_DELETE_FILTER_MSG_SUCCESS_{{name}}_",extra:{name:r.value}}),d({loading:!1}),_(),t({model:void 0,isDelete:!0})};return{buttonDeleteId:f,isConfirmHidden:b,openDeleteConfirm:()=>{v({headerText:"_A_FILTERS_DELETE_FILTER_HEADER_{{name}}_",bodyHtml:"_A_FILTERS_DELETE_FILTER_BODY_{{name}}_",extra:{name:r.value},save:A,selectorCloseIds:[f.value,l.value],saveButtonText:"_A_FILTERS_DELETE_FILTER_BTN_DELETE_",stop:!0,zIndex:1901,backdropZIndex:1900})},textScreenreaderButtonDeleteFiltersSaved:h,titleButtonDeleteFiltersSaved:F}}function ct(e){const t=o(e,"filtersGroup"),l=o(e,"filtersVisible"),i=o(e,"updateDataKeyByIdFromFilter"),r="a_column a_column_12_touch a_column_3_fullhd a_column_3_widescreen a_column_3_desktop",a="a_columns a_columns_count_12 a_columns_gap_x_2 a_columns_gap_y_2 a_columns_gap_y_1_touch",s="a_filters__form_element a_column a_column_12_touch a_column_9_fullhd a_column_9_widescreen a_column_9_desktop",d=["select","multiselect","radio","checkbox","group","fieldset"],_=({dataKeyByKeyId:v,item:n,filter:f})=>{let F=f.id;n&&(F=n.id),i.value({filterId:F,dataKeyByKeyId:v})};return{dataForForm:u(()=>{const v=[];return C(t.value.alwaysVisible,n=>{const f=L(n);f.labelClass=r,f.classColumn=s,d.indexOf(n.type)!==-1&&(f.onUpdateData=({dataKeyByKeyId:F,item:h})=>_({dataKeyByKeyId:F,item:h,filter:n})),v.push({type:"group",id:`group_${n.id}`,classColumns:a,children:[f]})}),C(l.value,n=>{const f=L(n);f.labelClass=r,f.classColumn=`${s}  a_d_flex a_align_items_center`,f.slotAppend="groupAppend",f.class="a_width_100",d.indexOf(n.type)!==-1&&(f.onUpdateData=({dataKeyByKeyId:F,item:h})=>_({dataKeyByKeyId:F,item:h,filter:n})),v.push({type:"group",id:`group_${n.id}`,classColumns:a,children:[f]})}),v})}}function _t(e){const t=o(e,"id");return{idFilterTop:u(()=>`${t.value}_filter_top`)}}function ft(e,{emit:t},{closeDropdown:l=()=>{}}){const i=o(e,"disabled");return{onSearch:()=>{i.value||(l(),t("startSearch"))}}}const pt={name:"AFiltersHorizontal",props:{canSave:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filtersGroup:{type:Object,required:!0,default:()=>({alwaysVisible:[],filters:[]})},filtersKeyById:{type:Object,required:!0},filtersSaved:{type:Array,required:!0},filtersVisible:{type:Array,required:!0},id:{type:String,required:!0},mainModel:{type:Object,required:!1},onUpdateModelFilters:{type:Function,required:!0},unappliedModel:{type:Object,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0},updateFiltersSaved:{type:Function,required:!0}},emits:["startSearch","toggleFiltersVisible"],setup(e,t){const{dataForForm:l}=ct(e),{closeDropdown:i,dropdownRef:r,isDropdownVisible:a,openDropdown:s}=st(e),{idFilterTop:d}=_t(e),{onSearch:_}=ft(e,t,{closeDropdown:i}),{destroyEventBus:b,initEventBus:v,initEventName:n}=nt(e,{openDropdown:s}),{addFiltersVisible:f,deleteFiltersVisible:F,filtersHidden:h,hasFiltersHiddenDefault:A}=dt(e,t),{buttonSaveComponentId:y,changeModelFiltersSaved:p,closeModalSave:S,filtersSavedLocal:m,initModelFiltersSaved:R,isModalSaveVisible:x,isModelFilterSavedNew:E,modelFiltersSaved:T,openModalSave:M,selectorCloseIds:g}=ot(e,{openDropdown:s}),{buttonDeleteId:te,isConfirmHidden:le,openDeleteConfirm:ie,textScreenreaderButtonDeleteFiltersSaved:ae,titleButtonDeleteFiltersSaved:re}=ut(e,{changeModelFiltersSaved:p,idFilterTop:d,isModelFilterSavedNew:E,modelFiltersSaved:T});return n(),R(),v(),Z(()=>{b()}),{addFiltersVisible:f,buttonDeleteId:te,buttonSaveComponentId:y,changeModelFiltersSaved:p,closeDropdown:i,closeModalSave:S,dataForForm:l,deleteFiltersVisible:F,dropdownRef:r,filtersHidden:h,filtersSavedLocal:m,hasFiltersHiddenDefault:A,idFilterTop:d,initModelFiltersSaved:R,isConfirmHidden:le,isDropdownVisible:a,isModalSaveVisible:x,isModelFilterSavedNew:E,modelFiltersSaved:T,onSearch:_,openDeleteConfirm:ie,openModalSave:M,selectorCloseIds:g,textScreenreaderButtonDeleteFiltersSaved:ae,titleButtonDeleteFiltersSaved:re}},render(){return this.isDropdownVisible?[c(ye,{ref:"dropdownRef",buttonIconLeft:Te,buttonText:"Filter",buttonClass:"a_btn a_btn_primary a_btn_small a_filter_horizontal__btn_dropdown",dropdownTag:"div",dropdownClass:"a_filter_horizontal__wrapper",dropdownRenderDefault:!0,isCloseByClickInside:!1,hasCaret:!1,inBody:!0,lockArrowsNavigation:!1,lockTabNavigation:!1,useEscape:!this.isModalSaveVisible&&this.isConfirmHidden},{...this.$slots,dropdown:()=>c("div",{class:"a_filter_horizontal"},[c("div",{class:"a_filter_horizontal__header__wrapper"},[c("div",{class:"a_filter_horizontal__header"},[c("div",{class:"a_filter_horizontal__header__texts"},[c(q,{class:"a_filter_horizontal__header__texts__filter",tag:"span",text:"_A_FILTERS_HOR_FILTER_HEADER_"}),this.isModelFilterSavedNew?c(q,{class:"a_filter_horizontal__header__texts__new",tag:"em",text:this.modelFiltersSaved}):c("span",{},this.modelFiltersSaved)]),this.canSave?c(k,{modelValue:this.modelFiltersSaved,change:this.changeModelFiltersSaved,class:"a_filters_top__save_select",data:this.filtersSavedLocal,deselectable:!1,keyId:"label",keyLabel:"label",keyGroup:"group",label:"_A_FILTERS_SAVE_SELECT_",menuWidthType:"by_content",search:!0,translateData:!0,type:"select"}):""])]),c("div",{class:"a_filter_horizontal__body__wrapper"},[c("div",{class:"a_filter_horizontal__body"},[c(X,{idPrefix:this.idFilterTop,class:"a_filter_horizontal__body__form",classColumnDefault:"",classColumns:"",data:this.dataForForm,excludeRenderAttributes:this.excludeRenderAttributes,modelValue:this.unappliedModel,showErrors:!1,onChange:this.onUpdateModelFilters},{...this.$slots,groupAppend:({item:e})=>c(D,{type:"button",class:"a_btn a_btn_primary a_ml_2",title:"_A_FILTERS_TOP_CLOSE_",textScreenReader:"_A_FILTERS_TOP_CLOSE_",iconLeft:J,stop:!0,onClick:()=>this.deleteFiltersVisible({filter:e})}),formDataAppend:()=>c("div",{class:"a_filter_horizontal__add_filter__wrapper"},[c(k,{buttonClassDefault:"a_btn a_btn_primary a_filter_horizontal__add_filter",change:this.addFiltersVisible,data:this.filtersHidden,hasCaret:!1,disabled:!this.filtersHidden.length,isLabelFloat:!1,keyGroup:"group",keyId:"id",keyLabel:"label",label:"_A_FILTERS_ADD_FILTER_",labelClass:"a_sr_only",menuWidthType:"by_content",sortOrderGroup:"asc",placement:"bottom-start",search:!0,translateData:!0,type:"select"},{fixedPlaceholder:()=>[c(q,{tag:"span",ariaHidden:!0,class:"a_position_absolute_all",title:"_A_FILTERS_ADD_FILTER_"}),c(Se,{icon:Ce})]})]),formAppend:()=>this.canSave?c("div",{class:"a_filter_horizontal__save_actions"},[c(D,{id:this.buttonSaveComponentId,class:"a_btn a_btn_primary",iconLeft:Ie,type:"button",text:"_A_FILTERS_SAVE_FILTER_SAVED_BTN_TEXT_",onClick:this.openModalSave}),c(D,{id:this.buttonDeleteId,ariaDisabled:this.isModelFilterSavedNew,class:"a_btn a_btn_secondary",iconLeft:me,text:{desktop:"_A_FILTERS_DELETE_FILTER_SAVED_BTN_TEXT_"},textAriaHidden:!0,textScreenReader:this.textScreenreaderButtonDeleteFiltersSaved,title:this.titleButtonDeleteFiltersSaved,type:"button",onClick:this.openDeleteConfirm})]):""})]),c("div",{class:"a_filter_horizontal__footer"},[c("div",{class:"a_filter_horizontal__footer__actions"},[c(D,{type:"button",class:"a_btn a_btn_primary a_text_nowrap a_filter_horizontal__footer__actions__btn_search",iconLeft:Le,text:"_A_FILTERS_START_SEARCH_",disabled:this.disabled,onClick:this.onSearch}),c(D,{type:"button",class:"a_btn a_btn_secondary a_text_nowrap a_filter_horizontal__footer__actions__btn_close",text:"_A_FILTERS_HOR_CLOSE_DROPDOWN_",onClick:this.closeDropdown})])])])])}),this.isModalSaveVisible?c(rt,{changeModelFiltersSaved:this.changeModelFiltersSaved,filtersSaved:this.filtersSaved,isModelFilterSavedNew:this.isModelFilterSavedNew,modelFiltersSaved:this.modelFiltersSaved,selectorCloseIds:this.selectorCloseIds,updateFiltersSaved:this.updateFiltersSaved,onClose:this.closeModalSave}):""]:null}};function vt(e){const t=o(e,"id");return{idFilterTop:u(()=>`${t.value}_filter_main`)}}function Ft(e){const t=o(e,"filterMain"),l=u(()=>!!t.value),i=u(()=>l.value?[t.value]:[]);return{hasFilterMain:l,dataMainFilter:i}}function ht(e,{emit:t}){const l=o(e,"disabled");return{onSearch:()=>{l.value||t("startSearch")}}}const bt={name:"AFiltersMain",props:{disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filterMain:{type:Object,required:!1},id:{type:String,required:!0},mainModel:{type:Object,required:!1},updateDataKeyByIdFromFilter:{type:Function,required:!0},updateMainModel:{type:Function,required:!0}},emits:["startSearch"],setup(e,t){const{hasFilterMain:l,dataMainFilter:i}=Ft(e),{idFilterTop:r}=vt(e),{onSearch:a}=ht(e,t);return{hasFilterMain:l,dataMainFilter:i,idFilterTop:r,onSearch:a}},render(){return this.hasFilterMain?c("div",{id:this.idFilterTop,class:"a_filters_top"},[c(X,{idPrefix:this.idFilterTop,class:"a_filters_top__form",classColumns:"a_filters_top__main_wrapper",classColumnDefault:"a_filters_top__main",data:this.dataMainFilter,excludeRenderAttributes:this.excludeRenderAttributes,modelValue:this.mainModel,showErrors:!1,onChange:this.updateMainModel},{formDataAppend:()=>c(z,{class:"a_btn a_btn_primary a_text_nowrap a_filters_top__search",iconLeft:Me,type:"submit",text:{desktop:"_A_FILTERS_START_SEARCH_"},textScreenReader:{mobile:"_A_FILTERS_START_SEARCH_"},prevent:!0,stop:!0,disabled:this.disabled,onClick:this.onSearch})})]):null}};function yt(e,{emit:t},{filtersHorizontalRef:l=I(void 0),filtersVisibleAll:i=u(()=>[]),onUpdateModelFilters:r=()=>{}}){const a=o(e,"appliedModel"),s=o(e,"unappliedModel"),d=()=>{var n;(n=l.value)==null||n.initModelFiltersSaved()},_=({filter:n,keyId:f,modelArray:F,appliedModelLocal:h,unappliedModelLocal:A})=>{const y=n.id;return w.value[n.type]?(h[y]&&h[y].length&&(F?h[y]=O(h[y],p=>F.indexOf(p)===-1):h[y]=[]),A[y]&&A[y].length&&(F?A[y]=O(A[y],p=>F.indexOf(p)===-1):A[y]=[])):Y.value[n.type]&&f?(j(A==null?void 0:A[y])&&(A[y][f]=void 0),j(h==null?void 0:h[y])&&(h[y][f]=void 0)):(A[y]=void 0,h[y]=void 0),{appliedModelLocal:h,unappliedModelLocal:A}};return{closeAllFilters:()=>{let n=L(a.value),f=L(s.value);C(i.value,F=>{const h=_({filter:F,appliedModelLocal:n,unappliedModelLocal:f});n=h.appliedModelLocal,f=h.unappliedModelLocal}),d(),t("update:unappliedModel",f),t("update:appliedModel",n),setTimeout(()=>{r({fullModel:a.value})})},closeFilterValue:({filter:n,keyId:f,modelArray:F})=>{const h=L(a.value),A=L(s.value),{appliedModelLocal:y,unappliedModelLocal:p}=_({filter:n,keyId:f,modelArray:F,appliedModelLocal:h,unappliedModelLocal:A});t("update:unappliedModel",p),t("update:appliedModel",y),setTimeout(()=>{r({fullModel:a.value})})}}}function St(){const e=I({});return{dataKeyByKeyIdPerFilter:e,updateDataKeyByIdFromFilter:({dataKeyByKeyId:l,filterId:i})=>{e.value[i]=L(l)}}}function At(e){const t=o(e,"excludeRenderAttributes"),l=["alwaysVisible"];return{excludeRenderAttributesComputed:u(()=>xe(l,t.value))}}function Et({filter:e={},modelObj:t={}}){var i;const l=e.id;return l in t?w.value[e.type]?!!((i=t[l])!=null&&i.length):Y.value[e.type]?!!(t[l]&&!Q(t[l])):!0:!1}function Tt(e,{emit:t}){const l=o(e,"filters"),i=o(e,"filterMain"),r=o(e,"unappliedModel"),a=I({}),s=I(void 0),d=I([]),_=u(()=>!!(l.value.length||i.value)),b=u(()=>{const p={};return C(L(l.value),S=>{p[S.id]=S,N.value[S.type]&&S.children&&S.children.length&&C(S.children,m=>{p[m.id]=m})}),p}),v=u(()=>{const p={alwaysVisible:[],filters:[]};return C(L(l.value),S=>{S.alwaysVisible?p.alwaysVisible.push(S):p.filters.push(S)}),p}),n=u(()=>{const p=[];return C(d.value,S=>{b.value[S]&&p.push(b.value[S])}),p}),f=u(()=>{const p=[];p.push(...l.value);const S=[];return C(p,m=>{S.push(m),N.value[m.type]&&m.children&&m.children.length&&C(m.children,R=>{S.push(R)})}),S}),F=()=>{const p=[];C(v.value.filters,S=>{Et({filter:S,modelObj:r.value})&&p.push(S.id)}),d.value=p};return{filtersDataKeyById:a,filtersGroup:v,filtersHorizontalRef:s,filtersKeyById:b,filtersVisible:n,filtersVisibleAll:f,filtersVisibleIds:d,hasFilters:_,onUpdateModelFilters:({fullModel:p,isUpdateFiltersVisible:S})=>{t("update:unappliedModel",p),S&&setTimeout(()=>{F()})},setFiltersVisibleIds:F,updateAppliedModel:({fullModel:p})=>{t("update:appliedModel",p)},updateMainModel:({fullModel:p})=>{t("update:mainModel",p)}}}function It(e){const t=o(e,"filtersSaved"),l=o(e,"unappliedModel"),i=o(e,"updateFiltersSaved"),r=I([]);return{filtersSavedLocal:r,initFiltersSaved:()=>{r.value=t.value||[]},updateFiltersSavedLocal:({action:d="",label:_=""})=>{if(d==="create")r.value.push({label:_,data:L(l.value)});else{const b=Be(r.value,["label",_]);b!==-1&&(d==="delete"?r.value.splice(b,1):d==="update"&&r.value.splice(b,1,{label:_,data:L(l.value)}))}ee(i.value)&&i.value({action:d,label:_,model:l.value,filtersSaved:r.value})}}}function mt(e,{emit:t},{onUpdateModelFilters:l=()=>{}}){const i=o(e,"appliedModel"),r=o(e,"unappliedModel");return{startSearch:()=>{t("update:appliedModel",r.value),setTimeout(()=>{l({fullModel:i.value})})}}}function Ct(e,{dataKeyByKeyIdPerFilter:t=I({}),filtersVisibleIds:l=I([]),onUpdateModelFilters:i=()=>{}}){const r=o(e,"unappliedModel");return{toggleFiltersVisible:({isAdd:s=!0,filterId:d,filter:_})=>{var b,v;if(s)l.value.push(d);else{const n=l.value.indexOf(d);n!==-1&&l.value.splice(n,1);const f=L(r.value);if(_&&_.modelId){const F=(b=t.value)==null?void 0:b[d];(v=f==null?void 0:f[_.modelId])!=null&&v.length&&F?f[_.modelId]=O(f[_.modelId],h=>!F[h]):f[d]=void 0}else f[d]=void 0;i({fullModel:f})}}}}const Rt={name:"AFilters",props:{appliedModel:{type:Object,required:!1,default:()=>({})},canSave:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filterCenterBtnCloseAllClass:{type:[String,Object],required:!1,default:()=>P.value.propsDefault.filterCenterBtnCloseAllClass},filterCenterBtnCloseClass:{type:[String,Object],required:!1,default:()=>P.value.propsDefault.filterCenterBtnCloseClass},filterCenterBtnGoToClass:{type:[String,Object],required:!1,default:()=>P.value.propsDefault.filterCenterBtnGoToClass},filterCenterBtnNotCloseClass:{type:[String,Object],required:!1,default:()=>P.value.propsDefault.filterCenterBtnNotCloseClass},filterMain:{type:Object,required:!1},filters:{type:Array,required:!1,default:()=>[]},filtersSaved:{type:Array,required:!1,default:()=>[]},id:{type:String,required:!1,default:()=>Ve("a_filters_")},mainModel:{type:Object,required:!1},unappliedModel:{type:Object,required:!1,default:()=>({})},updateFiltersSaved:{type:Function,required:!1,default:void 0},view:{type:String,required:!1,default:"top",validator:e=>["top","right"].indexOf(e)!==-1},viewRightTeleportSelector:{type:String,required:!1,default:void 0}},emits:["startSearch","update:appliedModel","update:mainModel","update:unappliedModel"],setup(e,t){const l=o(e,"filtersSaved"),{filtersDataKeyById:i,filtersGroup:r,filtersHorizontalRef:a,filtersKeyById:s,filtersVisible:d,filtersVisibleAll:_,filtersVisibleIds:b,hasFilters:v,onUpdateModelFilters:n,setFiltersVisibleIds:f,updateAppliedModel:F,updateMainModel:h}=Tt(e,t),{closeAllFilters:A,closeFilterValue:y}=yt(e,t,{filtersHorizontalRef:a,filtersVisibleAll:_,onUpdateModelFilters:n}),{dataKeyByKeyIdPerFilter:p,updateDataKeyByIdFromFilter:S}=St(),{toggleFiltersVisible:m}=Ct(e,{dataKeyByKeyIdPerFilter:p,filtersVisibleIds:b,onUpdateModelFilters:n}),{startSearch:R}=mt(e,t,{onUpdateModelFilters:n}),{filtersSavedLocal:x,initFiltersSaved:E,updateFiltersSavedLocal:T}=It(e),{excludeRenderAttributesComputed:M}=At(e);return K(l,()=>{E()},{deep:!0}),f(),E(),{closeAllFilters:A,closeFilterValue:y,dataKeyByKeyIdPerFilter:p,excludeRenderAttributesComputed:M,filtersDataKeyById:i,filtersGroup:r,filtersHorizontalRef:a,filtersKeyById:s,filtersSavedLocal:x,filtersVisible:d,filtersVisibleAll:_,filtersVisibleIds:b,hasFilters:v,onUpdateModelFilters:n,setFiltersVisibleIds:f,startSearch:R,toggleFiltersVisible:m,updateAppliedModel:F,updateDataKeyByIdFromFilter:S,updateFiltersSavedLocal:T,updateMainModel:h}},render(){if(this.hasFilters)return c("div",[this.view==="top"&&c(bt,{id:this.id,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filterMain:this.filterMain,mainModel:this.mainModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,updateMainModel:this.updateMainModel,onStartSearch:this.startSearch},this.$slots),this.view==="right"&&c(ge,{to:this.viewRightTeleportSelector,disabled:!this.viewRightTeleportSelector},[c(He,{id:this.id,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filters:this.filters,filtersKeyById:this.filtersKeyById,appliedModel:this.appliedModel,onUpdateModelFilters:this.updateAppliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,onStartSearch:this.startSearch},this.$slots)]),c(tt,{id:this.id,appliedModel:this.appliedModel,btnCloseClass:this.filterCenterBtnCloseClass,btnGoToClass:this.filterCenterBtnGoToClass,btnNotCloseClass:this.filterCenterBtnNotCloseClass,btnCloseAllClass:this.filterCenterBtnCloseAllClass,closeAllFilters:this.closeAllFilters,closeFilterValue:this.closeFilterValue,dataKeyByKeyIdPerFilter:this.dataKeyByKeyIdPerFilter,disabled:this.disabled,filtersGroup:this.filtersGroup,filtersKeyById:this.filtersKeyById,filtersVisibleAll:this.filtersVisibleAll},{filtersHorizontal:()=>this.view==="top"?c(pt,{ref:"filtersHorizontalRef",id:this.id,canSave:this.canSave,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filtersGroup:this.filtersGroup,filtersKeyById:this.filtersKeyById,filtersSaved:this.filtersSavedLocal,filtersVisible:this.filtersVisible,onUpdateModelFilters:this.onUpdateModelFilters,unappliedModel:this.unappliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,updateFiltersSaved:this.updateFiltersSavedLocal,onStartSearch:this.startSearch,onToggleFiltersVisible:this.toggleFiltersVisible},this.$slots):"",...this.$slots})])}};export{Rt as A};
