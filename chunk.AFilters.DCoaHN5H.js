import{V as w,S as ie,T as ae,a8 as q,a9 as re,aa as se,ab as ne,ac as de,I as N,ad as oe,s as ue,ae as H,af as U,g as V,ag as ce,j as D,A as O,d as _e,c as $,q as z,ah as fe,n as pe,K as ve,v as Fe,B as k,J as j,b as he,ai as W}from"./bundle.index.BDDZHC_s.js";import{t as o,d as u,h as c,bq as be,M as X,f as K,o as Y,r as m,br as ye,bs as Se,bt as Ae,H as Ee,bm as me,bk as Ie,S as Te,T as Le}from"./chunk.vendor.CJgiAfkr.js";import{i as Me,c as L,h as B,a as Re,o as J,j as P,g as ge,f as T,n as G,a3 as Ce,N as De,m as xe,u as Ve}from"./chunk.vendor-lodash.UgDJRseT.js";function Be(){return{componentTypesMapping:()=>({...ae,...ie,...w.components,...w.containerComponents})}}function Pe(e){const t=o(e,"filter");return{isContainer:u(()=>!!q.value[t.value.type])}}function Oe(e){const t=o(e,"filter");return{filterSpecificAttributes:u(()=>{const i={},r=re[t.value.type],a=se[t.value.type];return r&&Me(t.value.inputWidth)&&(i.inputWidth="auto"),a&&(i.inputWidth="inherit",i.inputAttributes={style:"min-width: 181px"}),i})}}function qe(e){const t=o(e,"id");return{idPrefix:u(()=>`${t.value}_`)}}function Ne(e,{isContainer:t=u(()=>!1)}){const l=o(e,"filter"),i=o(e,"onUpdateModelFilters"),r=o(e,"unappliedModel");return{onUpdateModelFiltersLocal:s=>{if(t.value)i.value({model:s});else{const d=L(r.value);d[l.value.id]=L(s),i.value({model:d})}}}}function Ke(e){const t=o(e,"filter"),l=o(e,"updateDataKeyByIdFromFilter"),i=["select","multiselect","radio","checkbox","group","fieldset"],r=({dataKeyByKeyId:s,item:d})=>{let _=t.value.id;d&&(_=d.id),l.value({filterId:_,dataKeyByKeyId:s})};return{emitForComponentsWithData:u(()=>{const s={};return i.indexOf(t.value.type)!==-1&&(s.onUpdateData=r),s})}}const Ue={name:"AFiltersHorizontalFilterUi",props:{excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filter:{type:Object,required:!1,default:void 0},id:{type:String,required:!0},isLabelVisible:{type:Boolean,required:!0},onUpdateModelFilters:{type:Function,required:!0},unappliedModel:{type:Object,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0}},setup(e){const{attributesToExcludeFromRender:t}=ne(e),{isContainer:l}=Pe(e),{onUpdateModelFiltersLocal:i}=Ne(e,{isContainer:l}),{emitForComponentsWithData:r}=Ke(e),{idPrefix:a}=qe(e),{componentTypesMapping:s}=Be(),{filterSpecificAttributes:d}=Oe(e);return{attributesToExcludeFromRender:t,componentTypesMapping:s,emitForComponentsWithData:r,filterSpecificAttributes:d,idPrefix:a,isContainer:l,onUpdateModelFiltersLocal:i}},render(){const e=this.componentTypesMapping()[this.filter.type];return c(e,{idPrefix:this.idPrefix,modelValue:this.isContainer?this.unappliedModel:this.unappliedModel[this.filter.id],"onUpdate:modelValue":this.onUpdateModelFiltersLocal,excludeRenderAttributes:this.excludeRenderAttributes,...this.filter,...this.filterSpecificAttributes,label:this.isLabelVisible?this.filter.label:void 0,...this.emitForComponentsWithData,...this.attributesToExcludeFromRender},this.$slots)}};function we(e){const t=o(e,"id");return{idFilterRight:u(()=>`${t.value}_filter_right`)}}const He={name:"AFilersRight",props:{appliedModel:{type:Object,required:!0},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filters:{type:Array,required:!1,default:()=>[]},filtersKeyById:{type:Object,required:!0},id:{type:String,required:!0},onUpdateModelFilters:{type:Function,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0}},emits:["startSearch"],setup(e){const{idFilterRight:t}=we(e);return{idFilterRight:t}},render(){return c("div",{id:this.idFilterRight,class:"a_filters_right"},[c("form",{},[this.filters.map(e=>c(Ue,{id:this.id,class:"a_filters_right__filter_ui",excludeRenderAttributes:this.excludeRenderAttributes,filter:e,isLabelVisible:!0,onUpdateModelFilters:this.onUpdateModelFilters,unappliedModel:this.appliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter},this.$slots))])])}};function ke(e){const t=o(e,"closeFilterValue"),l=o(e,"disabled"),i=o(e,"filter");return{closeCurrentFilterValue:({modelValue:a})=>{l.value||t.value({filter:i.value,modelArray:a.modelArray,keyId:a.keyId})}}}function Ge(e,{emit:t},{modelValuesForCurrentFilter:l=u(()=>[])}){const i=o(e,"filter"),r=u(()=>l.value.length>0);return{isLeastOneFilterVisible:r,updateVisibleChildFilters:({destroy:s}={})=>{t("updateVisibleChildFilters",{id:i.value.id,isVisible:s?!1:r.value})}}}function $e(e){const t=o(e,"filter"),l=o(e,"id"),i=u(()=>`eventATableFilterTopOnOpen_${l.value}`);return{goToFilter:({modelValue:a}={})=>{let s=de({id:t.value.id,idPrefix:`${l.value}_filter_top`,htmlId:t.value.htmlId});a.idSuffix&&(s+=a.idSuffix),t.value.main||N.$emit(i.value,s)}}}function ze({filter:e,currentModel:t}){return!(!e||e.hideFilterCenter||B(t)||t===""||Re(t)&&!t.length)}function je(e){const t=o(e,"filter"),l=o(e,"model");return{hasCurrentFilter:u(()=>ze({filter:t.value,currentModel:l.value}))}}function We(e,{emit:t},{hasCurrentFilter:l=u(()=>!1)}){const i=o(e,"dataKeyByKeyIdPerFilter"),r=o(e,"filter"),a=u(()=>l.value&&oe.value[r.value.type]?J(i.value[r.value.id]):!1);return{isFilterLoading:a,updateLoadingChildFilters:(d,_)=>{d!==_&&t("updateLoadingChildFilters",{id:r.value.id,isLoading:a.value})}}}function Xe(e,{hasCurrentFilter:t=u(()=>!1)}){const l=o(e,"filter"),i=u(()=>t.value?l.value.label:""),r=u(()=>{if(t.value)return l.value.labelScreenReader}),a=u(()=>r.value||i.value);return{filterLabel:i,filterLabelForTitle:a}}function Ye(e,{filterLabel:t=u(()=>""),filterLabelForTitle:l=u(()=>""),hasCurrentFilter:i=u(()=>!1)}){const r=o(e,"dataKeyByKeyIdPerFilter"),a=o(e,"filter"),s=o(e,"model"),{filterBoolean:d,filterDate:_}=ue(),b=u(()=>{if(a.value)return r.value[a.value.id]}),v=u(()=>{var F;return(F=s.value)!=null&&F.length?P(s.value,h=>b.value&&b.value[h]):[]}),n=({label:F,suffixTranslated:h})=>{const A=V({placeholder:F});return h?`${A} ${h}`:A};return{modelValuesForCurrentFilter:u(()=>{var F,h,A,y,p,S,I,C,x;if(!i.value)return[];if(a.value.type==="switch"||a.value.type==="oneCheckbox")return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:d(s.value)}];if(a.value.type==="date")return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:_(s.value)}];if(a.value.type==="select"||a.value.type==="radio"){const E=ge(b.value,`${s.value}.${H}`);return E?[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:E}]:[]}if(U.value[a.value.type]||a.value.type==="radio"&&a.value.isModelArray){if(v.value.length){if(v.value.length===1){const E=(F=b.value)==null?void 0:F[v.value[0]];return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:E==null?void 0:E[H],item:E,modelArray:v.value}]}return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:V({placeholder:"_A_FILTERS_SELECTED_{{count}}_",extra:{count:v.value.length,modelArray:v.value}}),modelArray:v.value,extra:{count:v.value.length,modelArray:v.value}}]}return[]}if(a.value.type==="dateRange"){const E=a.value.keyFrom||"from",M=a.value.keyUntil||"until",g=[];if(!B((h=s.value)==null?void 0:h[E])&&((A=s.value)==null?void 0:A[E])!==""){const R=V({placeholder:a.value.labelFrom||"_A_DATEPICKER_RANGE_FROM_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:_(s.value[E]),idSuffix:"_from",keyId:E})}if(!B((y=s.value)==null?void 0:y[M])&&((p=s.value)==null?void 0:p[M])!==""){const R=V({placeholder:a.value.labelUntil||"_A_DATEPICKER_RANGE_UNTIL_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:_(s.value[M]),idSuffix:"_until",keyId:M})}return g}if(ce.indexOf(a.value.type)!==-1){const E=a.value.keyMax||"max",M=a.value.keyMin||"min",g=[];if(!B((S=s.value)==null?void 0:S[M])&&((I=s.value)==null?void 0:I[M])!==""){const R=V({placeholder:a.value.labelMin||"_A_INPUT_NUMBER_RANGE_LABEL_MIN_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:s.value[M],idSuffix:"_min",keyId:M})}if(!B((C=s.value)==null?void 0:C[E])&&((x=s.value)==null?void 0:x[E])!==""){const R=V({placeholder:a.value.labelMax||"_A_INPUT_NUMBER_RANGE_LABEL_MAX_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:s.value[E],idSuffix:"_max",keyId:E})}return g}return[{label:s.value,filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value})}]})}}const Je={name:"AFilterCenterItem",props:{closeFilterValue:{type:Function,required:!0},dataKeyByKeyIdPerFilter:{type:Object,required:!0},disabled:{type:Boolean,required:!1},filter:{type:Object,required:!1,default:void 0},id:{type:String,required:!0},model:{type:[String,Number,Object,Array,Boolean],required:!1,default:void 0}},emits:["updateVisibleChildFilters","updateLoadingChildFilters"],setup(e,t){const{hasCurrentFilter:l}=je(e),{isFilterLoading:i,updateLoadingChildFilters:r}=We(e,t,{hasCurrentFilter:l}),{filterLabel:a,filterLabelForTitle:s}=Xe(e,{hasCurrentFilter:l}),{modelValuesForCurrentFilter:d}=Ye(e,{filterLabel:a,filterLabelForTitle:s,hasCurrentFilter:l}),{isLeastOneFilterVisible:_,updateVisibleChildFilters:b}=Ge(e,t,{modelValuesForCurrentFilter:d}),{goToFilter:v}=$e(e),{closeCurrentFilterValue:n}=ke(e);return K(_,()=>{b()},{immediate:!0}),K(i,(f,F)=>{r(f,F)},{immediate:!0}),Y(()=>{b({destroy:!0})}),{closeCurrentFilterValue:n,filterLabel:a,goToFilter:v,hasCurrentFilter:l,isLeastOneFilterVisible:_,modelValuesForCurrentFilter:d}},render(){return this.hasCurrentFilter&&[this.modelValuesForCurrentFilter.map(e=>c("div",{role:"group",class:"a_filters_center__item a_btn_group a_btn_group_small"},[this.filter.hasNotClose&&c(D,{class:"a_btn a_btn_secondary",ariaHidden:!0,tabindex:-1,iconLeft:be,type:"text"}),c(D,{class:"a_btn a_btn_secondary",title:"_A_FILTERS_HOR_GO_TO_TITLE_{{filterLabel}}_{{filterValue}}_",textScreenReader:"_A_FILTERS_HOR_GO_TO_TITLE_{{filterLabel}}_{{filterValue}}_",extra:{filterLabel:e.filterLabelForTitleTranslated,filterValue:e.label},type:"button",onClick:()=>this.goToFilter({modelValue:e})},()=>[e.filterLabelTranslated?c("strong",{class:"a_filters_center__item__label",ariaHidden:!0},[c(O,{tag:"span",html:e.filterLabelTranslated,textAfter:":"})]):"",this.filter.slotName&&this.$slots[this.filter.slotName]?this.$slots[this.filter.slotName]({item:e.item,label:e.label,extra:e.extra,inFilterCenter:!0}):c("span",{class:"a_filters_center__item__value"},e.label)]),this.filter.hasNotClose?"":c(D,{class:"a_btn a_btn_secondary",disabled:this.disabled,iconLeft:X,title:"_A_FILTERS_HOR_CLOSE_TITLE_{{filterLabel}}_{{filterValue}}_",textScreenReader:"_A_FILTERS_HOR_CLOSE_TITLE_{{filterLabel}}_{{filterValue}}_",extra:{filterLabel:e.filterLabelForTitleTranslated,filterValue:e.label},type:"button",onClick:()=>this.closeCurrentFilterValue({modelValue:e})})]))]}};function Ze(){const e=m({}),t=({id:i,isLoading:r})=>{e.value[i]=r};return{isLeastOneChildFilterLoading:u(()=>{let i=!1;return T(e.value,r=>{if(r)return i=!0,!1}),i}),updateLoadingChildFilters:t}}function Qe(e){const t=o(e,"filtersGroup"),l=m({}),i=({id:d,isVisible:_})=>{l.value[d]=_},r=u(()=>{let d=!1;return T(l.value,_=>{if(_)return d=!0,!1}),d}),a=u(()=>!!(t.value.alwaysVisible.length||t.value.filters.length)),s=u(()=>r.value?void 0:"display: none;");return{hasFilters:a,styleHide:s,updateVisibleChildFilters:i}}const et={name:"AFilterCenter",props:{appliedModel:{type:Object,required:!0},closeAllFilters:{type:Function,required:!0},closeFilterValue:{type:Function,required:!0},dataKeyByKeyIdPerFilter:{type:Object,required:!0},disabled:{type:Boolean,required:!1},filtersGroup:{type:Object,required:!0,default:()=>({alwaysVisible:[],filters:[]})},filtersKeyById:{type:Object,required:!0},filtersVisibleAll:{type:Array,required:!0},id:{type:String,required:!0}},setup(e){const{hasFilters:t,styleHide:l,updateVisibleChildFilters:i}=Qe(e),{isLeastOneChildFilterLoading:r,updateLoadingChildFilters:a}=Ze();return{hasFilters:t,isLeastOneChildFilterLoading:r,styleHide:l,updateLoadingChildFilters:a,updateVisibleChildFilters:i}},render(){return this.hasFilters?c("div",{class:"a_filters_center"},[c("div",{class:"a_filters_center__item"},[this.$slots.filtersHorizontal?this.$slots.filtersHorizontal():""]),this.filtersVisibleAll.map(e=>c(Je,{key:e.id,id:this.id,disabled:this.disabled,filter:e,closeFilterValue:this.closeFilterValue,dataKeyByKeyIdPerFilter:this.dataKeyByKeyIdPerFilter,model:this.appliedModel[e.id],onUpdateVisibleChildFilters:this.updateVisibleChildFilters,onUpdateLoadingChildFilters:this.updateLoadingChildFilters},this.$slots)),this.isLeastOneChildFilterLoading?c("div",{style:this.styleHide,class:"a_filters_center__item"},[c(_e,{class:"a_spinner_small"})]):"",c("div",{class:"a_filters_center__item",style:this.styleHide},[c($,{class:"a_btn a_btn_link a_btn_small",iconLeft:ye,text:"_A_FILTERS_DESELECT_ALL_",onClick:this.closeAllFilters})])]):null}};function tt(e,{model:t=m({})}){const l=o(e,"filtersSaved"),i=u(()=>{const d={};return T(l.value,_=>{d[_.label]=!0}),d}),r=u(()=>i.value[t.value.name]),a=u(()=>{if(r.value)return"_A_FILTERS_SAVE_MODAL_NAME_HELP_TEXT_{{name}}_"});return{dataForm:u(()=>[{id:"name",label:"_A_FILTERS_SAVE_LABEL_NAME_",type:"text",required:!0,extra:{name:t.value.name||""},helpText:a.value}]),isUpdate:r}}function lt(e){const t=o(e,"isModelFilterSavedNew"),l=o(e,"modelFiltersSaved"),i=m({});return{initModel:()=>{l.value&&!t.value&&(i.value={name:l.value})},model:i,updateModel:s=>{i.value=s}}}function it(e,{emit:t},{isUpdate:l=u(()=>!1),model:i=m({})}){const r=o(e,"changeModelFiltersSaved"),a=o(e,"updateFiltersSaved"),s=m(void 0),{addNotification:d}=z(),_=u(()=>!i.value.name),b=()=>{t("close")};return{close:b,disabledBtnSave:_,loading:s,save:async()=>{s.value=!0;const n=l.value;try{await a.value({action:n?"update":"create",label:i.value.name})}catch{d({text:"_A_FILTERS_SAVE_MSG_ERROR_",type:"danger"}),s.value=!1;return}d({text:n?"_A_FILTERS_SAVE_MSG_SUCCESS_UPDATE_{{name}}_":"_A_FILTERS_SAVE_MSG_SUCCESS_CREATE_{{name}}_",extra:{name:i.value.name}}),r.value({model:i.value.name,isCreateOrEdit:!0}),b(),s.value=!1}}}const at={name:"AFiltersSaveModal",props:{changeModelFiltersSaved:{type:Function,required:!0},filtersSaved:{type:Array,required:!0},isModelFilterSavedNew:{type:Boolean,required:!0},modelFiltersSaved:{type:String,required:!1,default:void 0},selectorCloseIds:{type:String,required:!0},updateFiltersSaved:{type:Function,required:!0}},emits:["close"],setup(e,t){const{initModel:l,model:i,updateModel:r}=lt(e),{dataForm:a,isUpdate:s}=tt(e,{model:i}),{close:d,disabledBtnSave:_,loading:b,save:v}=it(e,t,{isUpdate:s,model:i});return l(),{close:d,dataForm:a,disabledBtnSave:_,initModel:l,loading:b,model:i,save:v,updateModel:r}},render(){return c(fe,{close:this.close,dataForm:this.dataForm,disabledSave:this.disabledBtnSave,headerText:"_A_FILTERS_SAVE_MODAL_HEADER_",modelValue:this.model,idPrefix:"modal_filter_top_",loading:this.loading,selectorCloseIds:this.selectorCloseIds,size:"large",save:this.save,stop:!0,zIndex:1901,backdropZIndex:1900,"onUpdate:modelValue":this.updateModel},{modalBodyPrepend:()=>[c(pe,{type:"info",isVisible:!0,safeHtml:"_A_FILTERS_SAVE_MODAL_BODY_PREPEND_"})]})}};function rt(e){const t=o(e,"filtersGroup"),l=m(void 0),i=u(()=>!!(t.value.alwaysVisible.length||t.value.filters.length));return{closeDropdown:()=>{var s;(s=l.value)==null||s.onClose({trigger:"click"})},dropdownRef:l,isDropdownVisible:i,openDropdown:s=>{var d;(d=l.value)==null||d.onOpen({trigger:"click",selectorToFocus:s})}}}function st(e,{openDropdown:t=()=>{}}){const l=o(e,"id");let i;return{destroyEventBus:()=>{N.$off(i,t)},initEventBus:()=>{N.$on(i,t)},initEventName:()=>{i=`eventATableFilterTopOnOpen_${l.value}`}}}function nt(e,{emit:t}){const l=o(e,"filtersGroup"),i=o(e,"filtersVisible"),r=({isAdd:v,filterId:n,filter:f})=>{t("toggleFiltersVisible",{isAdd:v,filterId:n,filter:f})},a=({model:v})=>{r({isAdd:!0,filterId:v})},s=({filter:v})=>{r({isAdd:!1,filterId:v.id,filter:v})},d=u(()=>!!(l.value.filters&&l.value.filters.length)),_=u(()=>{const v={};return T(i.value,n=>{v[n.id]=!0}),v}),b=u(()=>d.value?P(l.value.filters,v=>!_.value[v.id]):[]);return{addFiltersVisible:a,deleteFiltersVisible:s,filtersHidden:b,hasFiltersHiddenDefault:d}}function dt(e,{openDropdown:t=()=>({})}){const l=o(e,"filtersSaved"),i=o(e,"id"),r=o(e,"onUpdateModelFilters"),a="_A_FILTERS_HOR_FILTER_NEW_",s=m(void 0),d=m(void 0),_=m(void 0),b=u(()=>`${i.value}btn_save_`),v=u(()=>d.value===a),n=u(()=>{const y=[{label:a}];return T(L(l.value),p=>{p.group="_A_FILTERS_FILTER_SAVED_GROUP_MY_",y.push(p)}),y});return{buttonSaveComponentId:b,changeModelFiltersSaved:({model:y,item:p,isDelete:S,isCreateOrEdit:I})=>{if(I){d.value=y;return}if((p==null?void 0:p.label)===a||S){r.value({model:{},isUpdateFiltersVisible:!0}),d.value=a;return}y?(d.value=y,p&&(r.value({model:p.data||{},isUpdateFiltersVisible:!0}),t())):p&&(r.value({model:p.data||{},isUpdateFiltersVisible:!0}),t())},closeModalSave:()=>{s.value=!1},filtersSavedLocal:n,initModelFiltersSaved:()=>{d.value=a},isModalSaveVisible:s,isModelFilterSavedNew:v,modelFiltersSaved:d,openModalSave:()=>{_.value=b.value,s.value=!0},selectorCloseIds:_}}function ot(e,{changeModelFiltersSaved:t=()=>{},idFilterTop:l=u(()=>""),isModelFilterSavedNew:i=u(()=>!1),modelFiltersSaved:r=m(void 0)}){const a=o(e,"id"),s=o(e,"updateFiltersSaved"),{changeConfirmOptions:d,closeConfirm:_,isModalHidden:b,openConfirm:v}=ve(),{addNotification:n}=z(),f=u(()=>`${a.value}btn_save`),F=u(()=>i.value?"_A_FILTERS_DELETE_FILTER_SAVED_BTN_DISABLED_":{mobile:"_A_FILTERS_DELETE_FILTER_SAVED_BTN_"}),h=u(()=>i.value?"_A_FILTERS_DELETE_FILTER_SAVED_BTN_DISABLED_":"_A_FILTERS_DELETE_FILTER_SAVED_BTN_"),A=async()=>{d({loading:!0});try{await s.value({action:"delete",label:r.value})}catch{n({text:"_A_FILTERS_DELETE_FILTER_MSG_ERROR_{{name}}_",type:"danger",extra:{name:r.value}}),d({loading:!1});return}n({text:"_A_FILTERS_DELETE_FILTER_MSG_SUCCESS_{{name}}_",extra:{name:r.value}}),d({loading:!1}),_(),t({model:void 0,isDelete:!0})};return{buttonDeleteId:f,isConfirmHidden:b,openDeleteConfirm:()=>{v({headerText:"_A_FILTERS_DELETE_FILTER_HEADER_{{name}}_",bodyHtml:"_A_FILTERS_DELETE_FILTER_BODY_{{name}}_",extra:{name:r.value},save:A,selectorCloseIds:[f.value,l.value],saveButtonText:"_A_FILTERS_DELETE_FILTER_BTN_DELETE_",stop:!0,zIndex:1901,backdropZIndex:1900})},textScreenreaderButtonDeleteFiltersSaved:h,titleButtonDeleteFiltersSaved:F}}function ut(e){const t=o(e,"filtersGroup"),l=o(e,"filtersVisible"),i=o(e,"updateDataKeyByIdFromFilter"),r="a_column a_column_12_touch a_column_3_fullhd a_column_3_widescreen a_column_3_desktop",a="a_columns a_columns_count_12 a_columns_gap_x_2 a_columns_gap_y_2 a_columns_gap_y_1_touch",s="a_filters__form_element a_column a_column_12_touch a_column_9_fullhd a_column_9_widescreen a_column_9_desktop",d=["select","multiselect","radio","checkbox","group","fieldset"],_=({dataKeyByKeyId:v,item:n,filter:f})=>{let F=f.id;n&&(F=n.id),i.value({filterId:F,dataKeyByKeyId:v})};return{dataForForm:u(()=>{const v=[];return T(t.value.alwaysVisible,n=>{const f=L(n);f.labelClass=r,f.classColumn=s,d.indexOf(n.type)!==-1&&(f.onUpdateData=({dataKeyByKeyId:F,item:h})=>_({dataKeyByKeyId:F,item:h,filter:n})),v.push({type:"group",id:`group_${n.id}`,classColumns:a,children:[f]})}),T(l.value,n=>{const f=L(n);f.labelClass=r,f.classColumn=`${s}  a_d_flex a_align_items_center`,f.slotAppend="groupAppend",f.class="a_width_100",d.indexOf(n.type)!==-1&&(f.onUpdateData=({dataKeyByKeyId:F,item:h})=>_({dataKeyByKeyId:F,item:h,filter:n})),v.push({type:"group",id:`group_${n.id}`,classColumns:a,children:[f]})}),v})}}function ct(e){const t=o(e,"id");return{idFilterTop:u(()=>`${t.value}_filter_top`)}}function _t(e,{emit:t},{closeDropdown:l=()=>{}}){const i=o(e,"disabled");return{onSearch:()=>{i.value||(l(),t("startSearch"))}}}const ft={name:"AFiltersHorizontal",props:{canSave:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filtersGroup:{type:Object,required:!0,default:()=>({alwaysVisible:[],filters:[]})},filtersKeyById:{type:Object,required:!0},filtersSaved:{type:Array,required:!0},filtersVisible:{type:Array,required:!0},id:{type:String,required:!0},mainModel:{type:Object,required:!1},onUpdateModelFilters:{type:Function,required:!0},unappliedModel:{type:Object,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0},updateFiltersSaved:{type:Function,required:!0}},emits:["startSearch","toggleFiltersVisible"],setup(e,t){const{dataForForm:l}=ut(e),{closeDropdown:i,dropdownRef:r,isDropdownVisible:a,openDropdown:s}=rt(e),{idFilterTop:d}=ct(e),{onSearch:_}=_t(e,t,{closeDropdown:i}),{destroyEventBus:b,initEventBus:v,initEventName:n}=st(e,{openDropdown:s}),{addFiltersVisible:f,deleteFiltersVisible:F,filtersHidden:h,hasFiltersHiddenDefault:A}=nt(e,t),{buttonSaveComponentId:y,changeModelFiltersSaved:p,closeModalSave:S,filtersSavedLocal:I,initModelFiltersSaved:C,isModalSaveVisible:x,isModelFilterSavedNew:E,modelFiltersSaved:M,openModalSave:g,selectorCloseIds:R}=dt(e,{openDropdown:s}),{buttonDeleteId:Z,isConfirmHidden:Q,openDeleteConfirm:ee,textScreenreaderButtonDeleteFiltersSaved:te,titleButtonDeleteFiltersSaved:le}=ot(e,{changeModelFiltersSaved:p,idFilterTop:d,isModelFilterSavedNew:E,modelFiltersSaved:M});return n(),C(),v(),Y(()=>{b()}),{addFiltersVisible:f,buttonDeleteId:Z,buttonSaveComponentId:y,changeModelFiltersSaved:p,closeDropdown:i,closeModalSave:S,dataForForm:l,deleteFiltersVisible:F,dropdownRef:r,filtersHidden:h,filtersSavedLocal:I,hasFiltersHiddenDefault:A,idFilterTop:d,initModelFiltersSaved:C,isConfirmHidden:Q,isDropdownVisible:a,isModalSaveVisible:x,isModelFilterSavedNew:E,modelFiltersSaved:M,onSearch:_,openDeleteConfirm:ee,openModalSave:g,selectorCloseIds:R,textScreenreaderButtonDeleteFiltersSaved:te,titleButtonDeleteFiltersSaved:le}},render(){return this.isDropdownVisible?[c(Fe,{ref:"dropdownRef",buttonIconLeft:Se,buttonText:"Filter",buttonClass:"a_btn a_btn_primary a_btn_small a_filter_horizontal__btn_dropdown",dropdownTag:"div",dropdownClass:"a_filter_horizontal__wrapper",dropdownRenderDefault:!0,isCloseByClickInside:!1,hasCaret:!1,inBody:!0,lockArrowsNavigation:!1,lockTabNavigation:!1,useEscape:!this.isModalSaveVisible&&this.isConfirmHidden},{...this.$slots,dropdown:()=>c("div",{class:"a_filter_horizontal"},[c("div",{class:"a_filter_horizontal__header__wrapper"},[c("div",{class:"a_filter_horizontal__header"},[c("div",{class:"a_filter_horizontal__header__texts"},[c(O,{class:"a_filter_horizontal__header__texts__filter",tag:"span",text:"_A_FILTERS_HOR_FILTER_HEADER_"}),this.isModelFilterSavedNew?c(O,{class:"a_filter_horizontal__header__texts__new",tag:"em",text:this.modelFiltersSaved}):c("span",{},this.modelFiltersSaved)]),this.canSave?c(k,{modelValue:this.modelFiltersSaved,change:this.changeModelFiltersSaved,class:"a_filters_top__save_select",data:this.filtersSavedLocal,deselectable:!1,keyId:"label",keyLabel:"label",keyGroup:"group",label:"_A_FILTERS_SAVE_SELECT_",menuWidthType:"by_content",search:!0,translateData:!0,type:"select"}):""])]),c("div",{class:"a_filter_horizontal__body__wrapper"},[c("div",{class:"a_filter_horizontal__body"},[c(j,{idPrefix:this.idFilterTop,class:"a_filter_horizontal__body__form",classColumnDefault:"",classColumns:"",data:this.dataForForm,excludeRenderAttributes:this.excludeRenderAttributes,modelValue:this.unappliedModel,showErrors:!1,onChange:this.onUpdateModelFilters},{...this.$slots,groupAppend:({item:e})=>c(D,{type:"button",class:"a_btn a_btn_primary a_ml_2",title:"_A_FILTERS_TOP_CLOSE_",textScreenReader:"_A_FILTERS_TOP_CLOSE_",iconLeft:X,stop:!0,onClick:()=>this.deleteFiltersVisible({filter:e})}),formDataAppend:()=>c("div",{class:"a_filter_horizontal__add_filter__wrapper"},[c(k,{buttonClassDefault:"a_btn a_btn_primary a_filter_horizontal__add_filter",change:this.addFiltersVisible,data:this.filtersHidden,hasCaret:!1,disabled:!this.filtersHidden.length,isLabelFloat:!1,keyGroup:"group",keyId:"id",keyLabel:"label",label:"_A_FILTERS_ADD_FILTER_",labelClass:"a_sr_only",menuWidthType:"by_content",sortOrderGroup:"asc",placement:"bottom-start",search:!0,translateData:!0,type:"select"},{fixedPlaceholder:()=>[c(O,{tag:"span",ariaHidden:!0,class:"a_position_absolute_all",title:"_A_FILTERS_ADD_FILTER_"}),c(he,{icon:me})]})]),formAppend:()=>this.canSave?c("div",{class:"a_filter_horizontal__save_actions"},[c(D,{id:this.buttonSaveComponentId,class:"a_btn a_btn_primary",iconLeft:Ae,type:"button",text:"_A_FILTERS_SAVE_FILTER_SAVED_BTN_TEXT_",onClick:this.openModalSave}),c(D,{id:this.buttonDeleteId,ariaDisabled:this.isModelFilterSavedNew,class:"a_btn a_btn_secondary",iconLeft:Ee,text:{desktop:"_A_FILTERS_DELETE_FILTER_SAVED_BTN_TEXT_"},textAriaHidden:!0,textScreenReader:this.textScreenreaderButtonDeleteFiltersSaved,title:this.titleButtonDeleteFiltersSaved,type:"button",onClick:this.openDeleteConfirm})]):""})]),c("div",{class:"a_filter_horizontal__footer"},[c("div",{class:"a_filter_horizontal__footer__actions"},[c(D,{type:"button",class:"a_btn a_btn_primary a_text_nowrap a_filter_horizontal__footer__actions__btn_search",iconLeft:Ie,text:"_A_FILTERS_START_SEARCH_",disabled:this.disabled,onClick:this.onSearch}),c(D,{type:"button",class:"a_btn a_btn_secondary a_text_nowrap a_filter_horizontal__footer__actions__btn_close",text:"_A_FILTERS_HOR_CLOSE_DROPDOWN_",onClick:this.closeDropdown})])])])])}),this.isModalSaveVisible?c(at,{changeModelFiltersSaved:this.changeModelFiltersSaved,filtersSaved:this.filtersSaved,isModelFilterSavedNew:this.isModelFilterSavedNew,modelFiltersSaved:this.modelFiltersSaved,selectorCloseIds:this.selectorCloseIds,updateFiltersSaved:this.updateFiltersSaved,onClose:this.closeModalSave}):""]:null}};function pt(e){const t=o(e,"id");return{idFilterTop:u(()=>`${t.value}_filter_main`)}}function vt(e){const t=o(e,"filterMain"),l=u(()=>!!t.value),i=u(()=>l.value?[t.value]:[]);return{hasFilterMain:l,dataMainFilter:i}}function Ft(e,{emit:t}){const l=o(e,"disabled");return{onSearch:()=>{l.value||t("startSearch")}}}const ht={name:"AFiltersMain",props:{disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filterMain:{type:Object,required:!1},id:{type:String,required:!0},mainModel:{type:Object,required:!1},updateDataKeyByIdFromFilter:{type:Function,required:!0},updateMainModel:{type:Function,required:!0}},emits:["startSearch"],setup(e,t){const{hasFilterMain:l,dataMainFilter:i}=vt(e),{idFilterTop:r}=pt(e),{onSearch:a}=Ft(e,t);return{hasFilterMain:l,dataMainFilter:i,idFilterTop:r,onSearch:a}},render(){return this.hasFilterMain?c("div",{id:this.idFilterTop,class:"a_filters_top"},[c(j,{idPrefix:this.idFilterTop,class:"a_filters_top__form",classColumns:"a_filters_top__main_wrapper",classColumnDefault:"a_filters_top__main",data:this.dataMainFilter,excludeRenderAttributes:this.excludeRenderAttributes,modelValue:this.mainModel,showErrors:!1,onChange:this.updateMainModel},{formDataAppend:()=>c($,{class:"a_btn a_btn_primary a_text_nowrap a_filters_top__search",iconLeft:Te,type:"submit",text:{desktop:"_A_FILTERS_START_SEARCH_"},textScreenReader:{mobile:"_A_FILTERS_START_SEARCH_"},prevent:!0,stop:!0,disabled:this.disabled,onClick:this.onSearch})})]):null}};function bt(e,{emit:t},{filtersHorizontalRef:l=m(void 0),filtersVisibleAll:i=u(()=>[]),onUpdateModelFilters:r=()=>{}}){const a=o(e,"appliedModel"),s=o(e,"unappliedModel"),d=()=>{var n;(n=l.value)==null||n.initModelFiltersSaved()},_=({filter:n,keyId:f,modelArray:F,appliedModelLocal:h,unappliedModelLocal:A})=>{const y=n.id;return U.value[n.type]?(h[y]&&h[y].length&&(F?h[y]=P(h[y],p=>F.indexOf(p)===-1):h[y]=[]),A[y]&&A[y].length&&(F?A[y]=P(A[y],p=>F.indexOf(p)===-1):A[y]=[])):W.value[n.type]&&f?(G(A==null?void 0:A[y])&&(A[y][f]=void 0),G(h==null?void 0:h[y])&&(h[y][f]=void 0)):(A[y]=void 0,h[y]=void 0),{appliedModelLocal:h,unappliedModelLocal:A}};return{closeAllFilters:()=>{let n=L(a.value),f=L(s.value);T(i.value,F=>{const h=_({filter:F,appliedModelLocal:n,unappliedModelLocal:f});n=h.appliedModelLocal,f=h.unappliedModelLocal}),d(),t("update:unappliedModel",f),t("update:appliedModel",n),setTimeout(()=>{r({fullModel:a.value})})},closeFilterValue:({filter:n,keyId:f,modelArray:F})=>{const h=L(a.value),A=L(s.value),{appliedModelLocal:y,unappliedModelLocal:p}=_({filter:n,keyId:f,modelArray:F,appliedModelLocal:h,unappliedModelLocal:A});t("update:unappliedModel",p),t("update:appliedModel",y),setTimeout(()=>{r({fullModel:a.value})})}}}function yt(){const e=m({});return{dataKeyByKeyIdPerFilter:e,updateDataKeyByIdFromFilter:({dataKeyByKeyId:l,filterId:i})=>{e.value[i]=L(l)}}}function St(e){const t=o(e,"excludeRenderAttributes"),l=["alwaysVisible"];return{excludeRenderAttributesComputed:u(()=>Ce(l,t.value))}}function At({filter:e={},modelObj:t={}}){var i;const l=e.id;return l in t?U.value[e.type]?!!((i=t[l])!=null&&i.length):W.value[e.type]?!!(t[l]&&!J(t[l])):!0:!1}function Et(e,{emit:t}){const l=o(e,"filters"),i=o(e,"filterMain"),r=o(e,"unappliedModel"),a=m({}),s=m(void 0),d=m([]),_=u(()=>!!(l.value.length||i.value)),b=u(()=>{const p={};return T(L(l.value),S=>{p[S.id]=S,q.value[S.type]&&S.children&&S.children.length&&T(S.children,I=>{p[I.id]=I})}),p}),v=u(()=>{const p={alwaysVisible:[],filters:[]};return T(L(l.value),S=>{S.alwaysVisible?p.alwaysVisible.push(S):p.filters.push(S)}),p}),n=u(()=>{const p=[];return T(d.value,S=>{b.value[S]&&p.push(b.value[S])}),p}),f=u(()=>{const p=[];p.push(...l.value);const S=[];return T(p,I=>{S.push(I),q.value[I.type]&&I.children&&I.children.length&&T(I.children,C=>{S.push(C)})}),S}),F=()=>{const p=[];T(v.value.filters,S=>{At({filter:S,modelObj:r.value})&&p.push(S.id)}),d.value=p};return{filtersDataKeyById:a,filtersGroup:v,filtersHorizontalRef:s,filtersKeyById:b,filtersVisible:n,filtersVisibleAll:f,filtersVisibleIds:d,hasFilters:_,onUpdateModelFilters:({fullModel:p,isUpdateFiltersVisible:S})=>{t("update:unappliedModel",p),S&&setTimeout(()=>{F()})},setFiltersVisibleIds:F,updateAppliedModel:({model:p})=>{t("update:appliedModel",p)},updateMainModel:({fullModel:p})=>{t("update:mainModel",p)}}}function mt(e){const t=o(e,"filtersSaved"),l=o(e,"unappliedModel"),i=o(e,"updateFiltersSaved"),r=m([]);return{filtersSavedLocal:r,initFiltersSaved:()=>{r.value=t.value||[]},updateFiltersSavedLocal:({action:d="",label:_=""})=>{if(d==="create")r.value.push({label:_,data:L(l.value)});else{const b=De(r.value,["label",_]);b!==-1&&(d==="delete"?r.value.splice(b,1):d==="update"&&r.value.splice(b,1,{label:_,data:L(l.value)}))}xe(i.value)&&i.value({action:d,label:_,model:l.value,filtersSaved:r.value})}}}function It(e,{emit:t},{onUpdateModelFilters:l=()=>{}}){const i=o(e,"appliedModel"),r=o(e,"unappliedModel");return{startSearch:()=>{t("update:appliedModel",r.value),setTimeout(()=>{l({fullModel:i.value})})}}}function Tt(e,{dataKeyByKeyIdPerFilter:t=m({}),filtersVisibleIds:l=m([]),onUpdateModelFilters:i=()=>{}}){const r=o(e,"unappliedModel");return{toggleFiltersVisible:({isAdd:s=!0,filterId:d,filter:_})=>{var b,v;if(s)l.value.push(d);else{const n=l.value.indexOf(d);n!==-1&&l.value.splice(n,1);const f=L(r.value);if(_&&_.modelId){const F=(b=t.value)==null?void 0:b[d];(v=f==null?void 0:f[_.modelId])!=null&&v.length&&F?f[_.modelId]=P(f[_.modelId],h=>!F[h]):f[d]=void 0}else f[d]=void 0;i({fullModel:f})}}}}const gt={name:"AFilters",props:{appliedModel:{type:Object,required:!1,default:()=>({})},canSave:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filterMain:{type:Object,required:!1},filters:{type:Array,required:!1,default:()=>[]},filtersSaved:{type:Array,required:!1,default:()=>[]},id:{type:String,required:!1,default:()=>Ve("a_filters_")},mainModel:{type:Object,required:!1},unappliedModel:{type:Object,required:!1,default:()=>({})},updateFiltersSaved:{type:Function,required:!1,default:void 0},view:{type:String,required:!1,default:"top",validator:e=>["top","right"].indexOf(e)!==-1},viewRightTeleportSelector:{type:String,required:!1,default:void 0}},emits:["startSearch","update:appliedModel","update:mainModel","update:unappliedModel"],setup(e,t){const l=o(e,"filtersSaved"),{filtersDataKeyById:i,filtersGroup:r,filtersHorizontalRef:a,filtersKeyById:s,filtersVisible:d,filtersVisibleAll:_,filtersVisibleIds:b,hasFilters:v,onUpdateModelFilters:n,setFiltersVisibleIds:f,updateAppliedModel:F,updateMainModel:h}=Et(e,t),{closeAllFilters:A,closeFilterValue:y}=bt(e,t,{filtersHorizontalRef:a,filtersVisibleAll:_,onUpdateModelFilters:n}),{dataKeyByKeyIdPerFilter:p,updateDataKeyByIdFromFilter:S}=yt(),{toggleFiltersVisible:I}=Tt(e,{dataKeyByKeyIdPerFilter:p,filtersVisibleIds:b,onUpdateModelFilters:n}),{startSearch:C}=It(e,t,{onUpdateModelFilters:n}),{filtersSavedLocal:x,initFiltersSaved:E,updateFiltersSavedLocal:M}=mt(e),{excludeRenderAttributesComputed:g}=St(e);return K(l,()=>{E()},{deep:!0}),f(),E(),{closeAllFilters:A,closeFilterValue:y,dataKeyByKeyIdPerFilter:p,excludeRenderAttributesComputed:g,filtersDataKeyById:i,filtersGroup:r,filtersHorizontalRef:a,filtersKeyById:s,filtersSavedLocal:x,filtersVisible:d,filtersVisibleAll:_,filtersVisibleIds:b,hasFilters:v,onUpdateModelFilters:n,setFiltersVisibleIds:f,startSearch:C,toggleFiltersVisible:I,updateAppliedModel:F,updateDataKeyByIdFromFilter:S,updateFiltersSavedLocal:M,updateMainModel:h}},render(){if(this.hasFilters)return c("div",[this.view==="top"&&c(ht,{id:this.id,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filterMain:this.filterMain,mainModel:this.mainModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,updateMainModel:this.updateMainModel,onStartSearch:this.startSearch},this.$slots),this.view==="right"&&c(Le,{to:this.viewRightTeleportSelector,disabled:!this.viewRightTeleportSelector},[c(He,{id:this.id,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filters:this.filters,filtersKeyById:this.filtersKeyById,appliedModel:this.appliedModel,onUpdateModelFilters:this.updateAppliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,onStartSearch:this.startSearch},this.$slots)]),c(et,{id:this.id,appliedModel:this.appliedModel,closeAllFilters:this.closeAllFilters,closeFilterValue:this.closeFilterValue,dataKeyByKeyIdPerFilter:this.dataKeyByKeyIdPerFilter,disabled:this.disabled,filtersGroup:this.filtersGroup,filtersKeyById:this.filtersKeyById,filtersVisibleAll:this.filtersVisibleAll},{filtersHorizontal:()=>this.view==="top"?c(ft,{ref:"filtersHorizontalRef",id:this.id,canSave:this.canSave,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filtersGroup:this.filtersGroup,filtersKeyById:this.filtersKeyById,filtersSaved:this.filtersSavedLocal,filtersVisible:this.filtersVisible,onUpdateModelFilters:this.onUpdateModelFilters,unappliedModel:this.unappliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,updateFiltersSaved:this.updateFiltersSavedLocal,onStartSearch:this.startSearch,onToggleFiltersVisible:this.toggleFiltersVisible},this.$slots):"",...this.$slots})])}};export{gt as A};
