import{t as te,u as le,a6 as q,a7 as ie,a8 as ae,a9 as re,aa as se,E as K,ab as ne,y as de,ac as N,ad as w,g as V,ae as oe,v as D,A as O,d as ue,c as G,p as $,m as ce,af as _e,o as fe,w as H,Q as z,a as pe,D as Fe,ag as j}from"./bundle.index.B5hAPZ2P.js";import{t as o,a as u,h as c,b as U,m as W,bn as ve,u as X,r as E,bo as he,bj as be,bp as ye,Z as Se,bh as Ae,bq as me,S as Ee,T as Ie}from"./chunk.vendor.QyCKSPD8.js";import{h as Te,m as L,c as B,a as Le,k as Y,n as P,g as Me,f as T,d as k,a4 as Re,a2 as ge,j as Ce,u as De}from"./chunk.vendor-lodash.GuFqEw-8.js";function xe(){return{componentTypesMapping:{...te,...le}}}function Ve(e){const t=o(e,"filter");return{isContainer:u(()=>!!q.value[t.value.type])}}function Be(e){const t=o(e,"filter");return{filterSpecificAttributes:u(()=>{const i={},r=ie[t.value.type],a=ae[t.value.type];return r&&Te(t.value.inputWidth)&&(i.inputWidth="auto"),a&&(i.inputWidth="inherit",i.inputAttributes={style:"min-width: 181px"}),i})}}function Pe(e){const t=o(e,"id");return{idPrefix:u(()=>`${t.value}_`)}}function Oe(e,{isContainer:t=u(()=>!1)}){const l=o(e,"filter"),i=o(e,"onUpdateModelFilters"),r=o(e,"unappliedModel");return{onUpdateModelFiltersLocal:s=>{if(t.value)i.value({model:s});else{const d=L(r.value);d[l.value.id]=L(s),i.value({model:d})}}}}function qe(e){const t=o(e,"filter"),l=o(e,"updateDataKeyByIdFromFilter"),i=["select","multiselect","radio","checkbox","group","fieldset"],r=({dataKeyByKeyId:s,item:d})=>{let _=t.value.id;d&&(_=d.id),l.value({filterId:_,dataKeyByKeyId:s})};return{emitForComponentsWithData:u(()=>{const s={};return i.indexOf(t.value.type)!==-1&&(s.onUpdateData=r),s})}}const Ke={name:"AFiltersHorizontalFilterUi",props:{excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filter:{type:Object,required:!1,default:void 0},id:{type:String,required:!0},isLabelVisible:{type:Boolean,required:!0},onUpdateModelFilters:{type:Function,required:!0},unappliedModel:{type:Object,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0}},setup(e){const{attributesToExcludeFromRender:t}=re(e),{isContainer:l}=Ve(e),{onUpdateModelFiltersLocal:i}=Oe(e,{isContainer:l}),{emitForComponentsWithData:r}=qe(e),{idPrefix:a}=Pe(e),{componentTypesMapping:s}=xe(),{filterSpecificAttributes:d}=Be(e);return{attributesToExcludeFromRender:t,componentTypesMapping:s,emitForComponentsWithData:r,filterSpecificAttributes:d,idPrefix:a,isContainer:l,onUpdateModelFiltersLocal:i}},render(){return c(this.componentTypesMapping[this.filter.type],{idPrefix:this.idPrefix,modelValue:this.isContainer?this.unappliedModel:this.unappliedModel[this.filter.id],"onUpdate:modelValue":this.onUpdateModelFiltersLocal,excludeRenderAttributes:this.excludeRenderAttributes,...this.filter,...this.filterSpecificAttributes,label:this.isLabelVisible?this.filter.label:void 0,...this.emitForComponentsWithData,...this.attributesToExcludeFromRender},this.$slots)}};function Ue(e){const t=o(e,"id");return{idFilterRight:u(()=>`${t.value}_filter_right`)}}const we={name:"AFilersRight",props:{appliedModel:{type:Object,required:!0},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filters:{type:Array,required:!1,default:()=>[]},filtersKeyById:{type:Object,required:!0},id:{type:String,required:!0},onUpdateModelFilters:{type:Function,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0}},emits:["startSearch"],setup(e){const{idFilterRight:t}=Ue(e);return{idFilterRight:t}},render(){return c("div",{id:this.idFilterRight,class:"a_filters_right"},[c("form",{},[this.filters.map(e=>c(Ke,{id:this.id,class:"a_filters_right__filter_ui",excludeRenderAttributes:this.excludeRenderAttributes,filter:e,isLabelVisible:!0,onUpdateModelFilters:this.onUpdateModelFilters,unappliedModel:this.appliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter},this.$slots))])])}};function Ne(e){const t=o(e,"closeFilterValue"),l=o(e,"disabled"),i=o(e,"filter");return{closeCurrentFilterValue:({modelValue:a})=>{l.value||t.value({filter:i.value,modelArray:a.modelArray,keyId:a.keyId})}}}function He(e,{emit:t},{modelValuesForCurrentFilter:l=u(()=>[])}){const i=o(e,"filter"),r=u(()=>l.value.length>0);return{isLeastOneFilterVisible:r,updateVisibleChildFilters:({destroy:s}={})=>{t("updateVisibleChildFilters",{id:i.value.id,isVisible:s?!1:r.value})}}}function ke(e){const t=o(e,"filter"),l=o(e,"id"),i=u(()=>`eventATableFilterTopOnOpen_${l.value}`);return{goToFilter:({modelValue:a}={})=>{let s=se({id:t.value.id,idPrefix:`${l.value}_filter_top`,htmlId:t.value.htmlId});a.idSuffix&&(s+=a.idSuffix),t.value.main||K.$emit(i.value,s)}}}function Ge({filter:e,currentModel:t}){return!(!e||e.hideFilterCenter||B(t)||t===""||Le(t)&&!t.length)}function $e(e){const t=o(e,"filter"),l=o(e,"model");return{hasCurrentFilter:u(()=>Ge({filter:t.value,currentModel:l.value}))}}function ze(e,{emit:t},{hasCurrentFilter:l=u(()=>!1)}){const i=o(e,"dataKeyByKeyIdPerFilter"),r=o(e,"filter"),a=u(()=>l.value&&ne.value[r.value.type]?Y(i.value[r.value.id]):!1);return{isFilterLoading:a,updateLoadingChildFilters:(d,_)=>{d!==_&&t("updateLoadingChildFilters",{id:r.value.id,isLoading:a.value})}}}function je(e,{hasCurrentFilter:t=u(()=>!1)}){const l=o(e,"filter"),i=u(()=>t.value?l.value.label:""),r=u(()=>{if(t.value)return l.value.labelScreenReader}),a=u(()=>r.value||i.value);return{filterLabel:i,filterLabelForTitle:a}}function We(e,{filterLabel:t=u(()=>""),filterLabelForTitle:l=u(()=>""),hasCurrentFilter:i=u(()=>!1)}){const r=o(e,"dataKeyByKeyIdPerFilter"),a=o(e,"filter"),s=o(e,"model"),{filterBoolean:d,filterDate:_}=de(),b=u(()=>{if(a.value)return r.value[a.value.id]}),F=u(()=>{var v;return(v=s.value)!=null&&v.length?P(s.value,h=>b.value&&b.value[h]):[]}),n=({label:v,suffixTranslated:h})=>{const A=V({placeholder:v});return h?`${A} ${h}`:A};return{modelValuesForCurrentFilter:u(()=>{var v,h,A,y,p,S,I,C,x;if(!i.value)return[];if(a.value.type==="switch"||a.value.type==="oneCheckbox")return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:d(s.value)}];if(a.value.type==="date")return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:_(s.value)}];if(a.value.type==="select"||a.value.type==="radio"){const m=Me(b.value,`${s.value}.${N}`);return m?[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:m}]:[]}if(w.value[a.value.type]||a.value.type==="radio"&&a.value.isModelArray){if(F.value.length){if(F.value.length===1){const m=(v=b.value)==null?void 0:v[F.value[0]];return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:m==null?void 0:m[N],item:m,modelArray:F.value}]}return[{filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value}),label:V({placeholder:"_A_FILTERS_SELECTED_{{count}}_",extra:{count:F.value.length,modelArray:F.value}}),modelArray:F.value,extra:{count:F.value.length,modelArray:F.value}}]}return[]}if(a.value.type==="dateRange"){const m=a.value.keyFrom||"from",M=a.value.keyUntil||"until",g=[];if(!B((h=s.value)==null?void 0:h[m])&&((A=s.value)==null?void 0:A[m])!==""){const R=V({placeholder:a.value.labelFrom||"_A_DATEPICKER_RANGE_FROM_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:_(s.value[m]),idSuffix:"_from",keyId:m})}if(!B((y=s.value)==null?void 0:y[M])&&((p=s.value)==null?void 0:p[M])!==""){const R=V({placeholder:a.value.labelUntil||"_A_DATEPICKER_RANGE_UNTIL_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:_(s.value[M]),idSuffix:"_until",keyId:M})}return g}if(oe.indexOf(a.value.type)!==-1){const m=a.value.keyMax||"max",M=a.value.keyMin||"min",g=[];if(!B((S=s.value)==null?void 0:S[M])&&((I=s.value)==null?void 0:I[M])!==""){const R=V({placeholder:a.value.labelMin||"_A_INPUT_NUMBER_RANGE_LABEL_MIN_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:s.value[M],idSuffix:"_min",keyId:M})}if(!B((C=s.value)==null?void 0:C[m])&&((x=s.value)==null?void 0:x[m])!==""){const R=V({placeholder:a.value.labelMax||"_A_INPUT_NUMBER_RANGE_LABEL_MAX_"});g.push({filterLabelTranslated:n({label:t.value,suffixTranslated:R}),filterLabelForTitleTranslated:n({label:l.value,suffixTranslated:R}),label:s.value[m],idSuffix:"_max",keyId:m})}return g}return[{label:s.value,filterLabelTranslated:n({label:t.value}),filterLabelForTitleTranslated:n({label:l.value})}]})}}const Xe={name:"AFilterCenterItem",props:{closeFilterValue:{type:Function,required:!0},dataKeyByKeyIdPerFilter:{type:Object,required:!0},disabled:{type:Boolean,required:!1},filter:{type:Object,required:!1,default:void 0},id:{type:String,required:!0},model:{type:[String,Number,Object,Array,Boolean],required:!1,default:void 0}},emits:["updateVisibleChildFilters","updateLoadingChildFilters"],setup(e,t){const{hasCurrentFilter:l}=$e(e),{isFilterLoading:i,updateLoadingChildFilters:r}=ze(e,t,{hasCurrentFilter:l}),{filterLabel:a,filterLabelForTitle:s}=je(e,{hasCurrentFilter:l}),{modelValuesForCurrentFilter:d}=We(e,{filterLabel:a,filterLabelForTitle:s,hasCurrentFilter:l}),{isLeastOneFilterVisible:_,updateVisibleChildFilters:b}=He(e,t,{modelValuesForCurrentFilter:d}),{goToFilter:F}=ke(e),{closeCurrentFilterValue:n}=Ne(e);return U(_,()=>{b()},{immediate:!0}),U(i,(f,v)=>{r(f,v)},{immediate:!0}),W(()=>{b({destroy:!0})}),{closeCurrentFilterValue:n,filterLabel:a,goToFilter:F,hasCurrentFilter:l,isLeastOneFilterVisible:_,modelValuesForCurrentFilter:d}},render(){return this.hasCurrentFilter&&[this.modelValuesForCurrentFilter.map(e=>c("div",{role:"group",class:"a_filters_center__item a_btn_group a_btn_group_small"},[this.filter.hasNotClose&&c(D,{class:"a_btn a_btn_secondary",ariaHidden:!0,tabindex:-1,iconLeft:ve,type:"text"}),c(D,{class:"a_btn a_btn_secondary",title:"_A_FILTERS_HOR_GO_TO_TITLE_{{filterLabel}}_{{filterValue}}_",textScreenReader:"_A_FILTERS_HOR_GO_TO_TITLE_{{filterLabel}}_{{filterValue}}_",extra:{filterLabel:e.filterLabelForTitleTranslated,filterValue:e.label},type:"button",onClick:()=>this.goToFilter({modelValue:e})},()=>[e.filterLabelTranslated?c("strong",{class:"a_filters_center__item__label",ariaHidden:!0},[c(O,{tag:"span",html:e.filterLabelTranslated,textAfter:":"})]):"",this.filter.slotName&&this.$slots[this.filter.slotName]?this.$slots[this.filter.slotName]({item:e.item,label:e.label,extra:e.extra,inFilterCenter:!0}):c("span",{class:"a_filters_center__item__value"},e.label)]),this.filter.hasNotClose?"":c(D,{class:"a_btn a_btn_secondary",disabled:this.disabled,iconLeft:X,title:"_A_FILTERS_HOR_CLOSE_TITLE_{{filterLabel}}_{{filterValue}}_",textScreenReader:"_A_FILTERS_HOR_CLOSE_TITLE_{{filterLabel}}_{{filterValue}}_",extra:{filterLabel:e.filterLabelForTitleTranslated,filterValue:e.label},type:"button",onClick:()=>this.closeCurrentFilterValue({modelValue:e})})]))]}};function Ye(){const e=E({}),t=({id:i,isLoading:r})=>{e.value[i]=r};return{isLeastOneChildFilterLoading:u(()=>{let i=!1;return T(e.value,r=>{if(r)return i=!0,!1}),i}),updateLoadingChildFilters:t}}function Ze(e){const t=o(e,"filtersGroup"),l=E({}),i=({id:d,isVisible:_})=>{l.value[d]=_},r=u(()=>{let d=!1;return T(l.value,_=>{if(_)return d=!0,!1}),d}),a=u(()=>!!(t.value.alwaysVisible.length||t.value.filters.length)),s=u(()=>r.value?void 0:"display: none;");return{hasFilters:a,styleHide:s,updateVisibleChildFilters:i}}const Je={name:"AFilterCenter",props:{appliedModel:{type:Object,required:!0},closeAllFilters:{type:Function,required:!0},closeFilterValue:{type:Function,required:!0},dataKeyByKeyIdPerFilter:{type:Object,required:!0},disabled:{type:Boolean,required:!1},filtersGroup:{type:Object,required:!0,default:()=>({alwaysVisible:[],filters:[]})},filtersKeyById:{type:Object,required:!0},filtersVisibleAll:{type:Array,required:!0},id:{type:String,required:!0}},setup(e){const{hasFilters:t,styleHide:l,updateVisibleChildFilters:i}=Ze(e),{isLeastOneChildFilterLoading:r,updateLoadingChildFilters:a}=Ye();return{hasFilters:t,isLeastOneChildFilterLoading:r,styleHide:l,updateLoadingChildFilters:a,updateVisibleChildFilters:i}},render(){return this.hasFilters?c("div",{class:"a_filters_center"},[c("div",{class:"a_filters_center__item"},[this.$slots.filtersHorizontal?this.$slots.filtersHorizontal():""]),this.filtersVisibleAll.map(e=>c(Xe,{key:e.id,id:this.id,disabled:this.disabled,filter:e,closeFilterValue:this.closeFilterValue,dataKeyByKeyIdPerFilter:this.dataKeyByKeyIdPerFilter,model:this.appliedModel[e.id],onUpdateVisibleChildFilters:this.updateVisibleChildFilters,onUpdateLoadingChildFilters:this.updateLoadingChildFilters},this.$slots)),this.isLeastOneChildFilterLoading?c("div",{style:this.styleHide,class:"a_filters_center__item"},[c(ue,{class:"a_spinner_small"})]):"",c("div",{class:"a_filters_center__item",style:this.styleHide},[c(G,{class:"a_btn a_btn_link a_btn_small",iconLeft:he,text:"_A_FILTERS_DESELECT_ALL_",onClick:this.closeAllFilters})])]):null}};function Qe(e,{model:t=E({})}){const l=o(e,"filtersSaved"),i=u(()=>{const d={};return T(l.value,_=>{d[_.label]=!0}),d}),r=u(()=>i.value[t.value.name]),a=u(()=>{if(r.value)return"_A_FILTERS_SAVE_MODAL_NAME_HELP_TEXT_{{name}}_"});return{dataForm:u(()=>[{id:"name",label:"_A_FILTERS_SAVE_LABEL_NAME_",type:"text",required:!0,extra:{name:t.value.name||""},helpText:a.value}]),isUpdate:r}}function et(e){const t=o(e,"isModelFilterSavedNew"),l=o(e,"modelFiltersSaved"),i=E({});return{initModel:()=>{l.value&&!t.value&&(i.value={name:l.value})},model:i,updateModel:s=>{i.value=s}}}function tt(e,{emit:t},{isUpdate:l=u(()=>!1),model:i=E({})}){const r=o(e,"changeModelFiltersSaved"),a=o(e,"updateFiltersSaved"),s=E(void 0),{addNotification:d}=$(),_=u(()=>!i.value.name),b=()=>{t("close")};return{close:b,disabledBtnSave:_,loading:s,save:async()=>{s.value=!0;const n=l.value;try{await a.value({action:n?"update":"create",label:i.value.name})}catch{d({text:"_A_FILTERS_SAVE_MSG_ERROR_",type:"danger"}),s.value=!1;return}d({text:n?"_A_FILTERS_SAVE_MSG_SUCCESS_UPDATE_{{name}}_":"_A_FILTERS_SAVE_MSG_SUCCESS_CREATE_{{name}}_",extra:{name:i.value.name}}),r.value({model:i.value.name,isCreateOrEdit:!0}),b(),s.value=!1}}}const lt={name:"AFiltersSaveModal",props:{changeModelFiltersSaved:{type:Function,required:!0},filtersSaved:{type:Array,required:!0},isModelFilterSavedNew:{type:Boolean,required:!0},modelFiltersSaved:{type:String,required:!1,default:void 0},selectorCloseIds:{type:String,required:!0},updateFiltersSaved:{type:Function,required:!0}},emits:["close"],setup(e,t){const{initModel:l,model:i,updateModel:r}=et(e),{dataForm:a,isUpdate:s}=Qe(e,{model:i}),{close:d,disabledBtnSave:_,loading:b,save:F}=tt(e,t,{isUpdate:s,model:i});return l(),{close:d,dataForm:a,disabledBtnSave:_,initModel:l,loading:b,model:i,save:F,updateModel:r}},render(){return c(_e,{close:this.close,dataForm:this.dataForm,disabledSave:this.disabledBtnSave,headerText:"_A_FILTERS_SAVE_MODAL_HEADER_",modelValue:this.model,idPrefix:"modal_filter_top_",loading:this.loading,selectorCloseIds:this.selectorCloseIds,size:"large",save:this.save,stop:!0,zIndex:1901,backdropZIndex:1900,"onUpdate:modelValue":this.updateModel},{modalBodyPrepend:()=>[c(ce,{type:"info",isVisible:!0,safeHtml:"_A_FILTERS_SAVE_MODAL_BODY_PREPEND_"})]})}};function it(e){const t=o(e,"filtersGroup"),l=E(void 0),i=u(()=>!!(t.value.alwaysVisible.length||t.value.filters.length));return{closeDropdown:()=>{var s;(s=l.value)==null||s.onClose({trigger:"click"})},dropdownRef:l,isDropdownVisible:i,openDropdown:s=>{var d;(d=l.value)==null||d.onOpen({trigger:"click",selectorToFocus:s})}}}function at(e,{openDropdown:t=()=>{}}){const i=`eventATableFilterTopOnOpen_${o(e,"id").value}`;return{destroyEventBus:()=>{K.$off(i,t)},initEventBus:()=>{K.$on(i,t)}}}function rt(e,{emit:t}){const l=o(e,"filtersGroup"),i=o(e,"filtersVisible"),r=({isAdd:F,filterId:n,filter:f})=>{t("toggleFiltersVisible",{isAdd:F,filterId:n,filter:f})},a=({model:F})=>{r({isAdd:!0,filterId:F})},s=({filter:F})=>{r({isAdd:!1,filterId:F.id,filter:F})},d=u(()=>!!(l.value.filters&&l.value.filters.length)),_=u(()=>{const F={};return T(i.value,n=>{F[n.id]=!0}),F}),b=u(()=>d.value?P(l.value.filters,F=>!_.value[F.id]):[]);return{addFiltersVisible:a,deleteFiltersVisible:s,filtersHidden:b,hasFiltersHiddenDefault:d}}function st(e,{openDropdown:t=()=>({})}){const l=o(e,"filtersSaved"),i=o(e,"id"),r=o(e,"onUpdateModelFilters"),a="_A_FILTERS_HOR_FILTER_NEW_",s=E(void 0),d=E(void 0),_=E(void 0),b=u(()=>`${i.value}btn_save_`),F=u(()=>d.value===a),n=u(()=>{const y=[{label:a}];return T(L(l.value),p=>{p.group="_A_FILTERS_FILTER_SAVED_GROUP_MY_",y.push(p)}),y});return{buttonSaveComponentId:b,changeModelFiltersSaved:({model:y,item:p,isDelete:S,isCreateOrEdit:I})=>{if(I){d.value=y;return}if((p==null?void 0:p.label)===a||S){r.value({model:{},isUpdateFiltersVisible:!0}),d.value=a;return}y?(d.value=y,p&&(r.value({model:p.data||{},isUpdateFiltersVisible:!0}),t())):p&&(r.value({model:p.data||{},isUpdateFiltersVisible:!0}),t())},closeModalSave:()=>{s.value=!1},filtersSavedLocal:n,initModelFiltersSaved:()=>{d.value=a},isModalSaveVisible:s,isModelFilterSavedNew:F,modelFiltersSaved:d,openModalSave:()=>{_.value=b.value,s.value=!0},selectorCloseIds:_}}function nt(e,{changeModelFiltersSaved:t=()=>{},idFilterTop:l=u(()=>""),isModelFilterSavedNew:i=u(()=>!1),modelFiltersSaved:r=E(void 0)}){const a=o(e,"id"),s=o(e,"updateFiltersSaved"),{changeConfirmOptions:d,closeConfirm:_,isModalHidden:b,openConfirm:F}=fe(),{addNotification:n}=$(),f=u(()=>`${a.value}btn_save`),v=u(()=>i.value?"_A_FILTERS_DELETE_FILTER_SAVED_BTN_DISABLED_":{mobile:"_A_FILTERS_DELETE_FILTER_SAVED_BTN_"}),h=u(()=>i.value?"_A_FILTERS_DELETE_FILTER_SAVED_BTN_DISABLED_":"_A_FILTERS_DELETE_FILTER_SAVED_BTN_"),A=async()=>{d({loading:!0});try{await s.value({action:"delete",label:r.value})}catch{n({text:"_A_FILTERS_DELETE_FILTER_MSG_ERROR_{{name}}_",type:"danger",extra:{name:r.value}}),d({loading:!1});return}n({text:"_A_FILTERS_DELETE_FILTER_MSG_SUCCESS_{{name}}_",extra:{name:r.value}}),d({loading:!1}),_(),t({model:void 0,isDelete:!0})};return{buttonDeleteId:f,isConfirmHidden:b,openDeleteConfirm:()=>{F({headerText:"_A_FILTERS_DELETE_FILTER_HEADER_{{name}}_",bodyHtml:"_A_FILTERS_DELETE_FILTER_BODY_{{name}}_",extra:{name:r.value},save:A,selectorCloseIds:[f.value,l.value],saveButtonText:"_A_FILTERS_DELETE_FILTER_BTN_DELETE_",stop:!0,zIndex:1901,backdropZIndex:1900})},textScreenreaderButtonDeleteFiltersSaved:h,titleButtonDeleteFiltersSaved:v}}function dt(e){const t=o(e,"filtersGroup"),l=o(e,"filtersVisible"),i=o(e,"updateDataKeyByIdFromFilter"),r="a_column a_column_12_touch a_column_3_fullhd a_column_3_widescreen a_column_3_desktop",a="a_columns a_columns_count_12 a_columns_gab_x_2 a_columns_gab_y_2 a_columns_gab_y_1_touch",s="a_filters__form_element a_column a_column_12_touch a_column_9_fullhd a_column_9_widescreen a_column_9_desktop",d=["select","multiselect","radio","checkbox","group","fieldset"],_=({dataKeyByKeyId:F,item:n,filter:f})=>{let v=f.id;n&&(v=n.id),i.value({filterId:v,dataKeyByKeyId:F})};return{dataForForm:u(()=>{const F=[];return T(t.value.alwaysVisible,n=>{const f=L(n);f.labelClass=r,f.classColumn=s,d.indexOf(n.type)!==-1&&(f.onUpdateData=({dataKeyByKeyId:v,item:h})=>_({dataKeyByKeyId:v,item:h,filter:n})),F.push({type:"group",id:`group_${n.id}`,classColumns:a,children:[f]})}),T(l.value,n=>{const f=L(n);f.labelClass=r,f.classColumn=`${s}  a_d_flex a_align_items_center`,f.slotAppend="groupAppend",f.class="a_width_100",d.indexOf(n.type)!==-1&&(f.onUpdateData=({dataKeyByKeyId:v,item:h})=>_({dataKeyByKeyId:v,item:h,filter:n})),F.push({type:"group",id:`group_${n.id}`,classColumns:a,children:[f]})}),F})}}function ot(e){const t=o(e,"id");return{idFilterTop:u(()=>`${t.value}_filter_top`)}}function ut(e,{emit:t},{closeDropdown:l=()=>{}}){const i=o(e,"disabled");return{onSearch:()=>{i.value||(l(),t("startSearch"))}}}const ct={name:"AFiltersHorizontal",props:{canSave:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filtersGroup:{type:Object,required:!0,default:()=>({alwaysVisible:[],filters:[]})},filtersKeyById:{type:Object,required:!0},filtersSaved:{type:Array,required:!0},filtersVisible:{type:Array,required:!0},id:{type:String,required:!0},mainModel:{type:Object,required:!1},onUpdateModelFilters:{type:Function,required:!0},unappliedModel:{type:Object,required:!0},updateDataKeyByIdFromFilter:{type:Function,required:!0},updateFiltersSaved:{type:Function,required:!0}},emits:["startSearch","toggleFiltersVisible"],setup(e,t){const{dataForForm:l}=dt(e),{closeDropdown:i,dropdownRef:r,isDropdownVisible:a,openDropdown:s}=it(e),{idFilterTop:d}=ot(e),{onSearch:_}=ut(e,t,{closeDropdown:i}),{destroyEventBus:b,initEventBus:F}=at(e,{openDropdown:s}),{addFiltersVisible:n,deleteFiltersVisible:f,filtersHidden:v,hasFiltersHiddenDefault:h}=rt(e,t),{buttonSaveComponentId:A,changeModelFiltersSaved:y,closeModalSave:p,filtersSavedLocal:S,initModelFiltersSaved:I,isModalSaveVisible:C,isModelFilterSavedNew:x,modelFiltersSaved:m,openModalSave:M,selectorCloseIds:g}=st(e,{openDropdown:s}),{buttonDeleteId:R,isConfirmHidden:Z,openDeleteConfirm:J,textScreenreaderButtonDeleteFiltersSaved:Q,titleButtonDeleteFiltersSaved:ee}=nt(e,{changeModelFiltersSaved:y,idFilterTop:d,isModelFilterSavedNew:x,modelFiltersSaved:m});return I(),F(),W(()=>{b()}),{addFiltersVisible:n,buttonDeleteId:R,buttonSaveComponentId:A,changeModelFiltersSaved:y,closeDropdown:i,closeModalSave:p,dataForForm:l,deleteFiltersVisible:f,dropdownRef:r,filtersHidden:v,filtersSavedLocal:S,hasFiltersHiddenDefault:h,idFilterTop:d,initModelFiltersSaved:I,isConfirmHidden:Z,isDropdownVisible:a,isModalSaveVisible:C,isModelFilterSavedNew:x,modelFiltersSaved:m,onSearch:_,openDeleteConfirm:J,openModalSave:M,selectorCloseIds:g,textScreenreaderButtonDeleteFiltersSaved:Q,titleButtonDeleteFiltersSaved:ee}},render(){return this.isDropdownVisible?[c(Fe,{ref:"dropdownRef",buttonIconLeft:me,buttonText:"Filter",buttonClass:"a_btn a_btn_primary a_btn_small a_filter_horizontal__btn_dropdown",dropdownTag:"div",dropdownClass:"a_filter_horizontal__wrapper",dropdownRenderDefault:!0,isCloseByClickInside:!1,hasCaret:!1,inBody:!0,lockArrowsNavigation:!1,lockTabNavigation:!1,useEscape:!this.isModalSaveVisible&&this.isConfirmHidden},{...this.$slots,dropdown:()=>c("div",{class:"a_filter_horizontal"},[c("div",{class:"a_filter_horizontal__header__wrapper"},[c("div",{class:"a_filter_horizontal__header"},[c("div",{class:"a_filter_horizontal__header__texts"},[c(O,{class:"a_filter_horizontal__header__texts__filter",tag:"span",text:"_A_FILTERS_HOR_FILTER_HEADER_"}),this.isModelFilterSavedNew?c(O,{class:"a_filter_horizontal__header__texts__new",tag:"em",text:this.modelFiltersSaved}):c("span",{},this.modelFiltersSaved)]),this.canSave?c(H,{modelValue:this.modelFiltersSaved,change:this.changeModelFiltersSaved,class:"a_filters_top__save_select",data:this.filtersSavedLocal,deselectable:!1,keyId:"label",keyLabel:"label",keyGroup:"group",label:"_A_FILTERS_SAVE_SELECT_",menuWidthType:"by_content",search:!0,translateData:!0,type:"select"}):""])]),c("div",{class:"a_filter_horizontal__body__wrapper"},[c("div",{class:"a_filter_horizontal__body"},[c(z,{idPrefix:this.idFilterTop,class:"a_filter_horizontal__body__form",classColumnDefault:"",classColumns:"",data:this.dataForForm,excludeRenderAttributes:this.excludeRenderAttributes,modelValue:this.unappliedModel,showErrors:!1,onChange:this.onUpdateModelFilters},{...this.$slots,groupAppend:({item:e})=>c(D,{type:"button",class:"a_btn a_btn_primary a_ml_2",title:"_A_FILTERS_TOP_CLOSE_",textScreenReader:"_A_FILTERS_TOP_CLOSE_",iconLeft:X,stop:!0,onClick:()=>this.deleteFiltersVisible({filter:e})}),formDataAppend:()=>c("div",{class:"a_filter_horizontal__add_filter__wrapper"},[c(H,{buttonClassDefault:"a_btn a_btn_primary a_filter_horizontal__add_filter",change:this.addFiltersVisible,data:this.filtersHidden,hasCaret:!1,disabled:!this.filtersHidden.length,isLabelFloat:!1,keyGroup:"group",keyId:"id",keyLabel:"label",label:"_A_FILTERS_ADD_FILTER_",labelClass:"a_sr_only",menuWidthType:"by_content",sortOrderGroup:"asc",placement:"bottom-start",search:!0,translateData:!0,type:"select"},{fixedPlaceholder:()=>[c(O,{tag:"span",ariaHidden:!0,class:"a_position_absolute_all",title:"_A_FILTERS_ADD_FILTER_"}),c(pe,{icon:be})]})]),formAppend:()=>this.canSave?c("div",{class:"a_filter_horizontal__save_actions"},[c(D,{id:this.buttonSaveComponentId,class:"a_btn a_btn_primary",iconLeft:ye,type:"button",text:"_A_FILTERS_SAVE_FILTER_SAVED_BTN_TEXT_",onClick:this.openModalSave}),c(D,{id:this.buttonDeleteId,ariaDisabled:this.isModelFilterSavedNew,class:"a_btn a_btn_secondary",iconLeft:Se,text:{desktop:"_A_FILTERS_DELETE_FILTER_SAVED_BTN_TEXT_"},textAriaHidden:!0,textScreenReader:this.textScreenreaderButtonDeleteFiltersSaved,title:this.titleButtonDeleteFiltersSaved,type:"button",onClick:this.openDeleteConfirm})]):""})]),c("div",{class:"a_filter_horizontal__footer"},[c("div",{class:"a_filter_horizontal__footer__actions"},[c(D,{type:"button",class:"a_btn a_btn_primary a_text_nowrap a_filter_horizontal__footer__actions__btn_search",iconLeft:Ae,text:"_A_FILTERS_START_SEARCH_",disabled:this.disabled,onClick:this.onSearch}),c(D,{type:"button",class:"a_btn a_btn_secondary a_text_nowrap a_filter_horizontal__footer__actions__btn_close",text:"_A_FILTERS_HOR_CLOSE_DROPDOWN_",onClick:this.closeDropdown})])])])])}),this.isModalSaveVisible?c(lt,{changeModelFiltersSaved:this.changeModelFiltersSaved,filtersSaved:this.filtersSaved,isModelFilterSavedNew:this.isModelFilterSavedNew,modelFiltersSaved:this.modelFiltersSaved,selectorCloseIds:this.selectorCloseIds,updateFiltersSaved:this.updateFiltersSaved,onClose:this.closeModalSave}):""]:null}};function _t(e){const t=o(e,"id");return{idFilterTop:u(()=>`${t.value}_filter_main`)}}function ft(e){const t=o(e,"filterMain"),l=u(()=>!!t.value),i=u(()=>l.value?[t.value]:[]);return{hasFilterMain:l,dataMainFilter:i}}function pt(e,{emit:t}){const l=o(e,"disabled");return{onSearch:()=>{l.value||t("startSearch")}}}const Ft={name:"AFiltersMain",props:{disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filterMain:{type:Object,required:!1},id:{type:String,required:!0},mainModel:{type:Object,required:!1},updateDataKeyByIdFromFilter:{type:Function,required:!0},updateMainModel:{type:Function,required:!0}},emits:["startSearch"],setup(e,t){const{hasFilterMain:l,dataMainFilter:i}=ft(e),{idFilterTop:r}=_t(e),{onSearch:a}=pt(e,t);return{hasFilterMain:l,dataMainFilter:i,idFilterTop:r,onSearch:a}},render(){return this.hasFilterMain?c("div",{id:this.idFilterTop,class:"a_filters_top"},[c(z,{idPrefix:this.idFilterTop,class:"a_filters_top__form",classColumns:"a_filters_top__main_wrapper",classColumnDefault:"a_filters_top__main",data:this.dataMainFilter,excludeRenderAttributes:this.excludeRenderAttributes,modelValue:this.mainModel,showErrors:!1,onChange:this.updateMainModel},{formDataAppend:()=>c(G,{class:"a_btn a_btn_primary a_text_nowrap a_filters_top__search",iconLeft:Ee,type:"submit",text:{desktop:"_A_FILTERS_START_SEARCH_"},textScreenReader:{mobile:"_A_FILTERS_START_SEARCH_"},prevent:!0,stop:!0,disabled:this.disabled,onClick:this.onSearch})})]):null}};function vt(e,{emit:t},{filtersHorizontalRef:l=E(void 0),filtersVisibleAll:i=u(()=>[]),onUpdateModelFilters:r=()=>{}}){const a=o(e,"appliedModel"),s=o(e,"unappliedModel"),d=()=>{var n;(n=l.value)==null||n.initModelFiltersSaved()},_=({filter:n,keyId:f,modelArray:v,appliedModelLocal:h,unappliedModelLocal:A})=>{const y=n.id;return w.value[n.type]?(h[y]&&h[y].length&&(v?h[y]=P(h[y],p=>v.indexOf(p)===-1):h[y]=[]),A[y]&&A[y].length&&(v?A[y]=P(A[y],p=>v.indexOf(p)===-1):A[y]=[])):j.value[n.type]&&f?(k(A==null?void 0:A[y])&&(A[y][f]=void 0),k(h==null?void 0:h[y])&&(h[y][f]=void 0)):(A[y]=void 0,h[y]=void 0),{appliedModelLocal:h,unappliedModelLocal:A}};return{closeAllFilters:()=>{let n=L(a.value),f=L(s.value);T(i.value,v=>{const h=_({filter:v,appliedModelLocal:n,unappliedModelLocal:f});n=h.appliedModelLocal,f=h.unappliedModelLocal}),d(),t("update:unappliedModel",f),t("update:appliedModel",n),setTimeout(()=>{r({model:a.value})})},closeFilterValue:({filter:n,keyId:f,modelArray:v})=>{const h=L(a.value),A=L(s.value),{appliedModelLocal:y,unappliedModelLocal:p}=_({filter:n,keyId:f,modelArray:v,appliedModelLocal:h,unappliedModelLocal:A});t("update:unappliedModel",p),t("update:appliedModel",y),setTimeout(()=>{r({model:a.value})})}}}function ht(){const e=E({});return{dataKeyByKeyIdPerFilter:e,updateDataKeyByIdFromFilter:({dataKeyByKeyId:l,filterId:i})=>{e.value[i]=L(l)}}}function bt(e){const t=o(e,"excludeRenderAttributes"),l=["alwaysVisible"];return{excludeRenderAttributesComputed:u(()=>Re(l,t.value))}}function yt({filter:e={},modelObj:t={}}){var i;const l=e.id;return l in t?w.value[e.type]?!!((i=t[l])!=null&&i.length):j.value[e.type]?!!(t[l]&&!Y(t[l])):!0:!1}function St(e,{emit:t}){const l=o(e,"filters"),i=o(e,"filterMain"),r=o(e,"unappliedModel"),a=E({}),s=E(void 0),d=E([]),_=u(()=>!!(l.value.length||i.value)),b=u(()=>{const p={};return T(L(l.value),S=>{p[S.id]=S,q.value[S.type]&&S.children&&S.children.length&&T(S.children,I=>{p[I.id]=I})}),p}),F=u(()=>{const p={alwaysVisible:[],filters:[]};return T(L(l.value),S=>{S.alwaysVisible?p.alwaysVisible.push(S):p.filters.push(S)}),p}),n=u(()=>{const p=[];return T(d.value,S=>{b.value[S]&&p.push(b.value[S])}),p}),f=u(()=>{const p=[];p.push(...l.value);const S=[];return T(p,I=>{S.push(I),q.value[I.type]&&I.children&&I.children.length&&T(I.children,C=>{S.push(C)})}),S}),v=()=>{const p=[];T(F.value.filters,S=>{yt({filter:S,modelObj:r.value})&&p.push(S.id)}),d.value=p};return{filtersDataKeyById:a,filtersGroup:F,filtersHorizontalRef:s,filtersKeyById:b,filtersVisible:n,filtersVisibleAll:f,filtersVisibleIds:d,hasFilters:_,onUpdateModelFilters:({model:p,isUpdateFiltersVisible:S})=>{t("update:unappliedModel",p),S&&setTimeout(()=>{v()})},setFiltersVisibleIds:v,updateAppliedModel:({model:p})=>{t("update:appliedModel",p)},updateMainModel:({model:p})=>{t("update:mainModel",p)}}}function At(e){const t=o(e,"filtersSaved"),l=o(e,"unappliedModel"),i=o(e,"updateFiltersSaved"),r=E([]);return{filtersSavedLocal:r,initFiltersSaved:()=>{r.value=t.value||[]},updateFiltersSavedLocal:({action:d="",label:_=""})=>{if(d==="create")r.value.push({label:_,data:L(l.value)});else{const b=ge(r.value,["label",_]);b!==-1&&(d==="delete"?r.value.splice(b,1):d==="update"&&r.value.splice(b,1,{label:_,data:L(l.value)}))}Ce(i.value)&&i.value({action:d,label:_,model:l.value,filtersSaved:r.value})}}}function mt(e,{emit:t},{onUpdateModelFilters:l=()=>{}}){const i=o(e,"appliedModel"),r=o(e,"unappliedModel");return{startSearch:()=>{t("update:appliedModel",r.value),setTimeout(()=>{l({model:i.value})})}}}function Et(e,{dataKeyByKeyIdPerFilter:t=E({}),filtersVisibleIds:l=E([]),onUpdateModelFilters:i=()=>{}}){const r=o(e,"unappliedModel");return{toggleFiltersVisible:({isAdd:s=!0,filterId:d,filter:_})=>{var b,F;if(s)l.value.push(d);else{const n=l.value.indexOf(d);n!==-1&&l.value.splice(n,1);const f=L(r.value);if(_&&_.modelId){const v=(b=t.value)==null?void 0:b[d];(F=f==null?void 0:f[_.modelId])!=null&&F.length&&v?f[_.modelId]=P(f[_.modelId],h=>!v[h]):f[d]=void 0}else f[d]=void 0;i({model:f})}}}}const Mt={name:"AFilters",props:{appliedModel:{type:Object,required:!1,default:()=>({})},canSave:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},filterMain:{type:Object,required:!1},filters:{type:Array,required:!1,default:()=>[]},filtersSaved:{type:Array,required:!1,default:()=>[]},id:{type:String,required:!1,default:()=>De("a_filters_")},mainModel:{type:Object,required:!1},unappliedModel:{type:Object,required:!1,default:()=>({})},updateFiltersSaved:{type:Function,required:!1,default:void 0},view:{type:String,required:!1,default:"top",validator:e=>["top","right"].indexOf(e)!==-1},viewRightTeleportSelector:{type:String,required:!1,default:void 0}},emits:["startSearch","update:appliedModel","update:mainModel","update:unappliedModel"],setup(e,t){const l=o(e,"filtersSaved"),{filtersDataKeyById:i,filtersGroup:r,filtersHorizontalRef:a,filtersKeyById:s,filtersVisible:d,filtersVisibleAll:_,filtersVisibleIds:b,hasFilters:F,onUpdateModelFilters:n,setFiltersVisibleIds:f,updateAppliedModel:v,updateMainModel:h}=St(e,t),{closeAllFilters:A,closeFilterValue:y}=vt(e,t,{filtersHorizontalRef:a,filtersVisibleAll:_,onUpdateModelFilters:n}),{dataKeyByKeyIdPerFilter:p,updateDataKeyByIdFromFilter:S}=ht(),{toggleFiltersVisible:I}=Et(e,{dataKeyByKeyIdPerFilter:p,filtersVisibleIds:b,onUpdateModelFilters:n}),{startSearch:C}=mt(e,t,{onUpdateModelFilters:n}),{filtersSavedLocal:x,initFiltersSaved:m,updateFiltersSavedLocal:M}=At(e),{excludeRenderAttributesComputed:g}=bt(e);return U(l,()=>{m()},{deep:!0}),f(),m(),{closeAllFilters:A,closeFilterValue:y,dataKeyByKeyIdPerFilter:p,excludeRenderAttributesComputed:g,filtersDataKeyById:i,filtersGroup:r,filtersHorizontalRef:a,filtersKeyById:s,filtersSavedLocal:x,filtersVisible:d,filtersVisibleAll:_,filtersVisibleIds:b,hasFilters:F,onUpdateModelFilters:n,setFiltersVisibleIds:f,startSearch:C,toggleFiltersVisible:I,updateAppliedModel:v,updateDataKeyByIdFromFilter:S,updateFiltersSavedLocal:M,updateMainModel:h}},render(){if(this.hasFilters)return c("div",[this.view==="top"&&c(Ft,{id:this.id,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filterMain:this.filterMain,mainModel:this.mainModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,updateMainModel:this.updateMainModel,onStartSearch:this.startSearch},this.$slots),this.view==="right"&&c(Ie,{to:this.viewRightTeleportSelector,disabled:!this.viewRightTeleportSelector},[c(we,{id:this.id,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filters:this.filters,filtersKeyById:this.filtersKeyById,appliedModel:this.appliedModel,onUpdateModelFilters:this.updateAppliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,onStartSearch:this.startSearch},this.$slots)]),c(Je,{id:this.id,appliedModel:this.appliedModel,closeAllFilters:this.closeAllFilters,closeFilterValue:this.closeFilterValue,dataKeyByKeyIdPerFilter:this.dataKeyByKeyIdPerFilter,disabled:this.disabled,filtersGroup:this.filtersGroup,filtersKeyById:this.filtersKeyById,filtersVisibleAll:this.filtersVisibleAll},{filtersHorizontal:()=>this.view==="top"?c(ct,{ref:"filtersHorizontalRef",id:this.id,canSave:this.canSave,disabled:this.disabled,excludeRenderAttributes:this.excludeRenderAttributesComputed,filtersGroup:this.filtersGroup,filtersKeyById:this.filtersKeyById,filtersSaved:this.filtersSavedLocal,filtersVisible:this.filtersVisible,onUpdateModelFilters:this.onUpdateModelFilters,unappliedModel:this.unappliedModel,updateDataKeyByIdFromFilter:this.updateDataKeyByIdFromFilter,updateFiltersSaved:this.updateFiltersSavedLocal,onStartSearch:this.startSearch,onToggleFiltersVisible:this.toggleFiltersVisible},this.$slots):"",...this.$slots})])}};export{Mt as A};
