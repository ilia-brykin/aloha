import{D as S,an as _,U as Z,o as $,p as ee,K as te,P as ae,al as le,I as K,a as ne,L as ie,b as O,B as se,C as re}from"./bundle.index.TDRGJtdO.js";import{U as ue}from"./chunk.UiMixinProps.SXpQQH-L.js";import{i as P,h as V,c as D}from"./chunk.vendor-lodash.-viuv_rg.js";import{t as n,a as y,r as w,b as oe,h as p,a$ as de,b0 as ce}from"./chunk.vendor.Ca3-nzbX.js";import{t as U}from"./chunk.utilsMath.DoITS5e9.js";const fe={props:{clearButtonClass:{type:[String,Object],required:!1,default:void 0},isClearButton:{type:Boolean,required:!1,default:!0}}};function me(e,{currentValue:u=w(0),displayValue:d=y(()=>""),ensurePrecision:i=()=>{},setCurrentValue:c=()=>{},minLocal:a=y(()=>{})}){const s=n(e,"disabled"),v=n(e,"modelValue"),x=n(e,"max"),f=n(e,"readonly"),N=y(()=>P(v.value)&&v.value<=a.value),A=y(()=>P(v.value)&&v.value>=x.value);return{increase:()=>{if(f.value||s.value||A.value)return;const b=Number(d.value)||0,l=i({value:b,currentValue:u.value});c(l)},decrease:()=>{if(f.value||s.value||N.value)return;const b=Number(d.value)||0,l=i({value:b,currentValue:u.value,coefficient:-1});c(l)}}}function he(e,{decrease:u=()=>{},increase:d=()=>{},inputRef:i=w({}),onBlur:c=()=>{},setCurrentValue:a=()=>{},userInput:s=w(null),currentValue:v=w(void 0),displayValue:x=y(()=>""),isTypeNumber:f=y(()=>!0)}){const N=n(e,"type"),A=n(e,"eAllowed"),I=n(e,"min"),m=n(e,"modelValue");return{handleInput:r=>{if(f.value){const h=r.target.value;s.value=h;const o=h===""?null:Number(h);a(o,!1);return}let t=r.target.value.trim();if(N.value==="integerNonNegative"){const h=t.match(/\d+/g);let o=0;h!==null?(o=parseInt(h.join(""),10),o=Math.max(o,0),t=o):t=null,a(t),i.value.value=t}else if(N.value==="integerPositive"){if(t==="0")t=null;else{const h=t.match(/\d+/g);let o=0;h!==null?(o=parseInt(h.join(""),10),o=Math.max(o,1),t=o):t=null}a(t),i.value.value=t}else if(N.value==="integer"){const h=t.match(/\d+/g);let o=0;h!==null?(o=parseInt(h.join(""),10),t.indexOf("-")!==-1&&(o=-o),t=o,a(t),i.value.value=t):t==="-"?(t="-",i.value.value=t):(t=null,a(t),i.value.value=t)}},handleInputChange:r=>{if(!f.value)return;const t=r.target.value,h=t!==""?Number(t):"";(P(h)&&!Number.isNaN(h)||t==="")&&a(h),s.value=null},handleKeydown:r=>{r.keyCode===S.arrowUp?(d(),r.preventDefault()):r.keyCode===S.arrowDown?(u(),r.preventDefault()):(!A.value&&r.keyCode===S.e||I.value>=0&&r.keyCode===S.minus||r.keyCode===S.plus)&&(r.preventDefault(),r.stopPropagation())},onBlurNumber:r=>{(s.value!==null||!m.value&&m.value!==0)&&(s.value=null,v.value=m.value,i.value.value=x.value),c(r)}}}function pe(e){const u=n(e,"type"),d=n(e,"min");return{minLocal:y(()=>{let c;return u.value==="integerNonNegative"?c=0:u.value==="integerPositive"&&(c=1),(V(c)||!D(d.value)&&d.value>c)&&(c=d.value),c})}}function ve(e,{verifyValue:u=()=>{},changeModel:d=()=>{}}){const i=n(e,"precision"),c=n(e,"modelValue"),a=w(null),s=w(c.value),v=y(()=>{if(a.value!==null)return a.value;let f=s.value;if(D(f))return"";if(P(f)){if(Number.isNaN(f))return"";V(i.value)||(f=f.toFixed(i.value))}return f});return{currentValue:s,displayValue:v,setCurrentValue:(f,N=!0)=>{const A=s.value,I=u(f);if(A!==I){if(!N){d({model:I});return}a.value=null,d({model:I}),s.value=I}},userInput:a}}function be(e){const u=n(e,"max"),d=n(e,"min"),i=n(e,"step"),c=n(e,"type"),a=y(()=>c.value==="number"),s=y(()=>a.value?"number":"text"),v=y(()=>a.value?{max:u.value,min:d.value,step:i.value}:{});return{inputType:s,isTypeNumber:a,numberAttributes:v}}function _e(e,{changeModel:u=()=>{},minLocal:d=y(()=>{})}){const i=n(e,"modelUndefined"),c=n(e,"stepStrictly"),a=n(e,"step"),s=n(e,"precision"),v=n(e,"max"),x=n(e,"modelValue"),f=m=>{if(D(m))return 0;const b=m.toString(),l=b.indexOf(".");let g=0;return l!==-1&&(g=b.length-l-1),g},N=y(()=>{const m=f(a.value);return V(s.value)?Math.max(f(x.value),m):(m>s.value&&console.warn("AInputNumber","precision should not be less than the decimal places of step"),s.value)});return{ensurePrecision:({value:m,currentValue:b,coefficient:l=1})=>P(m)?U(m+a.value*l,N.value):b,verifyValue:(m,b)=>{let l=Number(m);return D(m)||Number.isNaN(l)?null:(m===""&&(l=i.value),c.value&&(l=U(Math.round(l/a.value)*a.value,s.value)),V(s.value)||(l=U(l,s.value)),l>v.value?(l=v.value,b&&u({model:l})):l<d.value&&(l=d.value,b&&u({model:l})),l)}}}function ye(e){const u=n(e,"inputWidth");return{inputWidthStyleValue:y(()=>{let i=u.value;return P(u.value)&&(i=`${u.value}px`),V(i)?{}:{"--a_input_number_width":i}})}}const Pe={name:"AInputNumber",inheritAttrs:!1,mixins:[fe,ue],props:{alwaysTranslate:{type:Boolean,required:!1},autocomplete:{type:String,required:!1,default:void 0},controlsType:{type:String,required:!1,default:()=>_.value.propsDefault.controlsType,validator:e=>["plus-minus","arrows","none"].indexOf(e)!==-1},eAllowed:{type:Boolean,required:!1,default:()=>_.value.propsDefault.eAllowed},excludeRenderAttributes:{type:Array,required:!1,default:()=>[]},iconPrepend:{type:String,required:!1,default:()=>_.value.propsDefault.iconPrepend},inputWidth:{type:[String,Number],required:!1,default:()=>_.value.propsDefault.inputWidth},isLabelFloat:{type:Boolean,required:!1,default:()=>_.value.propsDefault.isLabelFloat},labelScreenReader:{type:String,required:!1,default:void 0},max:{type:Number,required:!1,default:()=>_.value.propsDefault.max},min:{type:Number,required:!1,default:()=>_.value.propsDefault.min},modelUndefined:{required:!1,default:()=>_.value.propsDefault.modelUndefined},placeholder:{type:[String,Number,Object],required:!1,default:()=>_.value.propsDefault.placeholder},precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10),default:()=>_.value.propsDefault.precision},readonly:{type:Boolean,required:!1,default:()=>_.value.propsDefault.readonly},step:{type:Number,required:!1,default:()=>_.value.propsDefault.step},stepStrictly:{type:Boolean,required:!1,default:()=>_.value.propsDefault.stepStrictly},type:{type:String,required:!1,default:()=>_.value.propsDefault.type,validator:e=>["number","integerNonNegative","integerPositive","integer"].indexOf(e)!==-1}},setup(e,u){const{attributesToExcludeFromRender:d}=Z(e),{componentStyleHide:i}=$(e),{ariaDescribedbyLocal:c,changeModel:a,clearModel:s,errorsId:v,helpTextId:x,htmlIdLocal:f,isErrors:N,isModel:A,onBlur:I,onFocus:m}=ee(e,u),{isClearButtonLocal:b}=te(e,{isModel:A}),{minLocal:l}=pe(e),{inputType:g,isTypeNumber:R,numberAttributes:r}=be(e),{placeholderAttributes:t}=ae(e),{inputWidthStyleValue:h}=ye(e),o=w(void 0),j=n(e,"disabled"),H=q=>{if(j.value)return;const T=q.target.value;a({model:+T})},{isAutofill:z}=le({inputRef:o}),{ensurePrecision:G,verifyValue:E}=_e(e,{changeModel:a,minLocal:l}),{currentValue:B,displayValue:L,setCurrentValue:F,userInput:C}=ve(e,{verifyValue:E,changeModel:a}),{increase:M,decrease:W}=me(e,{currentValue:B,displayValue:L,ensurePrecision:G,setCurrentValue:F,minLocal:l}),{handleInput:J,handleInputChange:Q,handleKeydown:X,onBlurNumber:Y}=he(e,{currentValue:B,decrease:W,displayValue:L,increase:M,inputRef:o,onBlur:I,setCurrentValue:F,userInput:C,isTypeNumber:R});return oe(()=>e.modelValue,q=>{const T=E(C.value),k=E(q,!0);!P(T)&&(!T||T!==k)&&(B.value=k,C.value=null)},{immediate:!0}),{ariaDescribedbyLocal:c,attributesToExcludeFromRender:d,clearModel:s,componentStyleHide:i,currentValue:B,decrease:W,displayValue:L,errorsId:v,handleInput:J,handleInputChange:Q,handleKeydown:X,helpTextId:x,htmlIdLocal:f,increase:M,inputRef:o,inputType:g,inputWidthStyleValue:h,isAutofill:z,isClearButtonLocal:b,isErrors:N,isModel:A,numberAttributes:r,onBlurNumber:Y,onFocus:m,onInput:H,placeholderAttributes:t,userInput:C}},render(){return this.isRender?p("div",{...this.$attrs,style:this.componentStyleHide,...this.attributesToExcludeFromRender},[p("div",{class:"a_form_element__container"},[p("div",{class:["a_form_element__parent",{a_form_element__parent_float:this.isLabelFloat,a_form_element__parent_not_empty:this.isModel||this.isAutofill,a_form_element__parent_float_has_icon_prepend:this.iconPrepend,a_form_element__parent_invalid:this.isErrors}]},[this.label&&!this.isLabelFloat&&p(K,{id:this.htmlIdLocal,alwaysTranslate:this.alwaysTranslate,label:this.label,labelClass:this.labelClass,labelScreenReader:this.labelScreenReader,required:this.required,type:this.type,isLabelFloat:this.isLabelFloat,isError:this.isErrors}),p("div",{class:["a_form_element_number",{a_form_element_number_controls:this.controlsType!=="none"}]},[p("div",{class:"a_form_element",style:{...this.inputWidthStyleValue}},[this.label&&this.isLabelFloat&&p(K,{id:this.htmlIdLocal,alwaysTranslate:this.alwaysTranslate,label:this.label,labelClass:this.labelClass,labelScreenReader:this.labelScreenReader,required:this.required,type:this.type,isLabelFloat:this.isLabelFloat,isError:this.isErrors}),this.iconPrepend&&p(ne,{icon:this.iconPrepend,class:"a_input__icon_prepend"}),p("input",{ref:"inputRef",id:this.htmlIdLocal,autocomplete:this.autocomplete,value:this.displayValue,type:this.inputType,class:["a_form_control a_input a_input_number",this.inputClass,{a_form_element_with_one_btn:this.isClearButtonLocal,a_form_control_invalid:this.isErrors}],disabled:this.disabled,ariaRequired:this.required,ariaInvalid:this.isErrors,"aria-describedby":this.ariaDescribedbyLocal,...this.numberAttributes,...this.placeholderAttributes,...this.inputAttributes,onInput:this.handleInput,onChange:this.handleInputChange,onKeydown:this.handleKeydown,onFocus:this.onFocus,onBlur:this.onBlurNumber}),this.isClearButtonLocal?p("div",{class:"a_form_control__actions"},[p(ie,{alwaysTranslate:this.alwaysTranslate,disabled:this.disabled,class:this.clearButtonClass,onClear:this.clearModel})]):""]),this.controlsType==="plus-minus"&&p("div",{class:"a_btn_group"},[p(O,{alwaysTranslate:this.alwaysTranslate,class:"a_btn a_btn_outline_secondary",iconLeft:de,tabindex:-1,disabled:this.disabled,title:"_A_INPUT_NUMBER_BTN_DECREASE_",textScreenReader:"_A_INPUT_NUMBER_BTN_DECREASE_",onClick:this.decrease}),p(O,{alwaysTranslate:this.alwaysTranslate,class:"a_btn a_btn_outline_secondary",iconLeft:ce,tabindex:-1,disabled:this.disabled,title:"_A_INPUT_NUMBER_BTN_INCREASE_",textScreenReader:"_A_INPUT_NUMBER_BTN_INCREASE_",onClick:this.increase})])]),p(se,{id:this.helpTextId,alwaysTranslate:this.alwaysTranslate,html:this.helpText,extra:this.extra}),this.isErrors&&p(re,{id:this.errorsId,alwaysTranslate:this.alwaysTranslate,errors:this.errors})])])]):null}};export{Pe as A};
